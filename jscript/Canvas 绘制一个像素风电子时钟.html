<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Canvas 绘制一个像素风电子时钟' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Canvas 绘制一个像素风电子时钟</center></div><div class='banquan'>原文出处:本文由博客园博主未见八月提供。<br/>
原文连接:https://www.cnblogs.com/jmtm/p/11686175.html</div><br>
    <p>想法是在 Canvas 上绘制由小方块组成的数字。</p>
<p>第一步是实现绘制小方块的方法，先画出一个边长为 5 的 10x10 个方块，使用两个 for 循环很简单就能完成。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">for</span> (let i = 0; i &lt; 10; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">2</span>     <span style="color: #0000ff;">for</span> (let j = 0; j &lt; 10; j++<span style="color: #000000;">) {
</span><span style="color: #008080;">3</span>         context.fillRect(5 * i, 5 * j, 5, 5<span style="color: #000000;">);
</span><span style="color: #008080;">4</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">5</span> }</pre>
</div>
<p>&nbsp;效果如下：</p>
<div id="small_blocks">
<p>&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟0.png" alt="" /></p>
</div>
<p>但是这样一大块黑色不是很好看，可以把小方块的边长减一&nbsp;，有显示网格的效果，即： <span class="cnblogs_code">context.fillRect(5 * i, 5 * j, 4, 4);</span></p>
<p>&nbsp;效果如下：</p>
<div id="small_grid_blocks">&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟1.png" alt="" /></div>
<p>接下来就是把数字转换成像素风，我的想法是创建一个数组，用 0 和 1 来表示是否填充，然后遍历数组。</p>
<p>如 1 为： <span class="cnblogs_code">["0010", "0110", "0010", "0010", "0111"]</span> ，下图所示方便理解：</p>
<div id="number_one">&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟2.png" alt="" /></div>
<p>为之前的循环增加一个判断，遍历字符串的索引判断是否要在相应位置绘制小方块。</p>
<p>x，y 是整个数字的原点（数字的左上角）。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw_single_word(context, x, y, numberList) {
</span><span style="color: #008080;">2</span>     <span style="color: #0000ff;">for</span> (let i = 0; i &lt; numberList.length; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">3</span>         <span style="color: #0000ff;">for</span> (let j = 0; j &lt; numberList[i].length; j++<span style="color: #000000;">) {
</span><span style="color: #008080;">4</span>             <span style="color: #0000ff;">if</span> (numberList[i][j] === "1"<span style="color: #000000;">) {
</span><span style="color: #008080;">5</span>                 context.fillRect(x + 5 * y + j, 5 * i, 4, 4<span style="color: #000000;">);
</span><span style="color: #008080;">6</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">7</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">8</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">9</span> }</pre>
</div>
<p>&nbsp; 显示效果：<img src="./images/Canvas 绘制一个像素风电子时钟3.png" alt="" /></p>
<p>类似的其他数字也可以显示，还可以加上冒号和破折号。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('79ccd494-75e9-45f1-8059-fcd72df2cd48')"><img id="code_img_closed_79ccd494-75e9-45f1-8059-fcd72df2cd48" class="code_img_closed" src="./images/Canvas 绘制一个像素风电子时钟4.png" alt="" /><img id="code_img_opened_79ccd494-75e9-45f1-8059-fcd72df2cd48" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('79ccd494-75e9-45f1-8059-fcd72df2cd48',event)" src="./images/Canvas 绘制一个像素风电子时钟5.png" alt="" />
<div id="cnblogs_code_open_79ccd494-75e9-45f1-8059-fcd72df2cd48" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> pixelNumber(number) {
</span><span style="color: #008080;"> 2</span>     let _number =<span style="color: #000000;"> number;
</span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (_number) {
</span><span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">case</span> "0"<span style="color: #000000;">:
</span><span style="color: #008080;"> 5</span>             _number = ["1111", "1001", "1001", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">case</span> "1"<span style="color: #000000;">:
</span><span style="color: #008080;"> 8</span>             _number = ["0010", "0110", "0010", "0010", "0111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">case</span> "2"<span style="color: #000000;">:
</span><span style="color: #008080;">11</span>             _number = ["1111", "0001", "1111", "1000", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">13</span>         <span style="color: #0000ff;">case</span> "3"<span style="color: #000000;">:
</span><span style="color: #008080;">14</span>             _number = ["1111", "0001", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">15</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">case</span> "4"<span style="color: #000000;">:
</span><span style="color: #008080;">17</span>             _number = ["1001", "1001", "1111", "0001", "0001"<span style="color: #000000;">];
</span><span style="color: #008080;">18</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">case</span> "5"<span style="color: #000000;">:
</span><span style="color: #008080;">20</span>             _number = ["1111", "1000", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">21</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">case</span> "6"<span style="color: #000000;">:
</span><span style="color: #008080;">23</span>             _number = ["1111", "1000", "1111", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">24</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">case</span> "7"<span style="color: #000000;">:
</span><span style="color: #008080;">26</span>             _number = ["1111", "0001", "0001", "0001", "0001"<span style="color: #000000;">];
</span><span style="color: #008080;">27</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">28</span>         <span style="color: #0000ff;">case</span> "8"<span style="color: #000000;">:
</span><span style="color: #008080;">29</span>             _number = ["1111", "1001", "1111", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">30</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">case</span> "9"<span style="color: #000000;">:
</span><span style="color: #008080;">32</span>             _number = ["1111", "1001", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;">33</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">case</span> ":"<span style="color: #000000;">:
</span><span style="color: #008080;">35</span>             _number = ["0", "1", "0", "1", "0"<span style="color: #000000;">];
</span><span style="color: #008080;">36</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">37</span>         <span style="color: #0000ff;">case</span> "-"<span style="color: #000000;">:
</span><span style="color: #008080;">38</span>             _number = ["000", "000", "111", "000", "000"<span style="color: #000000;">];
</span><span style="color: #008080;">39</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">40</span>         <span style="color: #0000ff;">case</span> "."<span style="color: #000000;">:
</span><span style="color: #008080;">41</span>             _number = ["0", "0", "0", "0", "1"<span style="color: #000000;">];
</span><span style="color: #008080;">42</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">case</span> " "<span style="color: #000000;">:
</span><span style="color: #008080;">44</span>             _number = ["0", "0", "0", "0", "0"<span style="color: #000000;">];
</span><span style="color: #008080;">45</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">46</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">47</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> _number;
</span><span style="color: #008080;">48</span> }</pre>
</div>
<span class="cnblogs_code_collapse">pixelNumber(number)</span></div>
<p>如下所示为数字 1-9 和 0</p>
<div id="other_number">&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟6.png" alt="" /></div>
<p>&nbsp;多个字符的话，可以遍历字符逐一调用刚才的&nbsp;<span class="cnblogs_code">draw_single_word</span> 函数画出。</p>
<p>只要在每个字符的 X 轴坐标上增加上一个字符的宽度，就可以防止几个字符重叠在一起。为了让字符不显得太挤，我增加了一个格子的宽度。</p>
<p>需要注意的是，我设置的 &ldquo;:&rdquo; 和 &ldquo;-&rdquo; 字符宽度只有三格，因此要在循环外创建 <span class="cnblogs_code">width</span> 函数。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> draw_words(context, x, y, text) {
</span><span style="color: #008080;">2</span>     let width = 0<span style="color: #000000;">;
</span><span style="color: #008080;">3</span>     <span style="color: #0000ff;">for</span> (let i = 0; i &lt; text.length; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">4</span>         let numberList =<span style="color: #000000;"> pixelNumber(text[i]);
</span><span style="color: #008080;">5</span>         draw_single_word(context, x +<span style="color: #000000;"> width, y, numberList);
</span><span style="color: #008080;">6</span>         width += (numberList[0].length + 1) * 5<span style="color: #000000;">;
</span><span style="color: #008080;">7</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">8</span> }</pre>
</div>
<p>&nbsp;效果如下：</p>
<div id="draw_words">&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟7.png" alt="" />
<p>&nbsp;</p>
<p>&nbsp;现在可以获取当前时间，并将字符绘制出来，获取当前时间的函数：</p>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> getTime() {
</span><span style="color: #008080;"> 2</span>     let date = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Date();
</span><span style="color: #008080;"> 3</span>     let year =<span style="color: #000000;"> date.getFullYear();
</span><span style="color: #008080;"> 4</span>     let month = zeroNumber(date.getMonth() + 1); <span style="color: #008000;">//</span><span style="color: #008000;"> 注意月份默认从 0 开始，所以加一才是正确的</span>
<span style="color: #008080;"> 5</span>     let day =<span style="color: #000000;"> zeroNumber(date.getDate());
</span><span style="color: #008080;"> 6</span>     let hour =<span style="color: #000000;"> zeroNumber(date.getHours());
</span><span style="color: #008080;"> 7</span>     let minutes =<span style="color: #000000;"> zeroNumber(date.getMinutes());
</span><span style="color: #008080;"> 8</span>     let seconds =<span style="color: #000000;"> zeroNumber(date.getSeconds());
</span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> {
</span><span style="color: #008080;">10</span>         date: year + "-" + month + "-" +<span style="color: #000000;"> day,
</span><span style="color: #008080;">11</span>         time: hour + ":" + minutes + ":" +<span style="color: #000000;"> seconds
</span><span style="color: #008080;">12</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">13</span> }</pre>
</div>
<p>&nbsp;为了美观，我创建了一个&nbsp;<span class="cnblogs_code">zeroNumber</span> 函数来给不足十的数字前加一个零。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('bb418d76-baf6-49dd-8588-00731da4a30c')"><img id="code_img_closed_bb418d76-baf6-49dd-8588-00731da4a30c" class="code_img_closed" src="./images/Canvas 绘制一个像素风电子时钟4.png" alt="" /><img id="code_img_opened_bb418d76-baf6-49dd-8588-00731da4a30c" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('bb418d76-baf6-49dd-8588-00731da4a30c',event)" src="./images/Canvas 绘制一个像素风电子时钟5.png" alt="" />
<div id="cnblogs_code_open_bb418d76-baf6-49dd-8588-00731da4a30c" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> zeroNumber(number) {
</span><span style="color: #008080;">2</span>     number = number &lt; 10 ? "0" +<span style="color: #000000;"> number : number;
</span><span style="color: #008080;">3</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> number;
</span><span style="color: #008080;">4</span> }</pre>
</div>
<span class="cnblogs_code_collapse">zeroNumber(number)</span></div>
<div id="draw_time">&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟10.png" alt="" />
<p>&nbsp;</p>
<p>&nbsp;最后，使用&nbsp;<span class="cnblogs_code">requestAnimationFrame</span>&nbsp;函数让它动起来。</p>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">function</span><span style="color: #000000;"> time_animate() {
</span><span style="color: #008080;">2</span>     ctx_animate.clearRect(0, 0, 200, 60<span style="color: #000000;">);
</span><span style="color: #008080;">3</span>     draw_words(ctx_animate, 0, 0<span style="color: #000000;">, getTime().time);
</span><span style="color: #008080;">4</span> <span style="color: #000000;">    window.requestAnimationFrame(time_animate);
</span><span style="color: #008080;">5</span> <span style="color: #000000;">}
</span><span style="color: #008080;">6</span> time_animate();</pre>
</div>
<div id="time_animate">
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/Canvas 绘制一个像素风电子时钟11.png" alt="" /></p>
</div>
<p>其实修改一下，也可显示其他东西，比如字母和简单符号。</p>
<p><img src="./images/Canvas 绘制一个像素风电子时钟12.png" alt="" /></p>
<p>最后贴一下我左上角的时间的代码，这是最初的版本，可能有些许问题，顺便说一句，IE不支持 class 。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4dfa38e3-6fed-4b47-ae6c-5d7f58a7bc90')"><img id="code_img_closed_4dfa38e3-6fed-4b47-ae6c-5d7f58a7bc90" class="code_img_closed" src="./images/Canvas 绘制一个像素风电子时钟4.png" alt="" /><img id="code_img_opened_4dfa38e3-6fed-4b47-ae6c-5d7f58a7bc90" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('4dfa38e3-6fed-4b47-ae6c-5d7f58a7bc90',event)" src="./images/Canvas 绘制一个像素风电子时钟5.png" alt="" />
<div id="cnblogs_code_open_4dfa38e3-6fed-4b47-ae6c-5d7f58a7bc90" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;">  1</span> <span style="color: #000000;">class PixelTime {
</span><span style="color: #008080;">  2</span> <span style="color: #000000;">    constructor(canvas) {
</span><span style="color: #008080;">  3</span>         <span style="color: #0000ff;">this</span>.canvas =<span style="color: #000000;"> canvas;
</span><span style="color: #008080;">  4</span>         <span style="color: #0000ff;">this</span>.context = <span style="color: #0000ff;">this</span>.canvas.getContext("2d"<span style="color: #000000;">);
</span><span style="color: #008080;">  5</span>         <span style="color: #0000ff;">this</span>.dateShow = 1; <span style="color: #008000;">//</span><span style="color: #008000;"> 是否显示年</span>
<span style="color: #008080;">  6</span>         <span style="color: #0000ff;">this</span>.timeShow = 1; <span style="color: #008000;">//</span><span style="color: #008000;"> 是否显示时间</span>
<span style="color: #008080;">  7</span>         <span style="color: #0000ff;">this</span>.pixelSide = <span style="color: #0000ff;">this</span>.canvas.width &lt; 102 ? 2 : Math.floor(<span style="color: #0000ff;">this</span>.canvas.width / 51<span style="color: #000000;">);
</span><span style="color: #008080;">  8</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">  9</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">*
</span><span style="color: #008080;"> 10</span> <span style="color: #008000;">     * 确定字符的点阵数组。
</span><span style="color: #008080;"> 11</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 12</span> <span style="color: #000000;">    pixelNumber(number) {
</span><span style="color: #008080;"> 13</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (number) {
</span><span style="color: #008080;"> 14</span>             <span style="color: #0000ff;">case</span> 0<span style="color: #000000;">:
</span><span style="color: #008080;"> 15</span>                 number = ["1111", "1001", "1001", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 16</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 17</span>             <span style="color: #0000ff;">case</span> 1<span style="color: #000000;">:
</span><span style="color: #008080;"> 18</span>                 number = ["0010", "0110", "0010", "0010", "0111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 19</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 20</span>             <span style="color: #0000ff;">case</span> 2<span style="color: #000000;">:
</span><span style="color: #008080;"> 21</span>                 number = ["1111", "0001", "1111", "1000", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 22</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 23</span>             <span style="color: #0000ff;">case</span> 3<span style="color: #000000;">:
</span><span style="color: #008080;"> 24</span>                 number = ["1111", "0001", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 25</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 26</span>             <span style="color: #0000ff;">case</span> 4<span style="color: #000000;">:
</span><span style="color: #008080;"> 27</span>                 number = ["1001", "1001", "1111", "0001", "0001"<span style="color: #000000;">];
</span><span style="color: #008080;"> 28</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 29</span>             <span style="color: #0000ff;">case</span> 5<span style="color: #000000;">:
</span><span style="color: #008080;"> 30</span>                 number = ["1111", "1000", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 31</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 32</span>             <span style="color: #0000ff;">case</span> 6<span style="color: #000000;">:
</span><span style="color: #008080;"> 33</span>                 number = ["1111", "1000", "1111", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 34</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 35</span>             <span style="color: #0000ff;">case</span> 7<span style="color: #000000;">:
</span><span style="color: #008080;"> 36</span>                 number = ["1111", "0001", "0001", "0001", "0001"<span style="color: #000000;">];
</span><span style="color: #008080;"> 37</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 38</span>             <span style="color: #0000ff;">case</span> 8<span style="color: #000000;">:
</span><span style="color: #008080;"> 39</span>                 number = ["1111", "1001", "1111", "1001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 40</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 41</span>             <span style="color: #0000ff;">case</span> 9<span style="color: #000000;">:
</span><span style="color: #008080;"> 42</span>                 number = ["1111", "1001", "1111", "0001", "1111"<span style="color: #000000;">];
</span><span style="color: #008080;"> 43</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 44</span>             <span style="color: #0000ff;">case</span> ":"<span style="color: #000000;">:
</span><span style="color: #008080;"> 45</span>                 number = ["0", "1", "0", "1", "0"<span style="color: #000000;">];
</span><span style="color: #008080;"> 46</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 47</span>             <span style="color: #0000ff;">case</span> "-"<span style="color: #000000;">:
</span><span style="color: #008080;"> 48</span>                 number = ["000", "000", "111", "000", "000"<span style="color: #000000;">];
</span><span style="color: #008080;"> 49</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 50</span>             <span style="color: #0000ff;">case</span> "."<span style="color: #000000;">:
</span><span style="color: #008080;"> 51</span>                 number = ["0", "0", "0", "0", "1"<span style="color: #000000;">];
</span><span style="color: #008080;"> 52</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 53</span>             <span style="color: #0000ff;">case</span> " "<span style="color: #000000;">:
</span><span style="color: #008080;"> 54</span>                 number = ["0", "0", "0", "0", "0"<span style="color: #000000;">];
</span><span style="color: #008080;"> 55</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 56</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 57</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> number;
</span><span style="color: #008080;"> 58</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 59</span> 
<span style="color: #008080;"> 60</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">*
</span><span style="color: #008080;"> 61</span> <span style="color: #008000;">     * 绘制点阵。
</span><span style="color: #008080;"> 62</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 63</span> <span style="color: #000000;">    drawPixelWord(x, y, words) {
</span><span style="color: #008080;"> 64</span>         let width = 0<span style="color: #000000;">;
</span><span style="color: #008080;"> 65</span>         <span style="color: #0000ff;">for</span> (let i = 0; i &lt; words.length; i++<span style="color: #000000;">) {
</span><span style="color: #008080;"> 66</span>             let word = parseInt(words[i]) || words[i] === "0" ?<span style="color: #000000;"> parseInt(words[i]) : words[i];
</span><span style="color: #008080;"> 67</span>             word = <span style="color: #0000ff;">this</span><span style="color: #000000;">.pixelNumber(word);
</span><span style="color: #008080;"> 68</span>             <span style="color: #0000ff;">for</span> (let r = 0; r &lt; word.length; r++<span style="color: #000000;">) {
</span><span style="color: #008080;"> 69</span>                 <span style="color: #0000ff;">for</span> (let c = 0; c &lt; word[r].length; c++<span style="color: #000000;">) {
</span><span style="color: #008080;"> 70</span>                     <span style="color: #0000ff;">if</span> (word[r][c] === "1"<span style="color: #000000;">) {
</span><span style="color: #008080;"> 71</span>                         let side = <span style="color: #0000ff;">this</span>.pixelSide - 1<span style="color: #000000;">;
</span><span style="color: #008080;"> 72</span>                         <span style="color: #0000ff;">this</span><span style="color: #000000;">.context.save();
</span><span style="color: #008080;"> 73</span>                         <span style="color: #0000ff;">this</span>.context.translate(x + width + <span style="color: #0000ff;">this</span>.pixelSide * 2, y + <span style="color: #0000ff;">this</span>.pixelSide * 2<span style="color: #000000;">);
</span><span style="color: #008080;"> 74</span>                         <span style="color: #0000ff;">this</span>.context.fillRect(c * (side + 1), r * (side + 1<span style="color: #000000;">), side, side);
</span><span style="color: #008080;"> 75</span>                         <span style="color: #0000ff;">this</span><span style="color: #000000;">.context.restore();
</span><span style="color: #008080;"> 76</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;"> 77</span> <span style="color: #000000;">                }
</span><span style="color: #008080;"> 78</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 79</span>             width += (1 + word[0].length) * <span style="color: #0000ff;">this</span><span style="color: #000000;">.pixelSide;
</span><span style="color: #008080;"> 80</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 81</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 82</span> 
<span style="color: #008080;"> 83</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">*
</span><span style="color: #008080;"> 84</span> <span style="color: #008000;">     * 给个位数前面加个零，如：01
</span><span style="color: #008080;"> 85</span> <span style="color: #008000;">     * @param number {number}
</span><span style="color: #008080;"> 86</span> <span style="color: #008000;">     * @returns {number}
</span><span style="color: #008080;"> 87</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 88</span> <span style="color: #000000;">    zeroNumber(number) {
</span><span style="color: #008080;"> 89</span>         number = number &lt; 10 ? "0" +<span style="color: #000000;"> number : number;
</span><span style="color: #008080;"> 90</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> number;
</span><span style="color: #008080;"> 91</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 92</span> 
<span style="color: #008080;"> 93</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">*
</span><span style="color: #008080;"> 94</span> <span style="color: #008000;">     * 获取当前时间。
</span><span style="color: #008080;"> 95</span> <span style="color: #008000;">     * @returns {{date: string, time: string}}
</span><span style="color: #008080;"> 96</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 97</span> <span style="color: #000000;">    getTime() {
</span><span style="color: #008080;"> 98</span>         let date = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Date();
</span><span style="color: #008080;"> 99</span>         let year =<span style="color: #000000;"> date.getFullYear();
</span><span style="color: #008080;">100</span>         let month = <span style="color: #0000ff;">this</span>.zeroNumber(date.getMonth() + 1); <span style="color: #008000;">//</span><span style="color: #008000;"> 月份默认从 0 开始</span>
<span style="color: #008080;">101</span>         let day = <span style="color: #0000ff;">this</span><span style="color: #000000;">.zeroNumber(date.getDate());
</span><span style="color: #008080;">102</span>         let hour = <span style="color: #0000ff;">this</span><span style="color: #000000;">.zeroNumber(date.getHours());
</span><span style="color: #008080;">103</span>         let minutes = <span style="color: #0000ff;">this</span><span style="color: #000000;">.zeroNumber(date.getMinutes());
</span><span style="color: #008080;">104</span>         let seconds = <span style="color: #0000ff;">this</span><span style="color: #000000;">.zeroNumber(date.getSeconds());
</span><span style="color: #008080;">105</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> {
</span><span style="color: #008080;">106</span>             date: year + "-" + month + "-" +<span style="color: #000000;"> day,
</span><span style="color: #008080;">107</span>             time: hour + ":" + minutes + ":" +<span style="color: #000000;"> seconds
</span><span style="color: #008080;">108</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">109</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">110</span> 
<span style="color: #008080;">111</span> <span style="color: #000000;">    drawTime() {
</span><span style="color: #008080;">112</span>         <span style="color: #0000ff;">this</span>.context.clearRect(0, 0, <span style="color: #0000ff;">this</span>.canvas.width, <span style="color: #0000ff;">this</span><span style="color: #000000;">.canvas.height);
</span><span style="color: #008080;">113</span>         let now = <span style="color: #0000ff;">this</span><span style="color: #000000;">.getTime();
</span><span style="color: #008080;">114</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span>.dateShow &amp;&amp; <span style="color: #0000ff;">this</span><span style="color: #000000;">.timeShow) {
</span><span style="color: #008080;">115</span>             <span style="color: #0000ff;">this</span>.drawPixelWord(0, 0<span style="color: #000000;">, now.date);
</span><span style="color: #008080;">116</span>             <span style="color: #0000ff;">this</span>.drawPixelWord(<span style="color: #0000ff;">this</span>.pixelSide * 14, <span style="color: #0000ff;">this</span>.pixelSide * 6<span style="color: #000000;">, now.time);
</span><span style="color: #008080;">117</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.dateShow) {
</span><span style="color: #008080;">118</span>             <span style="color: #0000ff;">this</span>.drawPixelWord(0, 0<span style="color: #000000;">, now.date);
</span><span style="color: #008080;">119</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span><span style="color: #000000;">.timeShow) {
</span><span style="color: #008080;">120</span>             <span style="color: #0000ff;">this</span>.drawPixelWord(0, 0<span style="color: #000000;">, now.time);
</span><span style="color: #008080;">121</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">122</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">123</span> }</pre>
</div>
<span class="cnblogs_code_collapse">PixelTime</span></div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>