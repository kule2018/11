<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JavaScript 标准内置对象Promise使用学习总结' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JavaScript 标准内置对象Promise使用学习总结</center></div><div class='banquan'>原文出处:本文由博客园博主授客提供。<br/>
原文连接:https://www.cnblogs.com/shouke/p/11876013.html</div><br>
    <p align="center"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>Javascript</strong><strong>标准内置对象</strong><strong>Promise</strong><strong>使用学习总结</strong></span></p>
<p align="center"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>&nbsp;</strong></span></p>
<p align="right"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>by:</strong><strong>授客</strong><strong> QQ</strong><strong>：</strong><strong>1033553122</strong></span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<ol>
<li><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>1.&nbsp;&nbsp; </strong><strong>基础用法</strong></span></li>
</ol>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">var condition = true;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">let p = new Promise(function(resolve, reject){ // resolve, reject为两个回调函数，分别供使用者在函数执行成功和执行失败时调用</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">if (condition) { // 一些执行成功、失败的判断条件，暂且使用上述变量替代</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; // throw "exception"; // 如果此处代码代码未注释，即抛出异常,该异常值 exception将被传递给promiseObj.then函数参数列表中第二个参数--一个回调函数</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resolve("执行成功"); // 如果resolve函数被调用，其函数实参将被传递给promiseObj.then函数参数列表中第一个参数--一个回调函数</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">} else {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; // throw "exception"; // 如果此处代码代码未注释，即抛出异常,该异常值 exception将被传递给promiseObj.then函数参数列表中第二个参数--一个回调函数</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("执行失败"); // 如果reject函数被调用，其函数实参将被传递给promiseObj.then函数参数列表中第二个参数--一个回调函数</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">})</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">p.then((data) =&gt; { // then函数接收两个参数--两个函数，分别在构造Promise对象定义的匿名函数（假设为func1）执行成功和执行失败时被调用(func1函数中，resolve被调用表示匿名函数执行成功，reject被调用、或者函数于resolve，reject被执行前，抛出了异常，表示匿名函数执行失败)，第一个函数的参数接收来自resolve函数的实参，第二个函数的参数接收来自reject函数的实参、或者是函数抛出的异常值(异常优先于reject、resolve被抛出)</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(data);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }, (err) =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(err);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">)</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出：</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">执行成功</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<ol>
<li><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>2.&nbsp;&nbsp; </strong><strong>链式调用之</strong><strong>.then</strong></span></li>
</ol>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc(condition){</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; new Promise(function(resolve, reject){</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (condition) {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resolve("执行成功");</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("执行失败");</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).then((data) =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(data);&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "then执行成功";</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }, (err) =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(err);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "then执行失败";</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">}).then(data =&gt; {//此处then函数接收两个参数--两个函数，分别在前一个then函数执行成功和执行失败时被调用。(前一个then函数参数列表中任意一个函数被调用，并且执行没抛出异常，表示执行成功，否则表示执行失败)。第一个函数的参数接收来自前一个then函数执行成功时的函数返回值，如果没有返回值则为undefined，第二个函数的参数接收来自前一个then函数执行失败时的函数返回值，如果没有返回值则为undfined，或者是then函数执行时抛出的异常值。</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">console.log("error:" + data);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }, err =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(err);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; })</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">testFunc(true)</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出：</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">"执行成功"</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">"then执行成功"</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">testFunc(false)</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">"执行失败"</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">"error:then执行失败"</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<ol>
<li><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>3.&nbsp;&nbsp; </strong><strong>链式调用之</strong><strong>.catch</strong></span></li>
</ol>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">.catch将在new Promise时定义的匿名函数执行失败、.then函数执行失败，并且位于其后的then函数没有显示提供第二个参数（供失败时调用的函数）时被调用。可以简单理解为用于捕获前面发生的，且没有被任何then函数处理的错误。</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>例</strong><strong>1</strong><strong>：</strong></span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc(condition){</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; new Promise(function(resolve, reject){</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (condition) {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resolve("执行成功");</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("执行失败");</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).then(data =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(data);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }, err =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(err);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).catch(err =&gt; {</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log("error:" + err)</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; })</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">testFunc(false);</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出：</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">"执行失败"</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></p>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>例</strong><strong>2</strong><strong>：</strong></span></p>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc(condition){</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; new Promise(function(resolve, reject){ </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (condition) { </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve("执行成功"); </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("执行失败");</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).then((data) =&gt; { </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(data);&nbsp; </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "then执行成功";</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).then(data =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(data); </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;}).catch(err =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log("error:" + err)</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; })</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">testFunc(false);</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出：</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">"error:执行失败"</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<p align="left"><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>例</strong><strong>3</strong><strong>：</strong></span></p>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc(condition){</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; new Promise(function(resolve, reject){ </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (condition) { </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve("执行成功"); </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("执行失败");</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; }).catch(err =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log("error:" + err)</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; })</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">testFunc(false)</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出：</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">"error:执行失败"</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<ol>
<li><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>4.&nbsp;&nbsp; </strong><strong>Promise.all</strong></span></li>
</ol>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">Promise.all(iterable) 方法返回一个 Promise 实例，此实例在 iterable 参数内所有的 promise 都&ldquo;完成（resolved）&rdquo;或参数中不包含 promise 时回调完成（resolve）；如果参数中&nbsp; promise 有一个失败（rejected），此实例回调失败（reject），失败原因的是第一个失败 promise 的结果</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;"><strong>例：</strong></span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc1(condition){</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; return new Promise(function(resolve, reject){ </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (condition) { </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve("testFunc1执行成功"); </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("testFunc1执行失败");</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;}</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; });</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">function testFunc2(condition){</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; return new Promise(function(resolve, reject){ </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (condition) { </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve("testFunc2执行成功"); </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject("testFunc2执行失败");</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; });</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">let result = Promise.all([testFunc2(true), testFunc1(true)]);</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">result.then((data) =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; console.log(data) </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}).catch(err =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; console.log(err);</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">})</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出如下内容：</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">Array ["testFunc2执行成功", "testFunc1执行成功"]</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">let result = Promise.all([testFunc2(false), testFunc1(true)]);</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">result.then((data) =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; console.log(data) </span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">}).catch(err =&gt; {</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;&nbsp;&nbsp; console.log(err);</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">})</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">运行结果，控制台输出如下内容：</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">"testFunc2执行失败"</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">说明：可以利用.all的特性，以并行执行多个异步操作，并且在一个回调中处理所有的返回数据（返回数据的顺序和传入参数数组的顺序对应）</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">参考链接：</span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;"><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all</a></span></pre>
<pre><code><span style="font-size: 15px; font-family: 'courier new', courier;">&nbsp;</span></pre>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>