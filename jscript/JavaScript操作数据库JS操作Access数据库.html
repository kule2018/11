<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JavaScript操作数据库JS操作Access数据库' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JavaScript操作数据库JS操作Access数据库</center></div><div class='banquan'>原文出处:本文由博客园博主程序猿的日常1提供。<br/>
原文连接:https://www.cnblogs.com/xsd1/p/11938261.html</div><br>
    <p>avaScript操作数据库JS操作Access数据库，跟其他语言操作差不多，总结了一下习惯代码，仅供参考学习。<br />现在在F盘有文件abc.mdf，表名为Student，一共2个字段，Id数字类型主键，stuName文本类型，现对该表进行增删改查的操作：</p>
<p>1.查询<br />&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;数据查询&lt;/TITLE&gt;<br />&lt;Script &gt;<br />var conn = new ActiveXObject("ADODB.Connection");<br />conn.Open("DBQ=f://abc.mdb;DRIVER={Microsoft Access Driver (*.mdb)};");<br />var rs = new ActiveXObject("ADODB.Recordset");<br />var sql="select * from Student";<br />rs.open(sql, conn);<br />var html="";<br />while(!rs.EOF)<br />{<br />&nbsp;&nbsp; html=html+rs.Fields("Id")+" "+rs.Fields("stuName");<br />&nbsp;&nbsp; rs.moveNext();<br />}<br />document.write(html);<br />rs.close();<br />rs = null;<br />conn.close();<br />conn = null;<br />&lt;/script&gt;<br />&lt;/HEAD&gt;<br />&lt;BODY&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p>
<p>2.增加操作<br />&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;增加操作&lt;/TITLE&gt;<br />&lt;script language="javascript"&gt;<br />function addUser(id,stuName)<br />{<br />&nbsp; //用 JavaScript 写服务器端连接数据库的代码示例<br />&nbsp; var conn = new ActiveXObject("ADODB.Connection");<br />&nbsp; conn.Open("DBQ=F://abc.mdb;DRIVER={Microsoft Access Driver (*.mdb)};");<br />&nbsp; var sql="insert into Student(ID,stuName) values("+id+",'"+stuName+"')";<br />try{<br />&nbsp;&nbsp; conn.execute(sql);<br />&nbsp;&nbsp; alert("添加成功");<br />}<br />catch(e){<br />&nbsp;&nbsp; document.write(e.description);<br />&nbsp;&nbsp; alert("添加失败~~~");<br />}<br />conn.close();</p>
<p>}<br />&lt;/script&gt;<br />&lt;/HEAD&gt;</p>
<p>&lt;BODY&gt;<br />&lt;table width=100 border=1&gt;<br />&nbsp;&nbsp; &lt;tr bgcolor='#f4f4f4'&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;编号&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br />&nbsp;&nbsp; &lt;/tr&gt;<br />&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;input id="stuId" /&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;input id="stuName"/&gt;&lt;/td&gt;<br />&nbsp;&nbsp; &lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;input name="1" type="button" value="添加" &omicron;nclick="addUser(stuId.value,stuName.value)"/&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p>
<p>3.删除操作<br />&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;删除操作&lt;/TITLE&gt;<br />&lt;script language="javascript"&gt;<br />function delStu(id)<br />{<br />&nbsp;&nbsp; var conn = new ActiveXObject("ADODB.Connection");<br />&nbsp;&nbsp; conn.Open("DBQ=F://abc.mdb;DRIVER={Microsoft Access Driver (*.mdb)};");<br />&nbsp;&nbsp; var sql="delete from Student where Id=2";<br />&nbsp;&nbsp; conn.execute(sql);<br />&nbsp;&nbsp; conn.close();<br />&nbsp;&nbsp; conn = null;<br />&nbsp;&nbsp; alert("修改成功");<br />}<br />&lt;/script&gt;<br />&lt;/HEAD&gt;</p>
<p>&lt;BODY&gt;<br />&lt;input name="1" type="button" value="删除" &omicron;nclick="delStu(1)"/&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p>
<p>4.修改操作<br />&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;修改操作 &lt;/TITLE&gt;<br />&lt;/HEAD&gt;<br />&lt;script&gt;<br />function updateUser(userId,userName)<br />{<br />&nbsp;&nbsp; var conn = new ActiveXObject("ADODB.Connection");<br />&nbsp;&nbsp; conn.Open("DBQ=F://abc.mdb;DRIVER={Microsoft Access Driver (*.mdb)};");<br />&nbsp;&nbsp; var rs = new ActiveXObject("ADODB.Recordset");<br />&nbsp;&nbsp; var sql="update Student set stuName='" + userName + "' where Id=" + userId + "";<br />&nbsp;&nbsp; conn.execute(sql);<br />&nbsp;&nbsp; conn.close();<br />&nbsp;&nbsp; conn = null;<br />&nbsp;&nbsp; alert("修改成功");<br />}<br />&lt;/script&gt;<br />&lt;BODY&gt;<br />&nbsp;&nbsp; &lt;table width=100 border=1&gt;<br />&nbsp;&nbsp; &lt;tr bgcolor='#f4f4f4'&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;编号&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br />&nbsp;&nbsp; &lt;/tr&gt;<br />&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;input id="stuId" /&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;input id="stuName"/&gt;&lt;/td&gt;<br />&nbsp;&nbsp; &lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;input name="1" type="button" value="修改" &omicron;nclick="updateUser(stuId.value,stuName.value)"/&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p>
<p>另外，JS也可以操作SQL Server数据库<br />数据库名为：MySchool，表名为Student，StudentId为int类型，自增列，studentName为学生姓名，为varchar类型。数据库用户名为sa，密码是ok，</p>
<p>&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;SQL数据查询&lt;/TITLE&gt;<br />&lt;Script &gt;<br />var conn = new ActiveXObject("ADODB.Connection");<br />conn.Open("Driver={SQL server};Server=.;DataBase=MySchool;UID=sa;Password=ok;");//打开数据库<br />var rs = new ActiveXObject("ADODB.Recordset");<br />var sql="select * from Student";<br />rs.open(sql, conn);<br />var html="";<br />while(!rs.EOF)<br />{<br />&nbsp;&nbsp; html=html+rs.Fields("StudentId")+" "+rs.Fields("studentName")+"&lt;br/&gt;";<br />&nbsp;&nbsp; rs.moveNext();<br />}<br />document.write(html);<br />rs.close();<br />rs = null;<br />conn.close();<br />conn = null;<br />&lt;/script&gt;<br />&lt;/HEAD&gt;</p>
<p>&lt;BODY&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p>
<p>相信很多人在刚接触前端或者中期时候总会遇到一些问题及瓶颈期，如学了一段时间没有方向感或者坚持不下去一个人学习枯燥乏味有问题也不知道怎么解决，对此我整理了一些资料 喜欢我的文章想与更多资深大牛一起讨论和学习的话 欢迎加入我的学习交流群<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//jq.qq.com/%3F_wv%3D1027%26k%3D59jir0A" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">907694362</a></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>