<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修使用create-react-app+react-router-dom+axios+antd+react-redux构建react项目' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>使用create-react-app+react-router-dom+axios+antd+react-redux构建react项目</center></div><div class='banquan'>原文出处:本文由博客园博主Jade_g提供。<br/>
原文连接:https://www.cnblogs.com/gxp69/p/11641560.html</div><br>
    <h2>1、安装、构建</h2>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;"># 全局安装
npm install </span>-g create-react-<span style="color: #000000;">app
# 构建一个my</span>-<span style="color: #000000;">app的项目
npx create</span>-react-app my-<span style="color: #000000;">app
cd my</span>-<span style="color: #000000;">app

# 启动编译当前的React项目，并自动打开 http:</span><span style="color: #008000;">//</span><span style="color: #008000;">localhost:3000/</span>
npm start</pre>
</div>
<h2>2、项目目录</h2>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">//默认<br /><br />├── package.json
├── public                  # 这个是webpack的配置的静态目录
│   ├── favicon.ico
│   ├── index.html          # 默认是单页面应用，这个是最终的html的基础模板
│   └── manifest.json
├── src
│   ├── App.css             # App根组件的css
│   ├── App.js              # App组件代码
│   ├── App.test.js
│   ├── index.css           # 启动文件样式
│   ├── index.js            # 启动的文件（开始执行的入口）！！！！
│   ├── logo.svg
│   └── serviceWorker.js
└── yarn.lock</span>  </pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">修改</span>
<span style="color: #000000;">├── package.json
├── public                  # 这个是webpack的配置的静态目录
│   ├── favicon.ico
│   ├── index.html          # 默认是单页面应用，这个是最终的html的基础模板
│   └── manifest.json
├── src
│   ├── assets            # 图片等静态资源
│   ├── redux             # 状态
│   │      ├── action.js                 # action
│   │      ├──reducerjs              # reducer
│   │      └── index.js                 # 主文件
│   ├── router             # 路由
│   │      ├── config.js                 # 配置
│   │      ├── FrontendAuth.js      # 路由守卫
│   │      └── index.js                 # 主文件
│   ├── serve            # 请求
│   │      ├── index.js            # axio
│   ├── views            # 页面
│   ├── App.css             # App根组件的css
│   ├── App.js              # App组件代码
│   ├── App.test.js
│   ├── index.css           # 启动文件样式
│   ├── index.js            # 启动的文件（开始执行的入口）！！！！
│   ├── logo.svg
│   └── serviceWorker.js
└── yarn.lock          </span></pre>
</div>
<p>&nbsp;</p>
<h2>3、antd</h2>
<div class="cnblogs_code">
<pre><code>yarn add antd</pre>
</div>
<p>修改&nbsp;<code>src/App.css</code>，在文件顶部引入&nbsp;<code>antd/dist/antd.css</code>。</p>
<div class="cnblogs_code">
<pre><code>@import '~antd/dist/antd.css'<span style="color: #000000;">;

.App {
  text</span>-<span style="color: #000000;">align: center;
}

...</span></pre>
</div>
<p><code>antd</code>&nbsp;目前的默认文案是英文，如果需要使用其他语言，可以参考下面的方案。</p>
<p>antd 提供了一个 React 组件&nbsp;<a href="https://ant.design/components/config-provider-cn/">ConfigProvider</a>&nbsp;用于全局配置国际化文案。</p>
<div class="cnblogs_code">
<pre><code>import zhCN from 'antd/es/locale/zh_CN'<span style="color: #000000;">;

</span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (
  </span>&lt;ConfigProvider locale={zhCN}&gt;
    &lt;App /&gt;
  &lt;/ConfigProvider&gt;
);</pre>
</div>
<h2>4、axios</h2>
<div class="cnblogs_code">
<pre><code>yarn add axios</pre>
</div>
<p>/src/serve/index.js，统一配置并绑定到react上</p>
<div class="cnblogs_code">
<pre><code>import React from 'react'<span style="color: #000000;">;
import axios from </span>'axios'<span style="color: #000000;">;
axios.defaults.headers[</span>'Content-Type'] = 'application/json'<span style="color: #000000;">;


let config </span>=<span style="color: #000000;"> {
  baseURL: </span>''<span style="color: #000000;">,
  timeout: </span>60 * 1000, <span style="color: #008000;">//</span><span style="color: #008000;"> Timeout</span>
<span style="color: #000000;">};
const _axios </span>=<span style="color: #000000;"> axios.create(config);
_axios.interceptors.request.use(
  (config) </span>=&gt;<span style="color: #000000;"> {
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Do something before request is sent</span>
    config.headers['Authorization'] = ''<span style="color: #000000;">;
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> config;
  },
  (error) </span>=&gt;<span style="color: #000000;"> {
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Do something with request error</span>
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> Promise.reject(error);
  }
);

</span><span style="color: #008000;">//</span><span style="color: #008000;"> Add a response interceptor</span>
<span style="color: #000000;">_axios.interceptors.response.use(
  (response) </span>=&gt;<span style="color: #000000;"> {
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Do something with response data</span>
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> response
  },
  (error) </span>=&gt;<span style="color: #000000;"> {
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Do something with response error</span>
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> Promise.reject();
  }
);
React.Component.prototype.$axios </span>= _axios;</pre>
</div>
<h2>5、router</h2>
<div class="cnblogs_code">
<pre><code>yarn add react-router-dom</pre>
</div>
<p>/src/router/config.js</p>
<div class="cnblogs_code">
<pre><code>import login from '../views/login'<span style="color: #000000;">;
import record from </span>'../views/record'<span style="color: #000000;">;
import home from </span>'../views/home'<span style="color: #000000;">;


export const routerConfig </span>=<span style="color: #000000;"> [
  {
    path:</span>'/'<span style="color: #000000;">,
    component:home,
    auth:</span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
  },{
    path:</span>'/record'<span style="color: #000000;">,
    component:record,
    </span><span style="color: #008000;">//</span><span style="color: #008000;">auth:true,</span>
<span style="color: #000000;">  },{
    path:</span>'/login'<span style="color: #000000;">,
    component:login,
  }
];</span></pre>
</div>
<p>/src/router/FrontendAuth.js</p>
<div class="cnblogs_code">
<pre><code>import React, {Component} from 'react'<span style="color: #000000;">;
import {Route, Redirect} from </span>'react-router-dom'<span style="color: #000000;">;

export class FrontendAuth extends Component {
  render() {
    const {location, config} </span>= <span style="color: #0000ff;">this</span><span style="color: #000000;">.props;
    const {pathname} </span>=<span style="color: #000000;"> location;
    const isLogin </span>= localStorage.getItem('__config_center_token'<span style="color: #000000;">)

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 如果该路由不用进行权限校验，登录状态下登陆页除外</span>
    <span style="color: #008000;">//</span><span style="color: #008000;"> 因为登陆后，无法跳转到登陆页</span>
    <span style="color: #008000;">//</span><span style="color: #008000;"> 这部分代码，是为了在非登陆状态下，访问不需要权限校验的路由</span>
    const targetRouterConfig = config.find((v) =&gt; v.path ===<span style="color: #000000;"> pathname);
    </span><span style="color: #0000ff;">if</span> (targetRouterConfig &amp;&amp; !targetRouterConfig.auth &amp;&amp; !<span style="color: #000000;">isLogin) {
      const {component} </span>=<span style="color: #000000;"> targetRouterConfig;
      </span><span style="color: #0000ff;">return</span> &lt;Route exact path={pathname} component={component}/&gt;
<span style="color: #000000;">    }

    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (isLogin) {
      </span><span style="color: #008000;">//</span><span style="color: #008000;"> 如果是登陆状态，想要跳转到登陆，重定向到主页</span>
      <span style="color: #0000ff;">if</span> (pathname === '/login'<span style="color: #000000;">) {
        </span><span style="color: #0000ff;">return</span> &lt;Redirect to='/'/&gt;
      } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> 如果路由合法，就跳转到相应的路由</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;"> (targetRouterConfig) {
          </span><span style="color: #0000ff;">return</span> &lt;Route path={pathname} component={targetRouterConfig.component}/&gt;
        } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
          </span><span style="color: #008000;">//</span><span style="color: #008000;"> 如果路由不合法，重定向到 404 页面</span>
          <span style="color: #0000ff;">return</span> &lt;Redirect to='/404'/&gt;
<span style="color: #000000;">        }
      }
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
      </span><span style="color: #008000;">//</span><span style="color: #008000;"> 非登陆状态下，当路由合法时且需要权限校验时，跳转到登陆页面，要求登陆</span>
      <span style="color: #0000ff;">if</span> (targetRouterConfig &amp;&amp;<span style="color: #000000;"> targetRouterConfig.auth) {
        </span><span style="color: #0000ff;">return</span> &lt;Redirect to='/login'/&gt;
      } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> 非登陆状态下，路由不合法时，重定向至 404</span>
        <span style="color: #0000ff;">return</span> &lt;Redirect to='/404'/&gt;
<span style="color: #000000;">      }
    }
  }
}</span></pre>
</div>
<p>/src/router/index.js</p>
<div class="cnblogs_code">
<pre><code>import React, { Component } from 'react'<span style="color: #000000;">;
import { Switch} from </span>'react-router-dom'<span style="color: #000000;">;

import { FrontendAuth } from </span>'./FrontendAuth'<span style="color: #000000;">;
import { routerConfig } from </span>'./config'<span style="color: #000000;">;


class Routes extends Component {
  render() {
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (
      </span>&lt;Switch&gt;
        &lt;FrontendAuth config={routerConfig} /&gt;
      &lt;/Switch&gt;
<span style="color: #000000;">    )
  }
}

export </span><span style="color: #0000ff;">default</span> Routes</pre>
</div>
<p>app.js</p>
<div class="cnblogs_code">
<pre><code>import {BrowserRouter as Router} from 'react-router-dom';<br />import Routes from './router/index'</pre>
<pre><code><em id="__mceDel"><span style="color: #000000;">
class App extends Component  {
  render() {
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (
      </span>&lt;Router&gt;
        &lt;Routes&gt;&lt;/Routes&gt;
      &lt;/Router&gt;
<span style="color: #000000;">    );
  }
}

export </span><span style="color: #0000ff;">default</span> App;</em></pre>
</div>
<h2>6、scss</h2>
<p>&nbsp;安装完后，只要把sass文件改成.scss就行了</p>
<div class="cnblogs_code">
<pre><code>npm install node-sass sass-loader --save</pre>
</div>
<h2>7、修改端口号</h2>
<p>项目默认端口号是3000，如下可以更改：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">在package.json中修改
  </span>"start":"react-scripts start"<span style="color: #000000;">,
为
</span>"start":"set PORT=9000 &amp;&amp; react-scripts start",</pre>
</div>
<h2>8、react-redux</h2>
<p>redux不是项目必需的，如果你不确定是否需要，那就是不需要，在react无法实现时，再考虑。</p>
<div class="cnblogs_code">
<pre><code>npm install react-redux redux --S</pre>
</div>
<p>&nbsp;/src/redux/action.js</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">/*</span><span style="color: #008000;">
 * action 类型
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">

export const COUNT </span>= 'COUNT'<span style="color: #000000;">;
</span><span style="color: #008000;">/*</span><span style="color: #008000;">
 * 初始值
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">

export const config </span>=<span style="color: #000000;"> {
    count:</span>1000<span style="color: #000000;">
};


</span><span style="color: #008000;">/*</span><span style="color: #008000;">
 * action 创建函数
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">

export </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> setCount(value) {
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> { type: COUNT, value }
}</span></pre>
</div>
<p>/src/redux/reducer.js</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">这是action</span>
<span style="color: #000000;">import {
  COUNT
} from </span>'./actions'

<span style="color: #008000;">//</span><span style="color: #008000;">这是reducer</span>
const reducer = (state , action) =&gt;<span style="color: #000000;"> {
  </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (action.type) {
    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> COUNT:
      let count </span>=<span style="color: #000000;">  action.value;
      </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> {...state,...{count}};
    </span><span style="color: #0000ff;">default</span><span style="color: #000000;">:
      </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> state;
  }
};
export </span><span style="color: #0000ff;">default</span> reducer</pre>
</div>
<p>/src/redux/index.js</p>
<div class="cnblogs_code">
<pre><code>import { createStore } from 'redux'<span style="color: #000000;">;
import {config} from </span>'./actions'<span style="color: #000000;">;
import reducer from </span>'./reducer'<span style="color: #000000;">;
let store </span>=<span style="color: #000000;"> createStore(reducer,config);

export </span><span style="color: #0000ff;">default</span> store</pre>
</div>
<p>/src/index.js</p>
<div class="cnblogs_code">
<pre><code>import { Provider } from 'react-redux'<span style="color: #000000;">
import store from </span>'./redux/index'<span style="color: #000000;">

ReactDOM.render(
  </span>&lt;ConfigProvider locale={zhCN}&gt;
    &lt;Provider store={store}&gt;
      &lt;App /&gt;
    &lt;/Provider&gt;
  &lt;/ConfigProvider&gt;, document.getElementById('root'));</pre>
</div>
<p>//页面调用示例</p>
<div class="cnblogs_code">
<pre><code>import React, { Component } from 'react'<span style="color: #000000;">;
import { connect } from </span>'react-redux'<span style="color: #000000;">;
import {
  setCount,
} from </span>'../redux/actions'<span style="color: #000000;">

class ReduxTest extends Component {

  componentDidMount() {
    console.log(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">.props)
  }
  render() {
    const { PayIncrease,tiger } </span>= <span style="color: #0000ff;">this</span><span style="color: #000000;">.props;
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (
      </span>&lt;div className="App"&gt;
        &lt;h2&gt;当月工资为{tiger}&lt;/h2&gt;
        &lt;button onClick={PayIncrease}&gt;升职加薪&lt;/button&gt;
      &lt;/div&gt;
<span style="color: #000000;">    );
  }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">需要渲染什么数据</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> mapStateToProps(state) {
  </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> {
    tiger: state.count
  }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">需要触发什么行为</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> mapDispatchToProps(dispatch) {
  </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> {
    PayIncrease: () </span>=&gt; dispatch(setCount(99999<span style="color: #000000;">)),
  }
}

export </span><span style="color: #0000ff;">default</span> ReduxTest = connect(mapStateToProps, mapDispatchToProps)(ReduxTest)</pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>