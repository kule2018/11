<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修微信小程序 上传图片并等比列压缩到指定大小' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>微信小程序 上传图片并等比列压缩到指定大小</center></div><div class='banquan'>原文出处:本文由博客园博主骑摩托敲代码提供。<br/>
原文连接:https://www.cnblogs.com/jonyellow/p/11727776.html</div><br>
    <p>微信小程序官方API中&nbsp; wx.chooseImage() 是可以进行图片压缩的，可惜的是不能压缩到指定大小。</p>
<p><img src="./images/微信小程序 上传图片并等比列压缩到指定大小0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;实际开发中需求可能是压缩到指定大小：</p>
<p>原生js可以使用canvas来压缩，但由于微信小程序对canvas有封装，使得利用canvas来压缩图片有了一些区别：</p>
<p>代码放在了git:&nbsp;<a href="https://github.com/jonyellow/code-diary/tree/master/%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9">https://github.com/jonyellow/code-diary/tree/master/%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9</a></p>
<p>直接上代码：</p>
<p><img src="./images/微信小程序 上传图片并等比列压缩到指定大小1.png" alt="" /></p>
<p>&nbsp;</p>
<p><img src="./images/微信小程序 上传图片并等比列压缩到指定大小2.png" alt="" /></p>
<p>&nbsp;</p>
<p><strong>&nbsp;主函数：</strong></p>
<p><img src="./images/微信小程序 上传图片并等比列压缩到指定大小3.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;以上的三个函数可以写在一个公共的js文件里面&nbsp; 我是写在 common.js中的:</p>
<p><span style="font-size: 14pt;"><strong>html:</strong></span></p>
<p><img src="./images/微信小程序 上传图片并等比列压缩到指定大小4.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;在html中需要添加个canvas标签，一般这个标签不让他出现在页面中，因为它的作用仅仅是压缩图片的工具：</p>
<div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;canvas&nbsp;class="canvas"&nbsp;canvas-id="canvas"&nbsp;:style="{width:cWidth+'px',height:cHeight+'px',&nbsp;visibility:&nbsp;'hidden',&nbsp;'position':'absolute',&nbsp;'z-index':&nbsp;'-1',&nbsp;left:&nbsp;'-10000rpx',top:'-10000rpx'}"&gt;&lt;/canvas&gt;</div>
<div>&nbsp;</div>
<div><span style="font-size: 14pt;"><strong>在methods中增加chooseImg方法：</strong></span></div>
<div><img src="./images/微信小程序 上传图片并等比列压缩到指定大小5.png" alt="" />
<p>&nbsp;</p>
<p>代码在实际项目中使用，能完成压缩图片到指定大小的需求。</p>
</div>
<div>&nbsp;</div>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>