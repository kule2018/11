<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修(办公)vue下载excel,后台用post方法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>(办公)vue下载excel,后台用post方法</center></div><div class='banquan'>原文出处:本文由博客园博主六一儿童节提供。<br/>
原文连接:https://www.cnblogs.com/historylyt/p/10845090.html</div><br>
    <p>　　后台方法的参数必须是<span style="color: #808000;">@RequestBody修饰的。</span></p>
<p><span style="color: #808000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 前台关键代码:</span></p>
<p><span style="color: #808000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">axios ( {
          method : </span><span style="color: #800000;">'</span><span style="color: #800000;">post</span><span style="color: #800000;">'</span><span style="color: #000000;">,
          url : api.exportPlayTime , </span><span style="color: #008000;">//</span><span style="color: #008000;"> 请求地址</span>
<span style="color: #000000;">          data : {
            choose : type,
            begindate : startDate,
            enddate : endDate
          },
          responseType : </span><span style="color: #800000;">'</span><span style="color: #800000;">arraybuffer</span><span style="color: #800000;">'</span><span style="color: #000000;">,
          observe: </span><span style="color: #800000;">'</span><span style="color: #800000;">response</span><span style="color: #800000;">'</span><span style="color: #000000;">,
        } )
          .then ( ( res ) </span>=&gt;<span style="color: #000000;"> {

            </span><span style="color: #0000ff;">const</span> fileName = <span style="color: #800000;">""</span>+filename+<span style="color: #800000;">"</span><span style="color: #800000;">.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">
            let blob </span>= <span style="color: #0000ff;">new</span> Blob([res.data], {type: <span style="color: #800000;">"</span><span style="color: #800000;">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</span><span style="color: #800000;">"</span><span style="color: #000000;">});
            </span><span style="color: #0000ff;">if</span> ( <span style="color: #800000;">'</span><span style="color: #800000;">download</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> document.createElement ( <span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span> ) ) { <span style="color: #008000;">//</span><span style="color: #008000;"> 非IE下载</span>
              <span style="color: #0000ff;">const</span> elink = document.createElement ( <span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;"> )
              elink.download </span>=<span style="color: #000000;"> fileName
              elink.style.display </span>= <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span><span style="color: #000000;">
              elink.href </span>=<span style="color: #000000;"> URL.createObjectURL ( blob )
              document.body.appendChild ( elink )
              elink.click ()
              URL.revokeObjectURL ( elink.href ) </span><span style="color: #008000;">//</span><span style="color: #008000;"> 释放URL 对象</span>
<span style="color: #000000;">              document.body.removeChild ( elink )
            } </span><span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> IE10+下载</span>
<span style="color: #000000;">              navigator.msSaveBlob ( blob, fileName )
            }

          })</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">download(data) {
        </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">data) {
          </span><span style="color: #0000ff;">return</span><span style="color: #000000;">
        }
        let url </span>= window.URL.createObjectURL(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Blob([data]))
        let link </span>= document.createElement(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        link.style.display </span>= <span style="color: #800000;">'</span><span style="color: #800000;">none</span><span style="color: #800000;">'</span><span style="color: #000000;">
        link.href </span>=<span style="color: #000000;"> url
        link.setAttribute(</span><span style="color: #800000;">'</span><span style="color: #800000;">download</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">excel.xlsx</span><span style="color: #800000;">'</span><span style="color: #000000;">)

        document.body.appendChild(link)
        link.click()
      },</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>