<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修D3.js比例尺   定量比例尺 之 线性比例尺(v3版本)' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>D3.js比例尺   定量比例尺 之 线性比例尺(v3版本)</center></div><div class='banquan'>原文出处:本文由博客园博主溢杨年华提供。<br/>
原文连接:https://www.cnblogs.com/littleSpill/p/10821332.html</div><br>
    <div><strong><span style="font-size: 14pt;">定量比例尺 :</span></strong></div>
<div><span style="font-size: 18px;">数学上有函数的概念，不是编程中所说的函数，如线性函数、指数函数、对数函数等，而指的是一个量随着另一个量的变化而变化。</span><span style="font-size: 18px;">例如有一下线性函数 : y=2x+1</span><span style="font-size: 18px;">该函数在二维坐标系中绘制出来的图形是一条直线，如果限制x的范围为[0,2]，则可计算得到y的范围为[1,5]。</span><span style="font-size: 18px;">x的范围[0,2]称为该函数的<strong>定义域</strong>，y的范围称为该函数的<strong>值域</strong>。根据x计算得到y的方法称为对应法则。</span><span style="font-size: 18px;">定义域、值域、对应法则称为函数的三要素。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">在数据可视化中，常需要像上述函数一样，将一个量转换为另一个量。D3提供了这样的转换方法，称为<strong>比例尺(scale)。</strong></span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">我们现在所说的<strong>定量比例尺</strong>，是指当定义域是连续的情况。从0~2之间的所有值，称为连续的值。类似0、1、2这样的值，称为离散的值</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">定量比例尺包括 : <strong>线性比例尺</strong>、<strong>指数比例尺</strong>、<strong>对数比例尺</strong>、<strong>量子比例尺</strong>、<strong>分位比例尺</strong>和<strong>阈值比例尺</strong>。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">按上面顺序，首先先介绍线性比例尺 。</span></div>
<div>&nbsp;</div>
<div>
<div><strong><span style="font-size: 18px;">线性比例尺</span></strong></div>
<div><span style="font-size: 18px;">线性比例尺(Linear Scale)是常用比例尺，与线性函数类似，计算线性的对应关系。相关方法有:</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">d3.scaleBand.linear()</span> 　　　　　　&nbsp;</span></div>
<div><span style="font-size: 18px;">//创建一个比例尺。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear(x)</span> 　　　　　　　　　　　　</span></div>
<div><span style="font-size: 18px;">//输入一个在定义域内的值x，返回值域内对应的值。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.invert(y) 　</span>　　　　　　　　</span></div>
<div><span style="font-size: 18px;"> //输入一个在值域内的值，返回定义域内对应的值。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.domain([numbers])</span> 　　　　&nbsp;&nbsp;</span></div>
<div><span style="font-size: 18px;">//设定或获取定义域</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.range([values])</span> 　　　　　　</span></div>
<div><span style="font-size: 18px;">&nbsp;//设定或获取值域</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.rangeRound([values])</span> 　　　 </span></div>
<div><span style="font-size: 18px;">//代替range()使用的话，比例尺的输出值会进行四舍五入的运算，结果为整数。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.clamp([boolean])</span>　　　　&nbsp; &nbsp; &nbsp;</span></div>
<div><span style="font-size: 18px;"> //默认被设置为false，当该比例尺接受一个超出定义域范围内的值时，依然能够按照同样的计算方法计算得到一个值，</span><span style="font-size: 18px;">这个值可能是超出值域范围的，如果设置为true，则任何超出值域的范围的值，都会被收缩到值域范围内。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.nice([count])</span> 　　　　　　&nbsp; &nbsp;</span></div>
<div><span style="font-size: 18px;">&nbsp;//将定义域的范围扩展成比较理想的形式。例如，定义域为[0.50000543,0.899995433221],则使用nice()之后，</span><span style="font-size: 18px;">其定义域变为[0.5,0.9]。对于[0.500000543,69.99998888]这样的定义域，则自动将其变为[0,70].</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.ticks([count])</span> 　　　　　　&nbsp; &nbsp;</span></div>
<div><span style="font-size: 18px;">//设定或获取定义域内具有代表性的值得数目。count默认为10，如果定义域[0,70]，则该函数返回[0,10,20,30,40,50,60,70]。</span><span style="font-size: 18px;">如果count设置为3，则返回&nbsp; &nbsp;[0,20,40,60]。该方法主要用于选取坐标轴刻度。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;"><span style="color: #ff0000;">linear.tickFormat(count,[format])&nbsp;</span> &nbsp;</span></div>
<div><span style="font-size: 18px;"> //用于设置定义域内具有代表性的值得表示形式，如显示到小数点后两位，使用百分比的形式显示，主要用于坐标轴上。<br /></span></div>








</div>
<div>&nbsp;</div>
<div>
<div><span style="font-size: 18px;">以上方法中,linear(x)、invert()、domain()、range()是基础方法，使用形式看代码:</span></div>
<div>&nbsp;</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;">1</span> <span style="color: #0000ff;">var</span> linear =<span style="color: #000000;"> d3.scale.linear()
</span><span style="color: #008080;">2</span>                     .domain([0,20])     <span style="color: #008000;">//</span><span style="color: #008000;">设置定义域为[0,20]</span>
<span style="color: #008080;">3</span>                     .range([0,100])     <span style="color: #008000;">//</span><span style="color: #008000;">设置值域为[0,100]</span>
<span style="color: #008080;">4</span>                     
<span style="color: #008080;">5</span>         console.log(linear(10))         <span style="color: #008000;">//</span><span style="color: #008000;">返回值50</span>
<span style="color: #008080;">6</span>         console.log(linear(30))         <span style="color: #008000;">//</span><span style="color: #008000;">返回值150</span>
<span style="color: #008080;">7</span>         console.log(linear.invert(80))  <span style="color: #008000;">//</span><span style="color: #008000;">返回值16</span></span></pre>
</div>
<p>&nbsp;</p>
</div>
</div>
<div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">用linear()计算的结果是，输出都是输入值得5倍。而使用linear.invert()时，输出都是输入值得五分之一。要注意的是，</span><span style="font-size: 18px;">倒数第二行，linear()接收了一个超出定义域范围的值30，结果还是正常输出其乘以5之后的值150.此输出值也超过了值域的范围</span><span style="font-size: 18px;">如果不希望其超出范围，可以使用clamp()，代码如下:</span></div>
<div>&nbsp;</div>
</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;">1</span> linear.clamp(<span style="color: #0000ff;">true</span><span style="color: #000000;">)
</span><span style="color: #008080;">2</span> console.log(linear(30))         <span style="color: #008000;">//</span><span style="color: #008000;">返回值100</span></span></pre>
</div>
<div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">将clamp()设置为true后，超出值域的值会取值域的上下限作为输出。对于输出的数值，如果希望对其进行四舍五入，要使用rangRound()来设置:</span></div>
<div>&nbsp;</div>
</div>
</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;">1</span>  linear.rangeRound([0,100<span style="color: #000000;">]);
</span><span style="color: #008080;">2</span>  console.log(linear(13.33))      <span style="color: #008000;">//</span><span style="color: #008000;">返回值67</span></span></pre>
</div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">如果不用rangeRound()重新设置值域，则输出值为66.649999999999,其四舍五入后值为67.如果定义域中有无穷小数，可用nice(),代码:</span></div>
<div>&nbsp;</div>
</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;">1</span> linear.domain([0.123000000,0.488888888<span style="color: #000000;">])
</span><span style="color: #008080;">2</span> <span style="color: #000000;">            .nice()
</span><span style="color: #008080;">3</span>         console.log(linear.domain())    <span style="color: #008000;">//</span><span style="color: #008000;">返回值[0.1,0.5]</span>
<span style="color: #008080;">4</span> 
<span style="color: #008080;">5</span> 
<span style="color: #008080;">6</span>         linear.domain([33.611111,45.97745<span style="color: #000000;">])
</span><span style="color: #008080;">7</span> <span style="color: #000000;">            .nice()
</span><span style="color: #008080;">8</span>         console.log(linear.domain())    <span style="color: #008000;">//</span><span style="color: #008000;">返回值[33,46]</span></span></pre>
</div>
<p>&nbsp;</p>
<div>
<div><span style="font-size: 18px;">应用nice()后，定义域变成了比较工整的形式，但是并不是四舍五入。最后讲解ticks()和tickFormat()的用法，它们主要是用在坐标轴上的。看代码:</span></div>
<div>&nbsp;</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">var</span> linear2 =<span style="color: #000000;"> d3.scale.linear()
</span><span style="color: #008080;"> 2</span>                         .domain([-20,20<span style="color: #000000;">])
</span><span style="color: #008080;"> 3</span>                         .range([0,100<span style="color: #000000;">])
</span><span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">var</span> ticks = linear2.ticks(5<span style="color: #000000;">);
</span><span style="color: #008080;"> 5</span>         console.log(ticks)              <span style="color: #008000;">//</span><span style="color: #008000;">返回值[-20, -10, 0, 10, 20]</span>
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">var</span> tickFormat = linear2.tickFormat(5,"+"<span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = 0; i &lt; ticks.length ; i++<span style="color: #000000;">){
</span><span style="color: #008080;"> 9</span>             <span style="color: #008000;">//</span><span style="color: #008000;">ticks数组中的每一个值，都使用一次tickFormat()函数</span>
<span style="color: #008080;">10</span>             ticks[i] =<span style="color: #000000;"> tickFormat(ticks[i])
</span><span style="color: #008080;">11</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">12</span>         console.log(ticks)              <span style="color: #008000;">//</span><span style="color: #008000;">返回值["-20", "-10", "+0", "+10", "+20"]</span></span></pre>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
<div>&nbsp;</div>
<div>
<div><span style="font-size: 18px;">这段代码中，比例尺的定义域为[-20,20]，调用ticks(5)之后返回一个数组，分别是该定义域内具有代表性的值。然后，调用tickFormat(),返回值是一个函数，因此调用时要使用函数的调用方式。最终结果是，ticks变成了设定的格式。</span><span style="font-size: 18px;">此外设定的格式为"+":表示如果是正数，则在前面添加一个加号，负数则添加一个减号。除此之外，常用的格式还有%、$等，遵循迷你语言格式规范。</span></div>
<div>&nbsp;</div>
<div>
<div><span style="font-size: 18px;">比例尺的domain()和range()最少放入两个数，可以超过两个数，但两者的数量必须相等，放入三个数的情况如下，代码:</span></div>
<div>
<div class="cnblogs_code">
<pre><code><span style="font-size: 18px;"><span style="color: #008080;">1</span> <span style="color: #0000ff;">var</span> scale =<span style="color: #000000;"> d3.scale.linear();
</span><span style="color: #008080;">2</span>         scale.domain([0,20,40<span style="color: #000000;">])
</span><span style="color: #008080;">3</span>             .range([0,100,150<span style="color: #000000;">]);
</span><span style="color: #008080;">4</span>         console.log(scale(30))          <span style="color: #008000;">//</span><span style="color: #008000;">返回值125</span></span></pre>
</div>
<p>&nbsp;</p>
</div>
</div>
<div>&nbsp;
<div><span style="font-size: 18px;">这表示有两个线性函数，当输入的值为30时，属于domain的20~40的范围，那么输出为100~150范围。</span></div>
<div>&nbsp;</div>
<div><span style="font-size: 18px;">下一文章介绍指数比例尺和对数比例尺。</span></div>
</div>
</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>