<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JS---涉及到的common.js' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JS---涉及到的common.js</center></div><div class='banquan'>原文出处:本文由博客园博主jane_panyiyun提供。<br/>
原文连接:https://www.cnblogs.com/jane-panyiyun/p/12021837.html</div><br>
    <pre><code><br />//格式化日期的代码
//获取指定标签对象
//获取元素的文本内容
//获取元素的文本内容
//获取父级元素中的第一个子元素
//获取父级元素中的最后一个子元素
//获取某个元素的前一个兄弟元素
//获取某个元素的后一个兄弟元素
//获取某个元素的所有兄弟元素
//返回当前浏览器是什么类型的浏览器
//为任意一个元素绑定事件:元素,事件类型,事件处理函数
//为任意的一个元素解绑某个事件:元素,事件类型,事件处理函数<br />//获取页面向上或者向左卷曲出去的距离的值<br />//变速（缓动）动画函数<br />//匀速动画函数<br />//变速动画函数封装增加任意多个属性和回掉函数及层级和透明度<br />//图片跟着鼠标飞的最终版本代码</pre>
<pre><code><br /><br /></pre>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 格式化日期
 * @param dt 日期对象
 * @returns {string} 返回值是格式化的字符串日期
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getDates(dt) {
    </span><span style="color: #0000ff;">var</span> str = "";<span style="color: #008000;">//</span><span style="color: #008000;">存储时间的字符串</span>
    <span style="color: #008000;">//</span><span style="color: #008000;">获取年</span>
    <span style="color: #0000ff;">var</span> year =<span style="color: #000000;"> dt.getFullYear();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">获取月</span>
    <span style="color: #0000ff;">var</span> month = dt.getMonth() + 1<span style="color: #000000;">;
    </span><span style="color: #008000;">//</span><span style="color: #008000;">获取日</span>
    <span style="color: #0000ff;">var</span> day =<span style="color: #000000;"> dt.getDate();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">获取小时</span>
    <span style="color: #0000ff;">var</span> hour =<span style="color: #000000;"> dt.getHours();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">获取分钟</span>
    <span style="color: #0000ff;">var</span> min =<span style="color: #000000;"> dt.getMinutes();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">获取秒</span>
    <span style="color: #0000ff;">var</span> sec =<span style="color: #000000;"> dt.getSeconds();
    month </span>= month &lt; 10 ? "0" +<span style="color: #000000;"> month : month;
    day </span>= day &lt; 10 ? "0" +<span style="color: #000000;"> day : day;
    hour </span>= hour &lt; 10 ? "0" +<span style="color: #000000;"> hour : hour;
    min </span>= min &lt; 10 ? "0" +<span style="color: #000000;"> min : min;
    sec </span>= sec &lt; 10 ? "0" +<span style="color: #000000;"> sec : sec;
    str </span>= year + "年" + month + "月" + day + "日 " + hour + ":" + min + ":" +<span style="color: #000000;"> sec;
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> str;
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取指定标签对象
 * @param id 标签的id属性值
 * @returns {Element}根据id属性值返回指定标签对象
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> my$(id) {
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> document.getElementById(id);
}

</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> setInnerText(element, text) {
    </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> element.textContent == "undefined"<span style="color: #000000;">) {
        element.innerText </span>=<span style="color: #000000;"> text;
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        element.textContent </span>=<span style="color: #000000;"> text;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取元素的文本内容
 * @param element 任意元素
 * @returns {*} 任意元素中的文本内容
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getInnerText(element) {
    </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">typeof</span> (element.textContent) == "undefined"<span style="color: #000000;">) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.innerText;
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.textContent;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取父级元素中的第一个子元素
 * @param element 父级元素
 * @returns {*} 父级元素中的子级元素
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getFirstElement(element) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.firstElementChild) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.firstElementChild;
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> node =<span style="color: #000000;"> element.firstChild;
        </span><span style="color: #0000ff;">while</span> (node &amp;&amp; node.nodeType != 1<span style="color: #000000;">) {
            node </span>=<span style="color: #000000;"> node.nextSibling;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> node;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取父级元素中的最后一个子元素
 * @param element 父级元素
 * @returns {*} 最后一个子元素
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getLastElement(element) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.lastElementChild) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.lastElementChild;
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> node =<span style="color: #000000;"> element.lastChild;
        </span><span style="color: #0000ff;">while</span> (node &amp;&amp; node.nodeType != 1<span style="color: #000000;">) {
            node </span>=<span style="color: #000000;"> node.previousSibling;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> node;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取某个元素的前一个兄弟元素
 * @param element 某个元素
 * @returns {*} 前一个兄弟元素
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getPreviousElement(element) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.previousElementSibling) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.previousElementSibling
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> node =<span style="color: #000000;"> element.previousSibling;
        </span><span style="color: #0000ff;">while</span> (node &amp;&amp; node.nodeType != 1<span style="color: #000000;">) {
            node </span>=<span style="color: #000000;"> node.previousSibling;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> node;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取某个元素的后一个兄弟元素
 * @param element 某个元素
 * @returns {*} 后一个兄弟元素
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getNextElement(element) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.nextElementSibling) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> element.nextElementSibling
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> node =<span style="color: #000000;"> element.nextSibling;
        </span><span style="color: #0000ff;">while</span> (node &amp;&amp; node.nodeType != 1<span style="color: #000000;">) {
            node </span>=<span style="color: #000000;"> node.nextSibling;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> node;
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 获取某个元素的所有兄弟元素
 * @param element 某个元素
 * @returns {Array} 兄弟元素
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getSiblings(element) {
    </span><span style="color: #0000ff;">if</span> (!element) <span style="color: #0000ff;">return</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> elements =<span style="color: #000000;"> [];
    </span><span style="color: #0000ff;">var</span> ele =<span style="color: #000000;"> element.previousSibling;
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (ele) {
        </span><span style="color: #0000ff;">if</span> (ele.nodeType === 1<span style="color: #000000;">) {
            elements.push(ele);
        }
        ele </span>=<span style="color: #000000;"> ele.previousSibling;
    }
    ele </span>=<span style="color: #000000;"> element.nextSibling;
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (ele) {
        </span><span style="color: #0000ff;">if</span> (ele.nodeType === 1<span style="color: #000000;">) {
            elements.push(ele);

        }
        ele </span>=<span style="color: #000000;"> ele.nextSibling;
    }
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> elements;
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * 返回当前浏览器是什么类型的浏览器
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> userBrowser() {
    </span><span style="color: #0000ff;">var</span> browserName =<span style="color: #000000;"> navigator.userAgent.toLowerCase();
    </span><span style="color: #0000ff;">if</span> (/msie/i.test(browserName) &amp;&amp; !/opera/<span style="color: #000000;">.test(browserName)) {
        console.log(</span>"IE"<span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (/firefox/<span style="color: #000000;">i.test(browserName)) {
        console.log(</span>"Firefox"<span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (/chrome/i.test(browserName) &amp;&amp; /webkit/i.test(browserName) &amp;&amp; /mozilla/<span style="color: #000000;">i.test(browserName)) {
        console.log(</span>"Chrome"<span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (/opera/<span style="color: #000000;">i.test(browserName)) {
        console.log(</span>"Opera"<span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (/webkit/i.test(browserName) &amp;&amp; !(/chrome/i.test(browserName) &amp;&amp; /webkit/i.test(browserName) &amp;&amp; /mozilla/<span style="color: #000000;">i.test(browserName))) {
        console.log(</span>"Safari"<span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        console.log(</span>"不知道什么鬼!"<span style="color: #000000;">);
    }
}



</span><span style="color: #008000;">//</span><span style="color: #008000;">为任意一个元素绑定事件:元素,事件类型,事件处理函数</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> addEventListener(element, type, fn) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.addEventListener) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">支持</span>
        element.addEventListener(type, fn, <span style="color: #0000ff;">false</span><span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.attachEvent) {
        element.attachEvent(</span>"on" +<span style="color: #000000;"> type, fn);
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        element[</span>"on" + type] =<span style="color: #000000;"> fn;
    }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">为任意的一个元素解绑某个事件:元素,事件类型,事件处理函数</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> removeEventListener(element, type, fn) {
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.removeEventListener) {
        element.removeEventListener(type, fn, </span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
    } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (element.detachEvent) {
        element.detachEvent(</span>"on" +<span style="color: #000000;"> type, fn);
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
        element[</span>"on" + type] = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    }
}<br /><br /><br /></span></pre>
</div>
<p>&nbsp;</p>
<pre><code>//设置任意的一个元素,移动到指定的目标位置</pre>
<div class="cnblogs_code">
<pre><code>    <span style="color: #008000;">//</span><span style="color: #008000;">设置任意的一个元素,移动到指定的目标位置</span>
    <span style="color: #0000ff;">function</span><span style="color: #000000;"> animate(element, target) {
      clearInterval(element.timeId);
      </span><span style="color: #008000;">//</span><span style="color: #008000;">定时器的id值存储到对象的一个属性中</span>
      element.timeId = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取元素的当前的位置,数字类型</span>
        <span style="color: #0000ff;">var</span> current =<span style="color: #000000;"> element.offsetLeft;
        </span><span style="color: #008000;">//</span><span style="color: #008000;">每次移动的距离</span>
        <span style="color: #0000ff;">var</span> step = 10<span style="color: #000000;">;
        step </span>= current &lt; target ? step : -<span style="color: #000000;">step;
        </span><span style="color: #008000;">//</span><span style="color: #008000;">当前移动到位置</span>
        current +=<span style="color: #000000;"> step;
        </span><span style="color: #0000ff;">if</span> (Math.abs(current - target) &gt;<span style="color: #000000;"> Math.abs(step)) {
          element.style.left </span>= current + "px"<span style="color: #000000;">;
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
          </span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
<span style="color: #000000;">          clearInterval(element.timeId);
          </span><span style="color: #008000;">//</span><span style="color: #008000;">直接到达目标</span>
          element.style.left = target + "px"<span style="color: #000000;">;
        }
      }, </span>20<span style="color: #000000;">);
    }</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>      <span style="color: #008000;">//</span><span style="color: #008000;">变速动画函数</span>

      <span style="color: #0000ff;">function</span><span style="color: #000000;"> animate(element, target) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
<span style="color: #000000;">        clearInterval(element.timeId);
        element.timeId </span>= setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
          </span><span style="color: #008000;">//</span><span style="color: #008000;">获取元素的当前位置</span>
          <span style="color: #0000ff;">var</span> current =<span style="color: #000000;"> element.offsetLeft;
          </span><span style="color: #008000;">//</span><span style="color: #008000;">移动步数</span>
          <span style="color: #0000ff;">var</span> step = (target - current) / 10<span style="color: #000000;">;
          step </span>= step &gt; 0 ?<span style="color: #000000;"> Math.ceil(step) : Math.floor(step);
          current </span>+=<span style="color: #000000;"> step;
          element.style.left </span>= current + "px"<span style="color: #000000;">;
          </span><span style="color: #0000ff;">if</span> (current ==<span style="color: #000000;"> target) {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
<span style="color: #000000;">            clearInterval(element.timeId);
          }
          </span><span style="color: #008000;">//</span><span style="color: #008000;">测试代码</span>
          console.log("目标位置:" + target + "，当前位置:" + current + "，步数:" +<span style="color: #000000;"> step);
        }, </span>20<span style="color: #000000;">);
      }</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #008000;">//</span><span style="color: #008000;">匀速动画函数</span>
    <span style="color: #0000ff;">function</span><span style="color: #000000;"> animate(element, target) {
      </span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
<span style="color: #000000;">      clearInterval(element.timeId);
      element.timeId </span>= setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取元素的当前位置</span>
        <span style="color: #0000ff;">var</span> current =<span style="color: #000000;"> element.offsetLeft;
        </span><span style="color: #008000;">//</span><span style="color: #008000;">移动的步数</span>
        <span style="color: #0000ff;">var</span> step = 10<span style="color: #000000;">;
        step </span>= target &gt; current ? step : -<span style="color: #000000;">step;
        current </span>+=<span style="color: #000000;"> step;
        </span><span style="color: #0000ff;">if</span> (Math.abs(current - target) &gt;<span style="color: #000000;"> Math.abs(step)) {
          element.style.left </span>= current + "px"<span style="color: #000000;">;
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
          clearInterval(element.timeId);
          element.style.left </span>= target + "px"<span style="color: #000000;">;
        }
      }, </span>20<span style="color: #000000;">);
    }</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #008000;">//</span><span style="color: #008000;">获取任意一个元素的任意一个样式属性的值</span>
    <span style="color: #0000ff;">function</span><span style="color: #000000;"> getStyle(element, attr) {
      </span><span style="color: #008000;">//</span><span style="color: #008000;">判断浏览器是否支持这个方法</span>
      <span style="color: #0000ff;">return</span> window.getComputedStyle ? window.getComputedStyle(element, <span style="color: #0000ff;">null</span><span style="color: #000000;">)[attr] : element.currentStyle[attr];
    }</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">点击按钮,改变宽度到达一个目标值,高度到达一个目标值</span>

  <span style="color: #008000;">//</span><span style="color: #008000;">获取任意一个元素的任意一个属性的当前的值---当前属性的位置值</span>
  <span style="color: #0000ff;">function</span><span style="color: #000000;"> getStyle(element, attr) {
    </span><span style="color: #0000ff;">return</span> window.getComputedStyle ? window.getComputedStyle(element, <span style="color: #0000ff;">null</span>)[attr] : element.currentStyle[attr] || 0<span style="color: #000000;">;
  }


  </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> animate(element, json, fn) {
    clearInterval(element.timeId);</span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
    <span style="color: #008000;">//</span><span style="color: #008000;">定时器,返回的是定时器的id</span>
    element.timeId = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
      </span><span style="color: #0000ff;">var</span> flag = <span style="color: #0000ff;">true</span>;<span style="color: #008000;">//</span><span style="color: #008000;">默认,假设,全部到达目标</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">遍历json对象中的每个属性还有属性对应的目标值</span>
      <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> attr <span style="color: #0000ff;">in</span><span style="color: #000000;"> json) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">判断这个属性attr中是不是opacity</span>
        <span style="color: #0000ff;">if</span> (attr == "opacity"<span style="color: #000000;">) {
          </span><span style="color: #008000;">//</span><span style="color: #008000;">获取元素的当前的透明度,当前的透明度放大100倍</span>
          <span style="color: #0000ff;">var</span> current = getStyle(element, attr) * 100<span style="color: #000000;">;
          </span><span style="color: #008000;">//</span><span style="color: #008000;">目标的透明度放大100倍</span>
          <span style="color: #0000ff;">var</span> target = json[attr] * 100<span style="color: #000000;">;
          </span><span style="color: #0000ff;">var</span> step = (target - current) / 10<span style="color: #000000;">;
          step </span>= step &gt; 0 ?<span style="color: #000000;"> Math.ceil(step) : Math.floor(step);
          current </span>+= step;<span style="color: #008000;">//</span><span style="color: #008000;">移动后的值</span>
          element.style[attr] = current / 100<span style="color: #000000;">;
        } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (attr == "zIndex") { <span style="color: #008000;">//</span><span style="color: #008000;">判断这个属性attr中是不是zIndex</span>
          <span style="color: #008000;">//</span><span style="color: #008000;">层级改变就是直接改变这个属性的值</span>
          element.style[attr] =<span style="color: #000000;"> json[attr];
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
          </span><span style="color: #008000;">//</span><span style="color: #008000;">普通的属性</span>
          <span style="color: #008000;">//</span><span style="color: #008000;">获取元素这个属性的当前的值</span>
          <span style="color: #0000ff;">var</span> current =<span style="color: #000000;"> parseInt(getStyle(element, attr));
          </span><span style="color: #008000;">//</span><span style="color: #008000;">当前的属性对应的目标值</span>
          <span style="color: #0000ff;">var</span> target =<span style="color: #000000;"> json[attr];
          </span><span style="color: #008000;">//</span><span style="color: #008000;">移动的步数</span>
          <span style="color: #0000ff;">var</span> step = (target - current) / 10<span style="color: #000000;">;
          step </span>= step &gt; 0 ?<span style="color: #000000;"> Math.ceil(step) : Math.floor(step);
          current </span>+= step;<span style="color: #008000;">//</span><span style="color: #008000;">移动后的值</span>
          element.style[attr] = current + "px"<span style="color: #000000;">;
        }
        </span><span style="color: #008000;">//</span><span style="color: #008000;">是否到达目标</span>
        <span style="color: #0000ff;">if</span> (current !=<span style="color: #000000;"> target) {
          flag </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }
      }
      </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (flag) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">清理定时器</span>
<span style="color: #000000;">        clearInterval(element.timeId);
        </span><span style="color: #008000;">//</span><span style="color: #008000;">所有的属性到达目标才能使用这个函数,前提是用户传入了这个函数</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;"> (fn) {
          fn();
        }
      }
      </span><span style="color: #008000;">//</span><span style="color: #008000;">测试代码</span>
      console.log("目标:" + target + ",当前:" + current + ",每次的移动步数:" +<span style="color: #000000;"> step);
    }, </span>20<span style="color: #000000;">);
  }</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> evt =<span style="color: #000000;"> {
      </span><span style="color: #008000;">//</span><span style="color: #008000;">window.event和事件参数对象e的兼容</span>
      getEvent: <span style="color: #0000ff;">function</span><span style="color: #000000;"> (evt) {
        </span><span style="color: #0000ff;">return</span> window.event ||<span style="color: #000000;"> evt;
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">可视区域的横坐标的兼容代码</span>
      getClientX: <span style="color: #0000ff;">function</span><span style="color: #000000;"> (evt) {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.getEvent(evt).clientX;
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">可视区域的纵坐标的兼容代码</span>
      getClientY: <span style="color: #0000ff;">function</span><span style="color: #000000;"> (evt) {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.getEvent(evt).clientY;
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">页面向左卷曲出去的横坐标</span>
      getScrollLeft: <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #0000ff;">return</span> window.pageXOffset || document.body.scrollLeft || document.documentElement.scrollLeft || 0<span style="color: #000000;">;
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">页面向上卷曲出去的纵坐标</span>
      getScrollTop: <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #0000ff;">return</span> window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop || 0<span style="color: #000000;">;
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">相对于页面的横坐标(pageX或者是clientX+scrollLeft)</span>
      getPageX: <span style="color: #0000ff;">function</span><span style="color: #000000;"> (evt) {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span>.getEvent(evt).pageX ? <span style="color: #0000ff;">this</span>.getEvent(evt).pageX : <span style="color: #0000ff;">this</span>.getClientX(evt) + <span style="color: #0000ff;">this</span><span style="color: #000000;">.getScrollLeft();
      },
      </span><span style="color: #008000;">//</span><span style="color: #008000;">相对于页面的纵坐标(pageY或者是clientY+scrollTop)</span>
      getPageY: <span style="color: #0000ff;">function</span><span style="color: #000000;"> (evt) {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span>.getEvent(evt).pageY ? <span style="color: #0000ff;">this</span>.getEvent(evt).pageY : <span style="color: #0000ff;">this</span>.getClientY(evt) + <span style="color: #0000ff;">this</span><span style="color: #000000;">.getScrollTop();
      }
    };
    </span><span style="color: #008000;">//</span><span style="color: #008000;">最终的代码</span>
<span style="color: #000000;">
    document.onmousemove </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;"> (e) {
      my$(</span>"im").style.left = evt.getPageX(e) + "px"<span style="color: #000000;">;
      my$(</span>"im").style.top = evt.getPageY(e) + "px"<span style="color: #000000;">;
    };</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #008000;">//</span><span style="color: #008000;">获取页面向上或者向左卷曲出去的距离的值</span>
    <span style="color: #0000ff;">function</span><span style="color: #000000;"> getScroll() {
      </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> {
        left: window.pageXOffset </span>|| document.documentElement.scrollLeft || document.body.scrollLeft || 0<span style="color: #000000;">,
        top: window.pageXOffset </span>|| document.documentElement.scrollTop || document.body.scrollTop || 0<span style="color: #000000;">
      };
    }</span></pre>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>