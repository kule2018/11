<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JavaScript（四）变量' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JavaScript（四）变量</center></div><div class='banquan'>原文出处:本文由博客园博主id_iot提供。<br/>
原文连接:https://www.cnblogs.com/caesar-id/p/10639791.html</div><br>
    <p><span style="font-size: 14pt;">变量的声明</span></p>
<p><span style="font-size: 15px;">在JavaScript程序中，使用一个变量之前应当使用关键字var进行声明，如下所示：</span><br /><span style="font-size: 15px;">var num;</span><br /><span style="font-size: 15px;">var sum;</span></p>
<p><span style="font-size: 15px;">也可以写成</span><br /><span style="font-size: 15px;">var num,sum,avg;</span><br /><span style="font-size: 15px;">如果只是声明变量而没有给变量赋值，默认的值是undefined。</span></p>
<p><span style="font-size: 15px;">可以将变量的初始赋值和变量声明合写在一起如下所示：</span><br /><span style="font-size: 15px;">var h = "Hello",w = "World";</span><br /><span style="font-size: 15px;">var a = 10, b = 20;</span></p>
<p><span style="font-size: 15px;">虽然使用关键字var进行了变量声明，但JavaScript中变量类型属于动态类型，所以不需要给变量指定数据类型，每当变量的值类型发生改变时，就会在内部将数据类型记录下来，变量的数据类型会随着值的改变而改变。</span></p>
<p><span style="font-size: 15px;">所以：</span><br /><span style="font-size: 15px;">var i = 10;</span><br /><span style="font-size: 15px;">i = "Hello"</span><br /><span style="font-size: 15px;">是合法的。</span></p>
<p><span style="font-size: 15px;">使用var语句重复声明变量是合法且有必要的，如果重复声明并且初始化了变量，那么这就和一条简单的赋值语句没什么两样，</span><span style="font-size: 15px;">如果你试图读取一个没有声明的的变量的值，JavaScript会报错。在ESMAScript5严格模式中，给一个没有声明的变量赋值也会报错，然而在非严格模式中，给一个没有声明的变量赋值，JavaScript会创建一个同名的全局变量，并让它工作起来，但并不和全局变量完全一样，这意味着你可以侥幸不声明全局变量，但这不是一个好的编程习惯，并会造成很多BUG，因此应当使用var来声明变量。</span></p>
<p><span style="font-size: 14pt;">变量的作用域</span><br /><span style="font-size: 15px;">一个变量的作用域是程序源码中定义这个变量的区域，全局变量拥有全局作用域，在JavaScript代码中的任何地方都是有意义的。</span><br /><span style="font-size: 15px;">在函数内声明的变量时局部变量，函数形参也是局部变量，它们只在函数体内有意义。</span></p>
<p><span style="font-size: 15px;">虽然在全局作用域可以不使用var声明变量，但是在函数内必须使用var声明变量。如果在函数内不使用var声明变量，JavaScript会去全局变量中去寻找该变量，如果在全局变量中找到则使用全局变量，如果在全局变量中没找到，会创建一个全局变量。如下所示：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> a = 10<span style="color: #000000;">;

</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> fun()
{
    a </span>= 20<span style="color: #000000;">;   # 会改变全局变量的值
    b </span>= 30<span style="color: #000000;">;   # 会声明一个全局变量
}
fun()
console.log(a,b)</span></pre>
</div>
<p><span style="font-size: 15px;">所以在函数体内声明变量时必须要使用var来进行声明。</span></p>
<p><span style="font-size: 14pt;">函数作用域和声明提前：</span><br /><span style="font-size: 15px;">在类似C语言中，花括号内的每一段代码都具有各自的作用域，而且变量的声明它们的代码段之外是不可见的，我们称之为块级作用域，JavaScript中没有块级作用域，JavaScript取而代之的是使用函数作用域，JavaScript的函数作用域是指在函数体内声明的所有变量在函数体内始终是可见的，JavaScript的这个特性被称为声明提前，即JavaScript函数里声明的所有变量（不涉及赋值）都被提前至函数体的顶部。</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> scope = "global"<span style="color: #000000;">;
</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> f(){
    console.log(scope); </span><span style="color: #008000;">//</span><span style="color: #008000;"> 输出"undefined"而不是"global"</span>
    <span style="color: #0000ff;">var</span> scope = "local"; <span style="color: #008000;">//</span><span style="color: #008000;"> 定义变量并赋值</span>
    console.log(scope); <span style="color: #008000;">//</span><span style="color: #008000;"> 输出local</span>
}<br />f()</pre>
</div>
<p><span style="font-size: 15px;">从直观上看可能会认为第一行会输出global，因为在函数内执行第一条打印语句时我们会想当然的认为JavaScript会到全局作用域中去找变量scope，所以第一行会打印global，但实际上由于函数作用域的特性，局部变量在整个函数体始终是有定义的，尽管如此，只有指定到var scope = "local";时才被赋值，因此上述过程等价于将函数体内的变量声明提前至函数体顶部，同时变量初始化保留在原来的位置：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> scope = "global"<span style="color: #000000;">;
</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> f(){
    </span><span style="color: #0000ff;">var</span> scope;           <span style="color: #008000;">//</span><span style="color: #008000;"> 变量声明被置顶</span>
    console.log(scope);  <span style="color: #008000;">//</span><span style="color: #008000;"> 打印undefined</span>
    <span style="color: #0000ff;">var</span> scope = "local"; <span style="color: #008000;">//</span><span style="color: #008000;"> 定义变量并赋值</span>
    console.log(scope);  <span style="color: #008000;">//</span><span style="color: #008000;"> 输出local</span>
}</pre>
</div>
<p><span style="font-size: 15px;">通过上面的示例我们可以知道，<span style="color: #ff6600;">在函数体内声明变量时，尽量统一声明到函数的顶部，而不是将变量声明在要使用变量的地方。</span></span></p>
<p><span style="font-size: 14pt;">作为属性的变量</span><br /><span style="font-size: 15px;">当声明一个全局变量时，实际上是定义了一个全局对象的一个属性，当使用var声明一个变量时，创建的这个属性是不可删除的，也就是整个变量无法通过delete运算符删除，但如果没有使用var声明的变量，JavaScript会自动创建一个全局变量，这种类型的全局变量可以使用delete运算符进行删除。如下：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> a = 1<span style="color: #000000;">;
b </span>= 2<span style="color: #000000;">;
</span><span style="color: #0000ff;">this</span>.c = 3<span style="color: #000000;">;
</span><span style="color: #0000ff;">delete</span> a; <span style="color: #008000;">//</span><span style="color: #008000;"> 不会被删除</span>
<span style="color: #0000ff;">delete</span> b; <span style="color: #008000;">//</span><span style="color: #008000;"> 会被删除</span>
<span style="color: #0000ff;">delete</span> c; <span style="color: #008000;">//</span><span style="color: #008000;"> 会被删除</span>
<span style="color: #000000;">
console.log(a); </span><span style="color: #008000;">//</span><span style="color: #008000;"> 打印1</span>
console.log(b) <span style="color: #008000;">//</span><span style="color: #008000;"> 报错</span>
console.log(c) <span style="color: #008000;">//</span><span style="color: #008000;"> 报错</span></pre>
</div>
<p><span style="font-size: 14pt;">作用域链</span></p>
<p><span style="font-size: 15px;">JavaScript是基于词法作用域的语言：通过阅读包含变量定义在内的数行源码就能知道变量的作用域。 全局变量在程序中始终都是有定义的。 局部变量在声明它的函数体内以及其所嵌套的函数内始终是有定义的。</span></p>
<p><span style="font-size: 15px;">如果将一个局部变量看做是自定义实现的对象的属性的话， 那么可以换个角度来解读变最作用域。 每一段JavaScript代码（全局代码或函数）都有一个与之关联的作用域链</span><span style="font-size: 15px;">(s cope chain)。 这个作用域链是一个对象列表或者链表， 这组对象定义了这段代码&rdquo;作用域中&rdquo; 的变量。 当JavaScript需要查找变量x的值的时候（这个过程称做 &ldquo;变量解析" (variable resolution)) , 它会从链中的第一个对象开始查找， 如果这个对象有一 个名为x的属性， 则会直接使用这个属性的值， 如果第一个对象中不存在名为x的属性， JavaScript会继续查找链上的下一个对象。 如果第二个对象依然没有名为x的属性， 则会继续查找下一个对象， 以此类推。 如果作用域链上没有任何一个对象含有属性X, 那么就认为这段代码的作用域链上不存在X, 并最终抛出一个引用错误(ReferenceError)异常。</span></p>
<p><span style="font-size: 15px;">在JavaScript的最顶层代码中（也就是不包含在任何函数定义内的代码）， 作用域链由一个全局对象组成。 不包含嵌套的函数体内， 作用域链上有两个对象，第一个是定义函数参数和局部变量的对象，第二个是全局对象。在一个嵌套的函数体内，作用域链上至少有三个对象。理解对象链的创建规则是非常重要的，当定义一个函数时，他实际上保存一个作用域链，当调用这个函数时，它创建一个新的对象来存储它的局部变量。并将这个对象添加至保存的那个作用域链上，同时创建一个新的更长的表示函数调用作用域的链，对于嵌套函数来讲，每次调用外部函数时，内部函数又会重新定义一遍，因为每次调用外部函数的时候，作用域链都是不同的，内部函数在每次定义的时候都有微妙的差别，在每次调用外部函数时，内部函数的代码都是相同的，而且关联这段代码的作用域链也不相同。</span></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>