<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修charles代理设置与数据劫持' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>charles代理设置与数据劫持</center></div><div class='banquan'>原文出处:本文由博客园博主蓓蕾心晴提供。<br/>
原文连接:https://www.cnblogs.com/beileixinqing/p/11059189.html</div><br>
    <p>1、安装charles，点击帮助&mdash;&mdash;ssl代理&mdash;&mdash;在移动设备或远程浏览器上安装charles root证书，看到如下界面：</p>
<p><img src="./images/charles代理设置与数据劫持0.png" alt="" width="396" height="144" /></p>
<p>&nbsp;</p>
<p>2、在手机保证和电脑连接同一个wifi的前提下，开启手机代理，输入服务器地址：192.168.5.252，端口号为：8888，有时候新手机连接代理，charles会提示是否允许，点击allow，如果没提示需要在手机端安装证书后设置一下(设置方法：ios : 设置&mdash;&mdash;通用&mdash;&mdash;关于本机&mdash;&mdash;证书信任设置&mdash;&mdash;找到证书&mdash;&mdash;开启信任开关)；</p>
<p>3、手机端安装charles证书，浏览器输入：chls.pro/ssl，打开根据提示安装证书，在手机通用&mdash;&mdash;关于本机&mdash;&mdash;证书信任设置&mdash;&mdash;打开后找到刚刚安装的证书，选择打开；</p>
<p>4、电脑端也需要安装证书，在charles软件中点帮助&mdash;&mdash;ssl代理&mdash;&mdash;安装charles root证书，根据提示一步一步安装证书；</p>
<p>6、此时就可以在手机端访问app了，charles会显示每个访问请求的接口。</p>
<p>数据劫持：</p>
<p>方法一：本地映射</p>
<p>手机点击app页面，可以看到charles请求接口，选择charles左侧请求列表中最内层的接口，打开查看返回的数据，已经得到请求的数据，右键&mdash;&mdash;本地映射，打开后已默认填好端口协议主机号，我们把查询（即参数）删除，也可以选择填入需要的参数，参数格式:*参数a=111*，映射到本地路径&mdash;&mdash;选择&mdash;&mdash;选择本地mock.json文件位置，保存。则这时再次请求的时候，可以看到已经直接返回了我们的mock数据。</p>
<p>【映射这里可能会遇到的坑：当改变mock数据之后，再次请求可能返回的不是最新改变的，需要在本地映射中先选择别的映射文件，再选回来原来的文件，则可返回修改之后的mock数据】</p>
<p>方法二：rewrite</p>
<p>配置rewrite重写，适用于直接将线上offer劫持，进行错误复现和调试。</p>
<p>工具&mdash;&mdash;重写&mdash;&mdash;启用重写&mdash;&mdash;添加&mdash;&mdash;起名称&mdash;&mdash;添加重写规则&mdash;&mdash;类型选择正文&mdash;&mdash;往哪里选择响应&mdash;&mdash;</p>
<p>匹配值：比如：&ldquo;url&rdquo;</p>
<p>全部替换："值:</p>
<p>也可以把线上的url放入另一个自定义字段中，进行统一替换，比如替换值："url:"新url","url_old:"</p>
<p>&nbsp;【注意】</p>
<p>有时候charles都配置好了，但是抓到的接口数据都是unknow,在charles&mdash;&mdash;代理&mdash;&mdash;访问控制设置（Access control settings）&mdash;&mdash;添加0.0.0.0/0，就可以了。</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>