<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修js - 立即执行函数' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>js - 立即执行函数</center></div><div class='banquan'>原文出处:本文由博客园博主刘刘啊提供。<br/>
原文连接:https://www.cnblogs.com/L-xmin/p/11178599.html</div><br>
    <blockquote>
<p>问题引入：我们写函数，就是为了使我们的代码更加模块化，然后，提高代码的重用。但是，有些函数，从定义到整个函数就运行了一遍。但是这个函数依然存在，就占用了大量的内存。那有没有一种函数，执行完了之后，就不存在了的呢？</p>
</blockquote>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; font-size: 18px;">1、什么是匿名函数</span></p>
<p>声明一个函数，并马上调用这个匿名函数就叫做立即执行函数；也可以说立即执行函数是一种语法，让你的函数在定义以后立即执行；</p>
<p>立即执行函数的创建步骤，看下图：</p>
<p><img src="./images/js - 立即执行函数0.png" alt="" /></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; font-size: 18px;">2、立即函数形式</span></p>
<p style="margin-left: 30px;">接下来看立即执行函数的两种常见形式：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">匿名函数包裹在一个括号运算符中，后面跟一个小括号</span>
(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">...</span>
<span style="color: #000000;">})()

</span><span style="color: #008000;">//</span><span style="color: #008000;">//匿名函数后面跟一个小括号，整个包裹在一个括号运算符中</span>
(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">...</span>
}())</pre>
</div>
<p>()，！，+，-，=等运算符都能起到立即执行的作用，这些运算符的作用就是将<span style="text-decoration: underline;">匿名函数或函数声明转换为函数表达式。</span></p>
<p><span style="text-decoration: underline;">要注意两点，一是函数体后面要有小括号()，二是函数体必须是函数表达式而不能是函数声明。</span></p>
<div class="cnblogs_code">
<pre><code>(<span style="color: #0000ff;">function</span> (test) {    <span style="color: #008000;">//</span><span style="color: #008000;">使用()运算符,输出123</span>
<span style="color: #000000;">    console.log(test);
})(</span>123<span style="color: #000000;">);

(</span><span style="color: #0000ff;">function</span> (test) {    <span style="color: #008000;">//</span><span style="color: #008000;">使用()运算符,输出123</span>
<span style="color: #000000;">    console.log(test);
}(</span>123<span style="color: #000000;">));

</span>!<span style="color: #0000ff;">function</span> (test) {    <span style="color: #008000;">//</span><span style="color: #008000;">使用!运算符,输出123</span>
<span style="color: #000000;">    console.log(test);
}(</span>123<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> fn = <span style="color: #0000ff;">function</span> (test) {  <span style="color: #008000;">//</span><span style="color: #008000;">使用=运算符,输出123</span>
<span style="color: #000000;">    console.log(test);
}(</span>123);</pre>
</div>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; font-size: 18px;">3.立即执行函数好处</span></p>
<ol>
<li>不必为函数命名，避免了污染全局变量</li>
<li>立即执行函数内部形成了一个单独的作用域，可以封装一些外部无法读取的私有变量</li>
<li>封装变量</li>
</ol>
<p>总而言之：立即执行函数会形成一个单独的作用域，我们可以封装一些临时变量或者局部变量，避免污染全局变量。以一个面试题为例：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> liList = ul.getElementsByTagName('li'<span style="color: #000000;">)
</span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i=0; i&lt;6; i++<span style="color: #000000;">){
  liList[i].onclick </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    alert(i) </span><span style="color: #008000;">//</span><span style="color: #008000;"> 为什么 alert 出来的总是 6，而不是 0、1、2、3、4、5</span>
<span style="color: #000000;">  }
}</span></pre>
</div>
<p>为什么 alert 的总是 6 呢，因为 i 是贯穿整个作用域的，而不是给每个 li 分配了一个 i，如下：</p>
<p>&nbsp;<img src="./images/js - 立即执行函数1.png" alt="" /></p>
<p><span style="color: #ff0000; font-size: 16px;">划重点：用户一定是在for运行完了之后，才点击的，此时i为6</span></p>
<p>&nbsp;解决方案：</p>
<p>用立即执行函数给每个li创造一个独立作用域即可（当然还有其他办法）：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> liList = ul.getElementsByTagName('li'<span style="color: #000000;">)
</span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i=0; i&lt;6; i++<span style="color: #000000;">){
  </span>!<span style="color: #0000ff;">function</span><span style="color: #000000;">(ii){
    liList[ii].onclick </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
      alert(ii) </span><span style="color: #008000;">//</span><span style="color: #008000;"> 0、1、2、3、4、5</span>
<span style="color: #000000;">    }
  }(i)
}</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-size: 18px; background-color: #ffff00;">3.立即执行函数使用场景</span></p>
<div>
<div>1、你的代码在页面加载完成之后，不得不执行一些设置工作，比如时间处理器，创建对象等等。<br />
2、所有的这些工作只需要执行一次，比如只需要显示一个时间。<br />
3、但是这些代码也需要一些临时的变量，但是初始化过程结束之后，就再也不会被用到，如果将这些变量作为全局变量，不是一个好的注意，我们可以用立即执行函数&mdash;&mdash;去将我们所有的代码包裹在它的局部作用域中，不会让任何变量泄露成全局变量。看如下代码：</div>
<div><img src="./images/js - 立即执行函数2.png" alt="" /></div>
<div>如果没有被包裹在立即执行函数中，那么临时变量todaydom,days,today,year,month,date,day,msg都将成为全局变量（初始化代码遗留的产物）。用立即执行函数之后，这些变量都不会在全局变量中存在，以后也不会其他地方使用，有效的避免了污染全局变量。</div>



</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>