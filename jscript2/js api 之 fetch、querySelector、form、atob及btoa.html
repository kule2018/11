<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修js api 之 fetch、querySelector、form、atob及btoa' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>js api 之 fetch、querySelector、form、atob及btoa</center></div><div class='banquan'>原文出处:本文由博客园博主funnyZpC提供。<br/>
原文连接:https://www.cnblogs.com/funnyzpc/p/11095862.html</div><br>
    <h3 id="js-api-之-fetchqueryselectorformatob及btoa">js api 之 fetch、querySelector、form、atob及btoa</h3>
<p>转载请注明出处: <a href="https://www.cnblogs.com/funnyzpc/p/11095862.html" class="uri">https://www.cnblogs.com/funnyzpc/p/11095862.html</a></p>
<p>js api即为JavaScript内置函数，本章就说说几个比较实用的内置函数，内容大致如下：</p>
<ul>
<li>fecth http请求函数</li>
<li>querySelector 选择器</li>
<li>form 表单函数</li>
<li>atob与btoa Base64函数</li>
</ul>
<h4 id="base64之atob与btoa">Base64之atob与btoa</h4>
<p>以前，在前端，我们是引入Base64.js后调用api实现数据的Base64的编码和解码的运算，现在新的ES标准为我们提供了Base64<br />
的支持，主要用法如下：</p>
<ul>
<li>编码：<strong>window.btoa</strong>(<em>param</em>);</li>
</ul>
<pre><code><code>   输入&gt; window.btoa(&quot;hello&quot;);
   输出&gt; &quot;aGVsbG8=&quot;</code></pre>
<ul>
<li>解码：<strong>window.atob</strong>(<em>param</em>)</li>
</ul>
<pre><code><code>   输入：window.atob(&quot;aGVsbG8=&quot;);
   输出：&quot;hello&quot;</code></pre>
<h4 id="dom选择器之-queryselector">DOM选择器之 querySelector</h4>
<p>DOM选择器在jQuery中用的十分广泛，极大地方便了前端开发，现在你有了__querySelector__,不用引入恼人的js及<br />
各种js依赖，一样便捷开发～</p>
<ul>
<li>ID选择</li>
</ul>
<pre><code><code>    // 获取DOM中的内容
    document.querySelector(&quot;#title&quot;).innerText;
    // 将DOM设置为粉红色背景
    document.querySelector(&quot;#title&quot;).style.backgroundColor=&quot;pink&quot;;
    // 获取DOM的class属性
    document.querySelector(&quot;#title&quot;).getAttribute(&quot;class&quot;);
    // 移除DOM
    document.querySelector(&quot;#title&quot;).remove();
    // 获取子DOM
    document.querySelector(&quot;#title&quot;).childNodes;
    // 给DOM添加click事件(点击后弹出 &quot;success&quot;)
    document.querySelector(&quot;#title&quot;).onclick = function(){alert(&quot;success&quot;)};
    // 给DOM添加属性(添加一个可以为name，value为hello的属性)
    document.querySelector(&quot;#title&quot;).setAttribute(&quot;name&quot;,&quot;hello&quot;);</code></pre>
<ul>
<li>class选择</li>
</ul>
<pre><code><code>    // 获取DOM中的内容
    document.querySelector(&quot;.title&quot;).innerText;
    // 将DOM设置为粉红色背景
    document.querySelector(&quot;.title&quot;).style.backgroundColor=&quot;pink&quot;;
    // 获取DOM的class属性
    document.querySelector(&quot;.title&quot;).getAttribute(&quot;class&quot;);
    // 移除DOM
    document.querySelector(&quot;.title&quot;).remove();
    // 获取子DOM
    document.querySelector(&quot;.title&quot;).childNodes;
    // 给DOM添加click事件(点击后弹出 &quot;success&quot;)
    document.querySelector(&quot;.title&quot;).onclick = function(){alert(&quot;success&quot;)};
</code></pre>
<ul>
<li>tag选择器(DOM名称)</li>
</ul>
<pre><code><code>    // 获取DOM中的内容
    document.querySelector(&quot;h4&quot;).innerText;
    // 将DOM设置为粉红色背景
    document.querySelector(&quot;h4&quot;).style.backgroundColor=&quot;pink&quot;;
    // 获取DOM的class属性
    document.querySelector(&quot;h4&quot;).getAttribute(&quot;class&quot;);
    // 移除DOM
    document.querySelector(&quot;h4&quot;).remove();
    // 获取子DOM
    document.querySelector(&quot;h4&quot;).childNodes;
    // 给DOM添加click事件(点击后弹出 &quot;success&quot;)
    document.querySelector(&quot;h4&quot;).onclick = function(){alert(&quot;success&quot;)};
    // 给DOM添加属性(添加一个可以为name，value为hello的属性)
    document.querySelector(&quot;h4&quot;).setAttribute(&quot;name&quot;,&quot;hello&quot;);</code></pre>
<ul>
<li>自定義屬性選擇(多用於表單)</li>
</ul>
<pre><code><code>    // 获取DOM的value值
    document.querySelector(&quot;input[name=age]&quot;).value;
    // 将DOM设置为粉红色背景
    document.querySelector(&quot;input[name=age]&quot;).style.backgroundColor=&quot;pink&quot;;
    // 获取DOM的class属性
    document.querySelector(&quot;input[name=age]&quot;).getAttribute(&quot;class&quot;);
    // 移除DOM
    document.querySelector(&quot;input[name=age]&quot;).remove();
    // 获取子DOM
    document.querySelector(&quot;input[name=age]&quot;).childNodes;
    // 给DOM添加click事件(点击后弹出 &quot;success&quot;)
    document.querySelector(&quot;input[name=age]&quot;).onclick = function(){alert(&quot;success&quot;)};
    // 给DOM添加属性(添加一个可以为name，value为hello的属性)
    document.querySelector(&quot;input[name=age]&quot;).setAttribute(&quot;name&quot;,&quot;hello&quot;);</code></pre>
<h4 id="form表單函數">form表單函數</h4>
<p>以前我們是沒有表單函數的時候，如果做表單的提交大多定義一個提交按鈕，用jQuery+click函數實現表單提交，<br />
或者獲取參數後使用ajax提交，對於後者暫且不說，對於前者 ES標準提供了新的函數 form函數，當然這個只是<br />
document的一個屬性而已，需要提醒的是這個函數使用的前提是需要給form標籤定義一個name属性，这个name属性<br />
的值即为表单函数的函数名字(也可为属性),具体用法如下；</p>
<p>比如我们的表单是这样的：</p>
<pre><code><code>   // html表单
   &lt;form name=&quot;fm&quot; method=&quot;post&quot; action=&quot;/submit&quot;&gt;
       &lt;input type=&quot;text&quot; name=&quot;age&quot; placeholder=&quot;请输入年龄&quot;/&gt;
   &lt;/form&gt;</code></pre>
<p>这个时候我们可以这样操作表单：</p>
<pre><code><code>    // 提交表单
    document.fm.submit();
    // 获取表单的name属性值
    document.fm.name;
    // 获取表单的DOM
    document.fm.elements;
    // resetb表单
    document.fm.reset();
    // ...更多操作请在chrome控制台输入命令</code></pre>
<h4 id="fetch">fetch</h4>
<p>fetch 为js 新内置的http请求函数，用于替代ajax及原始的XMLHttpRequest，与ajax相似的是它提供了请求头，异步或同步方法，同时也提供了GET、PUT、DELETE、OPTION等<br />
请求方式,唯一缺憾的是除了POST(json)方式提交外，其他方式均需要自行组装参数，这里仅给出几个简单样例供各位参考。</p>
<h5 id="fetchget请求">fetch：GET请求</h5>
<p>html:</p>
<pre><code><code>    &lt;form method=&quot;GET&quot; style=&quot;margin-left:5%;&quot;&gt;
        &lt;label&gt;name:&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;
        &lt;label&gt;price:&lt;/label&gt;&lt;input type=&quot;number&quot; name=&quot;price&quot;/&gt;
        &lt;label&gt;&lt;button type=&quot;button&quot; onclick=&quot;getAction()&quot;&gt;GET提交&lt;/button&gt;&lt;/label&gt;
    &lt;/form&gt;</code></pre>
<p>javaScript:</p>
<pre><code><code>    function getAction() {
            // 组装请求参数
            var name = document.querySelector(&quot;input[name=name]&quot;).value;
            var price = document.querySelector(&quot;input[name=price]&quot;).value;

            fetch(&quot;/get?name=&quot;+name+&quot;&amp;price=&quot;+price, {
                method: &#39;GET&#39;,
                headers: {
                    &#39;Content-Type&#39;: &#39;application/json&#39;
                },
                // body: JSON.stringify({&quot;name&quot;:name,&quot;price&quot;:price})
            })
            .then(response =&gt; response.json())
            .then(data =&gt;
                document.getElementById(&quot;result&quot;).innerText = JSON.stringify(data))
            .catch(error =&gt;
                console.log(&#39;error is:&#39;, error)
            );
        }</code></pre>
<p>这里的GET请求(如上)，注意如下：</p>
<ul>
<li>需手动拼接参数值<code>/get?name=name&amp;price=price</code></li>
<li>由于GET请求本身是没有请求体的，所以fetch的请求配置中一定不能有body的配置项</li>
<li>由于GET请求本身是没有请求体的，所以headers项可以不配置</li>
<li>请求结果在第一个then的时候，数据是一个steam，所以需要转换成json(调用json()方法)</li>
<li>请求结果在第二个then的时候仍然是一个箭头函数，这个时候如需要对数据进行处理请调用自定义函数处理</li>
</ul>
<h5 id="fetchpostjson请求">fetch：POST(json)请求</h5>
<p>html:</p>
<pre><code><code>    &lt;form method=&quot;GET&quot; style=&quot;margin-left:5%;&quot;&gt;
        &lt;label&gt;name:&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;
        &lt;label&gt;price:&lt;/label&gt;&lt;input type=&quot;number&quot; name=&quot;price&quot;/&gt;
        &lt;label&gt;&lt;button type=&quot;button&quot; onclick=&quot;getAction()&quot;&gt;GET提交&lt;/button&gt;&lt;/label&gt;
    &lt;/form&gt;</code></pre>
<p>javaScript:</p>
<pre><code><code>    function getAction() {
            // 组装请求参数
            var name = document.querySelector(&quot;input[name=name]&quot;).value;
            var price = document.querySelector(&quot;input[name=price]&quot;).value;
            price = Number(price)
            fetch(&quot;/post&quot;, {
                method: &#39;POST&#39;,
                headers: {
                    &#39;Content-Type&#39;: &#39;application/json&#39;
                },
                body: JSON.stringify({&quot;name&quot;:name,&quot;price&quot;:price})
            })
            .then(response =&gt; response.json())
            .then(data =&gt;
                document.getElementById(&quot;result&quot;).innerText = JSON.stringify(data))
            .catch(error =&gt;
                console.log(&#39;error is:&#39;, error)
            );
       }</code></pre>
<p>这里需要注意对是：</p>
<ul>
<li>Post请求的请求头的内容类型必须是<code>application/json</code>,至于<code>application/x-www-form-urlencoded</code>我一直没测通过，请各位指点</li>
<li>请求体中的数据对象必须使用JSON.stringify() 函数转换成字符串</li>
</ul>
<h5 id="fetchpostform请求">fetch：POST(form)请求</h5>
<p>html：</p>
<pre><code><code>       &lt;form method=&quot;GET&quot; style=&quot;margin-left:5%;&quot; name=&quot;fm&quot; action=&quot;/form&quot;&gt;
            &lt;label&gt;name:&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;
            &lt;label&gt;price:&lt;/label&gt;&lt;input type=&quot;number&quot; name=&quot;price&quot;/&gt;
        &lt;/form&gt;</code></pre>
<p>javaScript:</p>
<pre><code><code>        function getAction() {
            // 组装请求参数
            let name = document.querySelector(&quot;input[name=name]&quot;).value;
            let price = document.querySelector(&quot;input[name=price]&quot;).value;
            // price = Number(price)
            /*
            let formdata = new FormData();
            formdata.append(&quot;name&quot;,name);
            formdata.append(&quot;price&quot;,price);
            */
            let data = new URLSearchParams();
            data.set(&quot;name&quot;,name);
            data.set(&quot;price&quot;,price);
            fetch(&quot;/form&quot;, {
                method: &#39;POST&#39;,
                headers: {
                     &quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded;charset=UTF-8&quot;
                },
                body: data
            })
            .then( response =&gt;response.json() )
            .then(function (data){
                this.success(data);
            })
            .catch(error =&gt;
                console.log(&#39;error is:&#39;, error)
            );
        }
        function success(data) {
            document.getElementById(&quot;result&quot;).innerText = JSON.stringify(data)
            alert(window.atob(data.sign))
        }</code></pre>
<p>可以看到中间改过几次，实在不理想，后有改成URLSearchParams来拼装请求数据，后来成功了，各位要有其他方式请指点一二。</p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>