<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修【前端】将前台table数据导出excel表格' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>【前端】将前台table数据导出excel表格</center></div><div class='banquan'>原文出处:本文由博客园博主sks95提供。<br/>
原文连接:https://www.cnblogs.com/suncos/p/11828266.html</div><br>
    <p>1.首先引用jquery以及table2excel</p>
<pre><code></pre>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #ff0000;"> src</span><span style="color: #0000ff;">="js/jquery.table2excel.min.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #ff0000;"> src</span><span style="color: #0000ff;">="js/jquery.min.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>2.表格部分</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">table  </span><span style="color: #ff0000;">lay-filter</span><span style="color: #0000ff;">="demo"</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">="layui-table"</span><span style="color: #ff0000;">  id</span><span style="color: #0000ff;">="excTable"</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">thead</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tr </span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_ICNumber', width:150, sort:true}"</span><span style="color: #0000ff;">&gt;</span>工号<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_Name', width:150, sort:true}"</span><span style="color: #0000ff;">&gt;</span>姓名<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_WorkTeam', width:100, sort:true}"</span><span style="color: #0000ff;">&gt;</span>班次<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_AlcoholStatus', width:100, sort:true}"</span><span style="color: #0000ff;">&gt;</span>考勤方式<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_Cause', width:150, sort:true}"</span><span style="color: #0000ff;">&gt;</span>考勤状态<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_TestDateTime', width:200, sort:true}"</span><span style="color: #0000ff;">&gt;</span>考勤时间<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">th </span><span style="color: #ff0000;">lay-data</span><span style="color: #0000ff;">="{field:'emp_workHours', width:100, sort:true}"</span><span style="color: #0000ff;">&gt;</span>工时<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">th</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">thead</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tbody</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">c:forEach </span><span style="color: #ff0000;">items</span><span style="color: #0000ff;">="${maps[0].attences}"</span><span style="color: #ff0000;"> var</span><span style="color: #0000ff;">="model"</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;</span>
                        <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--&lt;</span><span style="background-color: #f5f5f5; color: #000000;">td style</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">display: none</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">${model.id}</span><span style="background-color: #f5f5f5; color: #000000;">&lt;/</span><span style="background-color: #f5f5f5; color: #000000;">td</span><span style="background-color: #f5f5f5; color: #000000;">&gt;--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_ICNumber}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_Name}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_WorkTeam}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">c:if </span><span style="color: #ff0000;">test</span><span style="color: #0000ff;">="${model.emp_AlcoholStatus=='0'}"</span><span style="color: #0000ff;">&gt;</span>
                            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>正常<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">c:if</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">c:if </span><span style="color: #ff0000;">test</span><span style="color: #0000ff;">="${model.emp_AlcoholStatus=='1'}"</span><span style="color: #0000ff;">&gt;</span>
                            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>饮酒<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">c:if</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">c:if </span><span style="color: #ff0000;">test</span><span style="color: #0000ff;">="${model.emp_AlcoholStatus=='2'}"</span><span style="color: #0000ff;">&gt;</span>
                            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>醉酒<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">c:if</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">c:if </span><span style="color: #ff0000;">test</span><span style="color: #0000ff;">="${model.emp_AlcoholStatus=='4'}"</span><span style="color: #0000ff;">&gt;</span>
                            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>手动添加,未监测<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">c:if</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_Cause}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_TestDateTime}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>${model.emp_workHours}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">td</span><span style="color: #0000ff;">&gt;</span>

                    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tr</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">c:forEach</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tbody</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">table</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; &nbsp; &nbsp;以上有用的部分只有数据和id，其他内容可以不考虑。</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">function</span><span style="color: #000000;"> etest() {
        $(</span>"#excTable"<span style="color: #000000;">).table2excel({
            exclude: </span>".id"<span style="color: #000000;">,
            name: </span>"Excel Document Name"<span style="color: #000000;">,
            filename: </span>"考勤表"<span style="color: #000000;">,
            fileext: </span>".xls"<span style="color: #000000;">,
            columns: </span>"0,1,7,9,10,11,12",<span style="color: #008000;">//</span><span style="color: #008000;">指定不导出列 实例：columns: "0,1,2,3",下标从0开始，代表不导出第一列--第四列</span>
            exclude_img: <span style="color: #0000ff;">false</span><span style="color: #000000;">,
            exclude_links: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">,
            exclude_inputs: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">
        });
    }
</span><span style="color: #008000;">//</span><span style="color: #008000;">      table2excel插件的可用配置参数有：</span><span style="color: #008000;">
//
//</span><span style="color: #008000;">            exclude：不被导出的表格行的CSS class类。</span><span style="color: #008000;">
//</span><span style="color: #008000;">            name：导出的Excel文档的名称。</span><span style="color: #008000;">
//</span><span style="color: #008000;">            filename：Excel文件的名称。</span><span style="color: #008000;">
//</span><span style="color: #008000;">            exclude_img：是否导出图片。</span><span style="color: #008000;">
//</span><span style="color: #008000;">            exclude_links：是否导出超链接</span><span style="color: #008000;">
//</span><span style="color: #008000;">            exclude_inputs：是否导出输入框中的内容。</span></pre>
</div>
<p>&nbsp;</p>
<p>以上在加一个按钮就可以使用表格导出功能了</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="layui-btn"</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">="etest()"</span><span style="color: #0000ff;">&gt;</span>导出<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>