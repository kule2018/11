<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修前端实现文件在线预览txt，pdf，doc，xls，ppt几种格式' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>前端实现文件在线预览txt，pdf，doc，xls，ppt几种格式</center></div><div class='banquan'>原文出处:本文由博客园博主思绪在漫游提供。<br/>
原文连接:https://www.cnblogs.com/leileilei/p/10755611.html</div><br>
    <p><strong>做法就是使用iframe标签</strong></p>
<p><strong>1.text，pdf的文件预览</strong></p>
<div>
<div class="cnblogs_code">
<pre><code>&lt;iframe class="filename" :src="文件的地址" width='100%' height='600' frameborder='1' &gt;&lt;/iframe&gt;</pre>
</div>
<p><strong>2.doc,xls,ppt等office的预览</strong></p>
<div class="cnblogs_code">
<pre><code>&lt;iframe class="filename"  :src="https://view.officeapps.live.com/op/view.aspx?src=后面是文件的地址" width='100%' height='600' frameborder='1' &gt;&lt;/iframe&gt;</pre>
</div>
<p><strong>3.我们可以看出，差别只有src的属性，所以要设置文件预览同时可以满足txt，pdf，和office类型格式的文件，只需要配置src就可以，根据文件后缀判断如果是office的类型就在url前加上</strong></p>
<pre><code><strong>https://view.officeapps.live.com/op/view.aspx?src=</strong></pre>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">for</span> (let i=0;i&lt;<span style="color: #0000ff;">this</span>.data.quoteInfo.goodsList.length;i++<span style="color: #000000;">) {
    </span><span style="color: #0000ff;">for</span>(let j=0;j&lt;<span style="color: #0000ff;">this</span>.data.quoteInfo.goodsList[i].goodsAttachments.fileAttachmentList.length;j++<span style="color: #000000;">){
      let value </span>= <span style="color: #0000ff;">this</span><span style="color: #000000;">.data.quoteInfo.goodsList[i].goodsAttachments.fileAttachmentList[j]
      let valueFormat </span>= value.name.substring(value.name.lastIndexOf('.') + 1<span style="color: #000000;">)//前面逻辑不用看，至此拿到文件后缀
      </span><span style="color: #0000ff;">if</span>(valueFormat=='doc'|| valueFormat=='docx'|| valueFormat=='xls' || valueFormat=='xlsx'<span style="color: #000000;">) {//根据后缀判断如果是office格式的，做路径的拼接，拼接微软在线预览地址即可
      要预览的文件地址</span>='https://view.officeapps.live.com/op/view.aspx?src='+<span style="color: #0000ff;">要预览的文件地址</span><span style="color: #000000;">
    }
  }
}<br /></span></pre>
</div>
<p><strong>4.iframe 的宽高边框都是可配的，:width=宽的变量；:height=高的变量；:frameborder=边框的变量，no则是无边框</strong></p>
<p>这些格式之外的文件没有办法预览如RAR，ZIP，会直接提醒你下载，基本完成预览的需求，重点就是预览文件前，把office文件的路径配置下，使用微软提供的在线office预览</p>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>