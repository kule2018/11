<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发</center></div><div class='banquan'>原文出处:本文由博客园博主RopeHuo提供。<br/>
原文连接:https://www.cnblogs.com/rope/p/10723128.html</div><br>
    <h1><strong><span style="font-family: 宋体;">一、</span>ES6<span style="font-family: 宋体;">语法</span></strong></h1>
<p>ES6<span style="font-family: 宋体;">中对数组新增了几个函数：</span><span style="font-family: Consolas;">map()</span><span style="font-family: 宋体;">、</span><span style="font-family: Consolas;">filter()</span><span style="font-family: 宋体;">、</span><span style="font-family: Consolas;">reduce()</span></p>
<p>ES5<span style="font-family: 宋体;">新增的</span><span style="font-family: Consolas;">forEach()</span><span style="font-family: 宋体;">。</span></p>
<p>都是一些语法糖。</p>
<h2><strong>1.1 forEach()<span style="font-family: 宋体;">遍历数组</span></strong></h2>
<p>forEach()<span style="font-family: 宋体;">方法用来循环遍历数组，方法中的</span><span style="font-family: Consolas;">function</span><span style="font-family: 宋体;">回调函数接收</span><span style="font-family: Consolas;">3</span><span style="font-family: 宋体;">个参数</span></p>
<p><span style="font-family: 宋体;">参数</span>1<span style="font-family: 宋体;">是遍历的数组内容</span><span style="font-family: Consolas;">(item)</span><span style="font-family: 宋体;">；参数</span><span style="font-family: Consolas;">2</span><span style="font-family: 宋体;">是对应的数组索引</span><span style="font-family: Consolas;">(index)</span><span style="font-family: 宋体;">，参数</span><span style="font-family: Consolas;">3</span><span style="font-family: 宋体;">是是数组本身</span><span style="font-family: Consolas;">(array)</span><span style="font-family: 宋体;">。</span></p>
<div class="cnblogs_code">
<pre><code>[].forEach(<span style="color: #0000ff;">function</span><span style="color: #000000;">(item,index,array){
...
})
</span><span style="color: #0000ff;">var</span> arr = ["白板","幺鸡","红中","发财","八万"<span style="color: #000000;">];
arr.forEach(</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(item,index,array){
   console.log(item,index,array)
})</span></pre>
</div>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发0.png" alt="" /></p>
<p>forEach<span style="font-family: 宋体;">函数没有返回值</span></p>
<p>for<span style="font-family: 宋体;">今后是创建数组，遍历或操作数组可以交给</span><span style="font-family: Consolas;">forEach</span><span style="font-family: 宋体;">方法。</span></p>
<hr />
<h2><strong>1.2 map()<span style="font-family: 宋体;">映射</span></strong></h2>
<p>map<span style="font-family: 宋体;">方法的作用，&ldquo;映射&rdquo;也就是<strong><span style="color: #ff0000;">原数组被&ldquo;映射&rdquo;成对应的新数组</span>。</strong></span></p>
<div class="cnblogs_code">
<pre><code>[].map(<span style="color: #0000ff;">function</span><span style="color: #000000;">(item,index,array){
...
})

</span><span style="color: #0000ff;">var</span> arr = ["白板","幺鸡","红中","发财","八万"<span style="color: #000000;">];
arr.map(</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(item,index,array){
   console.log(item,index,array)
})</span></pre>
</div>
<p>&nbsp;<img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发1.png" alt="" /></p>
<p>&nbsp;</p>
<p>案例：比如创建一个新数组，新数组的每一项是原数组的两倍</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> arr1 = [6,8,10,88,100,200<span style="color: #000000;">];
</span><span style="color: #0000ff;">var</span> arr2 = arr1.map(<span style="color: #0000ff;">function</span><span style="color: #000000;">(item){
   </span><span style="color: #0000ff;">return</span> item * 2<span style="color: #000000;">;
})
console.log(arr1)
console.log(arr2)</span></pre>
</div>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发2.png" alt="" /></p>
<p>map()<span style="font-family: 宋体;">函数本质是依次遍历原数组中的每一项，将每一项都执行一遍函数中的语句，返回一个新的数组。</span></p>
<p>提示：</p>
<p>l&nbsp;<span style="font-family: 宋体;">函数需要有</span>return<span style="font-family: 宋体;">值，如果没有，数组所有想都被映射成</span><span style="font-family: Consolas;">undefined</span></p>
<p>l&nbsp;map<span style="font-family: 宋体;">返回的数组一定和原数组长度一样。</span></p>
<hr />
<h2><strong>1.3 filter()<span style="font-family: 宋体;">过滤</span></strong></h2>
<p>filter<span style="font-family: 宋体;">为&ldquo;过滤&rdquo;、&ldquo;筛选&rdquo;之意，指从原数组中</span><span style="font-family: Consolas;">filter</span><span style="font-family: 宋体;">某些项后，</span><span style="color: #ff0000;"><strong>返回过滤后的新数组</strong></span><span style="font-family: 宋体;">，用法和</span>map<span style="font-family: 宋体;">相似。</span></p>
<p>&nbsp;</p>
<p>案例：从原数组中，挑选所有的偶数，返回新的数组。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> arr1 = [6,8,10,77,88,100,200,1,3,5<span style="color: #000000;">];
</span><span style="color: #0000ff;">var</span> arr2 = arr1.filter(<span style="color: #0000ff;">function</span><span style="color: #000000;">(item){
   </span><span style="color: #0000ff;">return</span> item % 2 == 0<span style="color: #000000;">;
});
console.log(arr1)
console.log(arr2)</span></pre>
</div>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发3.png" alt="" /></p>
<p>概述：arr<span style="font-family: 宋体;">中的每一项依次的执行函数，</span><span style="font-family: Consolas;">filter</span><span style="font-family: 宋体;">的回调函数需要返回布尔值，</span><span style="font-family: Consolas;">true</span><span style="font-family: 宋体;">则将值返回到新数组中，</span><span style="font-family: Consolas;">false</span><span style="font-family: 宋体;">则舍弃，进入下一次循环。</span></p>
<p>&nbsp;</p>
<p>filter<span style="font-family: 宋体;">和</span><span style="font-family: Consolas;">map</span><span style="font-family: 宋体;">相同：都会遍历数组每一项。</span></p>
<p>filter<span style="font-family: 宋体;">和</span><span style="font-family: Consolas;">map</span><span style="font-family: 宋体;">不相同：</span><span style="font-family: Consolas;">map</span><span style="font-family: 宋体;">返回数组不会少项，</span><span style="font-family: Consolas;">filter</span><span style="font-family: 宋体;">可能会少项。</span></p>
<hr />
<h2><strong>1.4<span style="font-family: 宋体;">取整运算符</span></strong></h2>
<div class="cnblogs_code">
<pre><code>console.log(~~11.5<span style="color: #000000;">);
console.log(</span>~~"11.5"<span style="color: #000000;">);
console.log(</span>~~"10px"<span style="color: #000000;">);
console.log(</span>~~<span style="color: #0000ff;">true</span><span style="color: #000000;">);
console.log(</span>~~<span style="color: #0000ff;">false</span>);</pre>
</div>
<hr />
<h1>二、<strong>underscore.js</strong></h1>
<p>jQuery<span style="font-family: 宋体;">是</span><span style="font-family: Consolas;">DOM</span><span style="font-family: 宋体;">之王，那么</span><span style="font-family: Consolas;">underscore</span><span style="font-family: 宋体;">就是数学之王（擅长计算）。</span></p>
<p>Underscore<span style="font-family: 宋体;">一个</span><span style="font-family: Consolas;">JavaScript</span><span style="font-family: 宋体;">实用库，提供了一整套函数式编程的实用功能，但是没有扩展任何</span><span style="font-family: Consolas;">JavaScript</span><span style="font-family: 宋体;">内置对象。</span></p>
<p>Underscore<span style="font-family: 宋体;">提供了</span><span style="font-family: Consolas;">100</span><span style="font-family: 宋体;">多个函数</span><span style="font-family: Consolas;">,</span><span style="font-family: 宋体;">包括常用的</span><span style="font-family: Consolas;">: map, filter, invoke </span><span style="font-family: 宋体;">当然还有更多专业的辅助函数</span><span style="font-family: Consolas;">,</span><span style="font-family: 宋体;">如</span><span style="font-family: Consolas;">:</span><span style="font-family: 宋体;">函数绑定</span><span style="font-family: Consolas;">, JavaScript</span><span style="font-family: 宋体;">模板功能</span><span style="font-family: Consolas;">,</span><span style="font-family: 宋体;">创建快速索引</span><span style="font-family: Consolas;">, </span><span style="font-family: 宋体;">强类型相等测试</span><span style="font-family: Consolas;">, </span><span style="font-family: 宋体;">等等</span><span style="font-family: Consolas;">.</span></p>
<p>Underscore<span style="font-family: 宋体;">不依赖环境，不限制使用场景，可以加载到</span><span style="font-family: Consolas;">HTML</span><span style="font-family: 宋体;">中在浏览器运行，也可以中</span><span style="font-family: Consolas;">Nodejs</span><span style="font-family: 宋体;">服务器环境中使用。封装了一堆实用函数，这些函数基本都是针对：数组、对象、函数的。</span></p>
<p>官网：<a href="http://underscorejs.org/"><span style="text-decoration: underline;">http://underscorejs.org/</span></a></p>
<p>中文文档：<a href="http://www.css88.com/archives/5443"><span>http://www.css88.com/archives/5443</span></a></p>
<p>CDN<span style="font-family: 宋体;">公共资源库：</span><a href="http://cdn.code.baidu.com/"><span>http://cdn.code.baidu.com/</span></a></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>生成0~<span style="color: #000000;">100的随机数：
_.random(</span>0,100); <span style="color: #008000;">//</span><span style="color: #008000;">生成0~100的随机数</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">创建一个范围整数数组：
_.range(</span>1,10) <span style="color: #008000;">//</span><span style="color: #008000;">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">取数组中的最大和最小值：
</span><span style="color: #0000ff;">var</span> num = [10, 5, 100, 2, 1000<span style="color: #000000;">];
console.log(_.min(num));
console.log(_.max(num));</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">把数组转成对象：
_.object([</span>'a', 'b', 'c'], [10, 20, 30]); <span style="color: #008000;">//</span><span style="color: #008000;">{ a: 10, b: 20, c: 30 }</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">each()遍历方法，对集合循环操作，可以遍历数组、类数组元素，arguments
_.each([</span>'小王','大王','鬼王'],<span style="color: #0000ff;">function</span><span style="color: #000000;">(item, index){
    console.log(item,index)
});</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">JSON遍历:
_.each({</span>'小王':'100','大王':'200','鬼王':'300'},<span style="color: #0000ff;">function</span><span style="color: #000000;">(item, index){
    console.log(item,index)
});</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">map(): 对集合以map方式遍历，产生一个新数组
</span><span style="color: #0000ff;">var</span> arr3 = _.map({a: 1, b: 2, c: 3}, <span style="color: #0000ff;">function</span><span style="color: #000000;">(item, key){
    </span><span style="color: #0000ff;">return</span> item * 3<span style="color: #000000;">;
});
console.log(arr3); </span><span style="color: #008000;">//</span><span style="color: #008000;">[3, 6, 9]</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">filter(): 过滤集合中符合条件的元素
</span><span style="color: #0000ff;">var</span> arr4 = _.filter([1, 2, 3, 4, 5, 6], <span style="color: #0000ff;">function</span><span style="color: #000000;">(item){ 
</span><span style="color: #0000ff;">return</span> item % 2 == 0<span style="color: #000000;">; 
});
console.log(arr4) </span><span style="color: #008000;">//</span><span style="color: #008000;">[ 2, 4, 6 ]</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">sortBy() 自定义比较方法
</span><span style="color: #0000ff;">var</span> sort = _.sortBy([3, 4, 2, 1 , 6 ,88], <span style="color: #0000ff;">function</span><span style="color: #000000;">(item){
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> Math.max(item);
})
console.log(sort)</span></pre>
</div>
<hr />
<h1>三、<strong>模板引擎</strong></h1>
<h2><strong>3.1 underscore<span style="font-family: 宋体;">模板引擎</span></strong></h2>
<p>template()<span style="font-family: 宋体;">方法可接受三个参数：</span></p>
<p><span style="font-family: 宋体;">参数</span>1<span style="font-family: 宋体;">：是必须的参数是模版字符串，你可以通过</span><span style="color: #ff0000;"><strong>&lt;%= &nbsp;%&gt; <span style="font-family: 宋体;">来插入变量</span></strong></span>，还可以通过<span style="color: #ff0000;"><strong>&lt;% &nbsp;%&gt;<span style="font-family: 宋体;">来插入</span><span style="font-family: Consolas;">js</span><span style="font-family: 宋体;">代码</span></strong></span>，也可以通过<span style="color: #ff0000;"><strong>&lt;%- &nbsp;%&gt;<span style="font-family: 宋体;">来进行</span><span style="font-family: Consolas;">html</span><span style="font-family: 宋体;">转义</span></strong></span><span style="font-family: 宋体;">，如果变量很多，可以使用</span>&lt;% print() %&gt;<span style="font-family: 宋体;">来简化。</span></p>
<p><span style="font-family: 宋体;">参数</span>2<span style="font-family: 宋体;">：是传入模版的数据，如果不传第二个参数，那么这个方法会返回一个模版函数，这个模版函数可以传入数据返回完成的模版，如果传入</span><span style="font-family: Consolas;">data</span><span style="font-family: 宋体;">参数则会直接返回一个已完成的模版。</span></p>
<p><span style="font-family: 宋体;">参数</span>3<span style="font-family: 宋体;">：是设置，比如这个方法默认是寻找</span><span style="font-family: Consolas;">&lt;% &nbsp;%&gt;</span><span style="font-family: 宋体;">来进行替换，可以通过设置它来改变具体的方法。</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">_.template 支持以下三种模板:
</span>&lt;% %&gt;<span style="color: #000000;">  执行一些代码
</span>&lt;%= %&gt;<span style="color: #000000;"> 在模板中打印或者说成输出一些值
</span>&lt;%- %&gt; 打印一些HTML转义的值</pre>
</div>
<p><span style="font-family: 宋体;">解释：</span></p>
<p>&lt;% %&gt; <span style="font-family: 宋体;">里包裹的是一些可执行的 </span><span style="font-family: Consolas;">JavaScript </span><span style="font-family: 宋体;">语句，比如 </span><span style="font-family: Consolas;">if-else </span><span style="font-family: 宋体;">语句，</span><span style="font-family: Consolas;">for </span><span style="font-family: 宋体;">循环语句等等。 </span></p>
<p>&lt;%= %&gt; <span style="font-family: 宋体;">会打印传入数据相应的 </span><span style="font-family: Consolas;">key </span><span style="font-family: 宋体;">的值， </span></p>
<p>&lt;%- %&gt; <span style="font-family: 宋体;">和前者相比，多了步 </span><span style="font-family: Consolas;">HTML </span><span style="font-family: 宋体;">实体编码的过程，可以有效防止 </span><span style="font-family: Consolas;">XSS </span><span style="font-family: 宋体;">攻击。</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">模板</span>
<span style="color: #0000ff;">var</span> str = "我很&lt;%= xinqing %&gt;啊！买了一个&lt;%= dongxi%&gt;，花了&lt;%= price%&gt;元"<span style="color: #000000;">;
</span><span style="color: #008000;">//</span><span style="color: #008000;">通过move字符串生成一个数据绑定函数</span>
<span style="color: #0000ff;">var</span> compile =<span style="color: #000000;"> _.template(str);
</span><span style="color: #008000;">//</span><span style="color: #008000;">数据</span>
<span style="color: #0000ff;">var</span> obj =<span style="color: #000000;"> {
   xinqing:</span>"高兴"<span style="color: #000000;">,
   dongxi:</span>"iPhone手机"<span style="color: #000000;">,
   price:</span>8888<span style="color: #000000;">
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">字符串和数据进行绑定生成</span>
str =<span style="color: #000000;"> compile(obj);
console.log(str)</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">还可以将</span>HTML<span style="font-family: 宋体;">作为模板，将</span><span style="font-family: Consolas;">JS</span><span style="font-family: 宋体;">的数据，注入进去，将模板中&ldquo;写死&rdquo;的内容都用模板的标记代替。</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('9875ede9-1c1b-46b1-b644-a2ed20776fb5')"><img id="code_img_closed_9875ede9-1c1b-46b1-b644-a2ed20776fb5" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_9875ede9-1c1b-46b1-b644-a2ed20776fb5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('9875ede9-1c1b-46b1-b644-a2ed20776fb5',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_9875ede9-1c1b-46b1-b644-a2ed20776fb5" class="cnblogs_code_hide">
<pre><code>&lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;title&gt;Document&lt;/title&gt;
    &lt;style type="text/css"&gt;<span style="color: #000000;">
        .bgColor{
            background: red;
        }
    </span>&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;table id="table"&gt;
        &lt;tr&gt;
            &lt;td&gt;学号&lt;/td&gt;
            &lt;td&gt;姓名&lt;/td&gt;
            &lt;td&gt;年龄&lt;/td&gt;
            &lt;td&gt;性别&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;!-- 我们使用一个故意写错的type的标签存放模板 --&gt;
&lt;script type="text/template" id="template"&gt;
    &lt;tr class="&lt;%= leiming %&gt;"&gt;
        &lt;td&gt;&lt;%= id %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= name %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= age %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= sex %&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/script&gt;
&lt;script type="text/javascript" src="js/jquery-3.2.1.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/underscore-min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
     <span style="color: #008000;">//</span><span style="color: #008000;">通过模板字符串生成一个数据绑定函数</span>
     <span style="color: #0000ff;">var</span> compile = _.template($("#template"<span style="color: #000000;">).html());

     </span><span style="color: #008000;">//</span><span style="color: #008000;">Ajax读取数据</span>
     $.get("data/student.json", <span style="color: #0000ff;">function</span><span style="color: #000000;">(data){
        </span><span style="color: #008000;">//</span><span style="color: #008000;">遍历数据</span>
        _.each(data.result, <span style="color: #0000ff;">function</span><span style="color: #000000;">(obj){
            obj.leiming </span>= obj.age &gt;= 18 ? "" : "bgColor"<span style="color: #000000;">;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">数据绑定，得到DOM字符串</span>
            <span style="color: #0000ff;">var</span> str =<span style="color: #000000;"> compile(obj);
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> 上树</span>
            $("table"<span style="color: #000000;">).append(str);
        })
     })
</span>&lt;/script&gt;</pre>
</div>
<span class="cnblogs_code_collapse">演示代码</span></div>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><strong>3.2<span style="font-family: 宋体;">模板引擎原理（</span><span style="font-family: 华文中宋;">JS</span><span style="font-family: 宋体;">）</span></strong></h2>
<p>拼接字符串很不爽，容易出错。</p>
<p>所以就有工程师在大量的实战中，提出模板引擎的概念，就是在一个完整的字符串中，把未定的量用特殊的语法来表示</p>
<div class="cnblogs_code">
<pre><code>@xinqing@</pre>
</div>
<p>然后把这些数据替换成标记，这个操作叫数据绑定。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('63652086-294e-48e2-afd7-ecb7a19ab23e')"><img id="code_img_closed_63652086-294e-48e2-afd7-ecb7a19ab23e" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_63652086-294e-48e2-afd7-ecb7a19ab23e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('63652086-294e-48e2-afd7-ecb7a19ab23e',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_63652086-294e-48e2-afd7-ecb7a19ab23e" class="cnblogs_code_hide">
<pre><code>&lt;script type="text/javascript"&gt;
     <span style="color: #008000;">//</span><span style="color: #008000;">模板</span>
     <span style="color: #0000ff;">var</span> str = "我很@xinqing@啊！买了一个@dongxi@，花了@price@元"<span style="color: #000000;">;

     </span><span style="color: #008000;">//</span><span style="color: #008000;">数据</span>
     <span style="color: #0000ff;">var</span> obj =<span style="color: #000000;"> {
        xinqing:</span>"高兴"<span style="color: #000000;">,
        dongxi:</span>"iPhone手机"<span style="color: #000000;">,
        price:</span>8888<span style="color: #000000;">
     }

     </span><span style="color: #008000;">//</span><span style="color: #008000;">封装数据绑定方法</span>
     <span style="color: #0000ff;">function</span><span style="color: #000000;"> complie(tplStr,tplObj){
        tplStr </span>= tplStr.replace(/\@([a-zA-Z]+)\@/g, <span style="color: #0000ff;">function</span>(match,$1<span style="color: #000000;">){
            </span><span style="color: #0000ff;">return</span> tplObj[$1<span style="color: #000000;">];
        })
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> tplStr;
     }
     </span><span style="color: #008000;">//</span><span style="color: #008000;">调用数据绑定函数</span>
     str =<span style="color: #000000;"> complie(str, obj)
     console.log(str)
</span>&lt;/script&gt;</pre>
</div>
<span class="cnblogs_code_collapse">数据绑定</span></div>
<p>&nbsp;</p>
<p>&nbsp;<span style="font-family: 宋体;">使用</span>Ajax</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('cafaf69c-6de5-44c7-86e9-27a1c332561c')"><img id="code_img_closed_cafaf69c-6de5-44c7-86e9-27a1c332561c" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_cafaf69c-6de5-44c7-86e9-27a1c332561c" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('cafaf69c-6de5-44c7-86e9-27a1c332561c',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_cafaf69c-6de5-44c7-86e9-27a1c332561c" class="cnblogs_code_hide">
<pre><code>&lt;body&gt;
    &lt;table id="table"&gt;
        &lt;tr&gt;
            &lt;td&gt;学号&lt;/td&gt;
            &lt;td&gt;姓名&lt;/td&gt;
            &lt;td&gt;年龄&lt;/td&gt;
            &lt;td&gt;性别&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;!-- 我们使用一个故意写错的type的标签存放模板 --&gt;
&lt;script type="text/template" id="template"&gt;
    &lt;tr class="@leiming@"&gt;
        &lt;td&gt;@id@&lt;/td&gt;
        &lt;td&gt;@name@&lt;/td&gt;
        &lt;td&gt;@age@&lt;/td&gt;
        &lt;td&gt;@sex@&lt;/td&gt;
    &lt;/tr&gt;
&lt;/script&gt;
&lt;script type="text/javascript" src="js/jquery-3.2.1.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
     <span style="color: #008000;">//</span><span style="color: #008000;">通过模板字符串生成一个数据绑定函数</span>
     <span style="color: #0000ff;">var</span> str = $("#template"<span style="color: #000000;">).html();
     </span><span style="color: #008000;">//</span><span style="color: #008000;">Ajax读取数据</span>
     $.get("data/student.json", <span style="color: #0000ff;">function</span><span style="color: #000000;">(data){
        data.result.forEach(</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(item){
            </span><span style="color: #0000ff;">var</span> domStr =<span style="color: #000000;"> complie(str, item);
            $(</span>"#table"<span style="color: #000000;">).append(domStr)
        })
     })

     </span><span style="color: #008000;">//</span><span style="color: #008000;">封装数据绑定方法</span>
     <span style="color: #0000ff;">function</span><span style="color: #000000;"> complie(tplStr,tplObj){
        tplStr </span>= tplStr.replace(/\@([a-zA-Z]+)\@/g, <span style="color: #0000ff;">function</span>(match,$1<span style="color: #000000;">){
            </span><span style="color: #0000ff;">return</span> tplObj[$1<span style="color: #000000;">];
        })
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> tplStr;
     }
</span>&lt;/script&gt;</pre>
</div>
<span class="cnblogs_code_collapse">使用ajax</span></div>
<p>&nbsp;</p>
<hr />
<h1><strong><span style="font-family: 宋体;">四、</span>EChart.js<span style="font-family: 宋体;">（前端数据可视化）</span></strong></h1>
<p>官网：<a href="http://echarts.baidu.com"><span style="text-decoration: underline;">http://echarts.baidu.com</span></a></p>
<p>API<span style="font-family: 宋体;">配置项：</span><a href="http://echarts.baidu.com/option.html#title"><span style="text-decoration: underline;">http://echarts.baidu.com/option.html#title</span></a></p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">第一步：引入JS文件：
</span>&lt;script type="text/javascript" src="js/echarts.min.js"&gt;&lt;/script&gt;
<span style="color: #000000;">
第二步：准备一个放图表的容器
</span>&lt;div id="main" style="width:600px;height:400px;"&gt;&lt;/div&gt;</pre>
</div>
<p>第三步：设置参数，初始化图表</p>
<p><span style="font-family: 宋体;">注意：这里案例是最基础，但在使用</span>echarts<span style="font-family: 宋体;">时一定要配置</span><span style="font-family: Consolas;">xAxis,yAxis,series</span><span style="font-family: 宋体;">这三个参数。如果不想设置也要初始化，将它设置为空</span><span style="font-family: Consolas;">JSON</span><span style="font-family: 宋体;">即可，要不然会报错。同时要保证在</span><span style="font-family: Consolas;">echarts.init</span><span style="font-family: 宋体;">之前的对象是有宽高的，要不然也会报错。</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;"> 基于准备好的dom，初始化echarts实例</span>
<span style="color: #0000ff;">var</span> myChart = echarts.init(document.getElementById('main'<span style="color: #000000;">));
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 指定图表的配置项和数据</span>
<span style="color: #0000ff;">var</span> option =<span style="color: #000000;"> {
    title: {
        text: </span>'数据统计'<span style="color: #000000;">
    },
    tooltip: {}, </span><span style="color: #008000;">//</span><span style="color: #008000;">悬浮提示</span>
<span style="color: #000000;">    legend: {
        data:[</span>'访问量'<span style="color: #000000;">]
    },
    xAxis: {
        data: [</span>"Android","IOS","PC","Ohter"<span style="color: #000000;">]
    },
    yAxis: {},
    series: [{
        name: </span>'访问量',  <span style="color: #008000;">//</span><span style="color: #008000;">nam == legend.data的时候才能显示图例</span>
        <span style="color: #ff0000;">type: 'bar',  //这里可以改成line或pie</span>
        data: [500, 200, 360, 100<span style="color: #000000;">]
    }]
};
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 使用刚指定的配置项和数据显示图表。</span>
myChart.setOption(option);</pre>
</div>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发10.png" alt="" /></p>
<p>简单的统计图表就出来了，官网使用的是柱状图，可以改成其他形状</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">基于准备好的dom，初始化echarts实例</span>
<span style="color: #0000ff;">var</span> myChart = echarts.init(document.getElementById('main'<span style="color: #000000;">));
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 指定图表的配置项和数据</span>
<span style="color: #0000ff;">var</span> option =<span style="color: #000000;"> {
   title: {
       text: </span>'ECharts数据统计'<span style="color: #000000;">
   },
   tooltip: {}, </span><span style="color: #008000;">//</span><span style="color: #008000;">悬浮提示</span>
<span style="color: #000000;">   legend: {
       data:[</span>'占有率'<span style="color: #000000;">]
   },
   xAxis: {
       data: [</span>"Android","IOS","PC","Other"<span style="color: #000000;">]
   },
   yAxis: {},
   series: [{
       name: </span>'占有率', <span style="color: #008000;">//</span><span style="color: #008000;">name==legend.data相等的时候才能显示图例</span>
       <span style="color: #ff0000;">type: 'line'</span><span style="color: #000000;"><span style="color: #ff0000;">,</span>
       data: [</span>50, 120, 36, 100<span style="color: #000000;">]
   }]
};
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 使用刚指定的配置项和数据显示图表。</span>
myChart.setOption(option);</pre>
</div>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发11.png" alt="" /></p>
<p><span style="font-family: 宋体;">饼状图和折线图、柱状图有一点区别，主要是在参数和数据绑定上。饼状图没有</span>X<span style="font-family: 宋体;">和</span><span style="font-family: Consolas;">Y</span><span style="font-family: 宋体;">轴坐标，数据绑定也是采用</span><span style="font-family: Consolas;">value</span><span style="font-family: 宋体;">和</span><span style="font-family: Consolas;">name</span><span style="font-family: 宋体;">对应的形式。</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e2c53e31-e5e2-4cf2-a140-3977bacb776a')"><img id="code_img_closed_e2c53e31-e5e2-4cf2-a140-3977bacb776a" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_e2c53e31-e5e2-4cf2-a140-3977bacb776a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e2c53e31-e5e2-4cf2-a140-3977bacb776a',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_e2c53e31-e5e2-4cf2-a140-3977bacb776a" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">var</span> option =<span style="color: #000000;"> {
    title:{
        text:</span>'周销量统计'<span style="color: #000000;">,
    subtext:</span>'虚拟数据'<span style="color: #000000;">
    },
tooltip:{
    formatter:</span>'系列名：{a}&lt;br /&gt;类目：{b}&lt;br /&gt;数值：{c}'<span style="color: #000000;">
},
    legend:{
        data:[</span>'购买金额','销售金额'<span style="color: #000000;">]
    },
    xAxis:{
        data:[</span>"周一","周二","周三","周四","周五","周六","周日"<span style="color: #000000;">]
    },
    yAxis:{},
    series:[{
        name:</span>'购买金额'<span style="color: #000000;">,
        type:</span>'bar'<span style="color: #000000;">,
        data:[</span>200,312,431,241,175,275,369<span style="color: #000000;">],
        markPoint: {
            data: [
                {type: </span>'max', name: '最大值'<span style="color: #000000;">},
                {type: </span>'min', name: '最小值'<span style="color: #000000;">}
            ]
        },
        markLine:{
            data:[
                {type:</span>'average',name:'平均值'<span style="color: #000000;">,itemStyle:{
                    normal:{color:</span>'green'<span style="color: #000000;">}
                }}
            ]
        }
    },{
        name:</span>'销售金额'<span style="color: #000000;">,
        type:</span>'line'<span style="color: #000000;">,
        data:[</span>321,432,543,376,286,298,400<span style="color: #000000;">],
        markPoint: {
            data: [
                {type: </span>'max', name: '最大值'<span style="color: #000000;">},
                {type: </span>'min', name: '最小值'<span style="color: #000000;">}
            ]
        },
        markLine:{
            data:[
                {type:</span>'average',name:'平均值'<span style="color: #000000;">,itemStyle:{
                    normal:{color:</span>'blue'<span style="color: #000000;">}
                }}
            ]
        }
    }]
};</span></pre>
</div>
<span class="cnblogs_code_collapse">演示代码</span></div>
<p>&nbsp;</p>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发14.png" alt="" /></p>
<hr />
<h1>五、<strong>JS<span style="font-family: 宋体;">设计模式</span></strong></h1>
<p><span style="font-family: 宋体;">到目前为止，我们每个案例都是一个构造函数：</span>Ballon<span style="font-family: 宋体;">类、</span><span style="font-family: Consolas;">Girl</span><span style="font-family: 宋体;">类等等，单打独斗。此时要学习多个类之间一起配合工作，最重要的就是信息的传递（就是类和类之间的数据的传递）。</span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong>什么是设计模式？</strong></span></p>
<p><span style="font-family: 宋体;">在大的项目中，一定有很多个类一起协作完成一个事，工程师们经过多年的经验，写了很多类和类之间的配合和协调工作的一些套路，这些套路我们叫</span>&ldquo;设计模式&rdquo;。</p>
<p><span style="font-family: 宋体;">设计模式的定义就是在面向对象的开发、设计过程中，针对特定的问题的简洁而又优雅的解决方案，通俗的就是说给程序的思想起了一个名字</span> &ldquo;设计模式&rdquo;。</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong><span style="font-family: 宋体;">设计模式一共</span>23<span style="font-family: 宋体;">种：</span></strong></span></p>
<p><span style="font-family: 宋体;">图所示</span>23<span style="font-family: 宋体;">种设计模式，实际上被分为了三个大种类。现在要学习的两种设计模式，是最著名的设计模式。</span></p>
<p><img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发15.png" alt="" /></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">比如现在有两个类：老师类和学生类，老师类有留作业方法（</span>liuzuoye<span style="font-family: 宋体;">），要求调用这个方法后，每个学生都拥有</span><span style="font-family: Consolas;">zuoye</span><span style="font-family: 宋体;">这个属性，初学者往往写出这样的代码：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">老师类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Teacher(){
}
Teacher.prototype.liuzuoye </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(content){
   alert(</span>"老师留了作业：" +<span style="color: #000000;"> content);
   xiaoming.zuoye </span>= content; <span style="color: #008000;">//</span><span style="color: #008000;">动用了其他类的实例的名字在此，耦合性高</span>
   xiaohong.zuoye =<span style="color: #000000;"> content;
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">学生类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Student(){
   </span><span style="color: #0000ff;">this</span>.zuoye = ''<span style="color: #000000;">;
}
</span><span style="color: #0000ff;">var</span> zhulaoshi = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Teacher();
</span><span style="color: #0000ff;">var</span> xiaoming = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Student();
</span><span style="color: #0000ff;">var</span> xiaohong = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Student();
zhulaoshi.liuzuoye(</span>"完成贪吃蛇！"<span style="color: #000000;">);
alert(xiaoming.zuoye)
alert(xiaohong.zuoye)</span></pre>
</div>
<p><span style="font-family: 宋体;">而软件设计（尤其是面向对象开发时）讲究的是</span>&ldquo;高内聚、低耦合&rdquo;。耦合性就是类尽量不要用到其他类的实例，如果其他类改名了，你的类就错了。</p>
<p>为了降低耦合性，经过大量实践，总结了很多设计模式，降低耦合性。</p>
<hr />
<p>&nbsp;</p>
<h2><strong>5.1<span style="font-family: 宋体;">观察者模式</span></strong></h2>
<p><strong><span style="text-decoration: underline;"><span style="font-family: 宋体;">观察者模式（</span>observer<span style="font-family: 宋体;">）</span></span></strong>也叫<strong><span style="text-decoration: underline;"><span style="font-family: 宋体;">发布</span>-<span style="font-family: 宋体;">订阅模式（</span><span style="font-family: Consolas;">publish-subscribe</span><span style="font-family: 宋体;">）</span></span></strong>。它定义了对象间的一种<span style="color: #ff0000;"><strong>1<span style="font-family: 宋体;">对</span><span style="font-family: Consolas;">n</span></strong></span><span style="font-family: 宋体;">的依赖关系。当一个对象的状态发生改变时，所有</span>&ldquo;订阅&rdquo;了它的对象都将得到通知。</p>
<p><span style="font-family: 宋体;">刚刚老师发布作业的案例，老师就是发布者（</span>publisher<span style="font-family: 宋体;">），学生就是订阅者、观察者（</span><span style="font-family: Consolas;">subscriber</span><span style="font-family: 宋体;">）。老师是</span><span style="font-family: Consolas;">1</span><span style="font-family: 宋体;">，学生是</span><span style="font-family: Consolas;">n</span><span style="font-family: 宋体;">。</span><span style="color: #ff0000;"><strong><span style="text-decoration: underline;"><span style="font-family: 宋体;">发布者（老师）要维护自己的订阅者（学生）列表，自己有一个属性</span>students<span style="font-family: 宋体;">存放着所有订阅自己的列表（实例数组），当发布作业时，用</span><span style="font-family: Consolas;">for</span><span style="font-family: 宋体;">循环数组清单，分别调用每个订阅者相应的方法即可。</span></span></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong><span style="text-decoration: underline;"><span style="font-family: 宋体;">精髓：发布者维持一个订阅自己的数组，当自己要发布信息的时候，循环遍历自己的数组调用订阅者的方法。</span></span></strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('17673328-740f-42ca-8317-0b9457d0b70e')"><img id="code_img_closed_17673328-740f-42ca-8317-0b9457d0b70e" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_17673328-740f-42ca-8317-0b9457d0b70e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('17673328-740f-42ca-8317-0b9457d0b70e',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_17673328-740f-42ca-8317-0b9457d0b70e" class="cnblogs_code_hide">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">老师类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Teacher(){
   </span><span style="color: #008000;">//</span><span style="color: #008000;">维护自己订阅者的列表</span>
   <span style="color: #0000ff;">this</span>.students =<span style="color: #000000;"> [];
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">提供一个注册（关注订阅）方法</span>
Teacher.prototype.regist = <span style="color: #0000ff;">function</span><span style="color: #000000;">(obj){
   </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.students.push(obj)
}
Teacher.prototype.liuzuoye </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(content){
    alert(</span>"老师留了作业：" +<span style="color: #000000;"> content );
    </span><span style="color: #008000;">//</span><span style="color: #008000;">遍历所有学生，分别调用它们的listen监听作业方法，把信息通过实参传递过去</span>
    <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0;i &lt; <span style="color: #0000ff;">this</span>.students.length;i++<span style="color: #000000;">){
       </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.students[i].listen(content)
    }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">学生类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Student(teacher){
   </span><span style="color: #008000;">//</span><span style="color: #008000;"> 去注册成为指定老师的学生</span>
   teacher.regist(<span style="color: #0000ff;">this</span><span style="color: #000000;">)
}
Student.prototype.listen </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(zuoye){
   </span><span style="color: #0000ff;">this</span>.zuoye =<span style="color: #000000;"> zuoye;
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">实例化</span>
<span style="color: #0000ff;">var</span> zhulaoshi = <span style="color: #0000ff;">new</span> Teacher(); <span style="color: #008000;">//</span><span style="color: #008000;">发布者要先实例化</span>
<span style="color: #0000ff;">var</span> kaola = <span style="color: #0000ff;">new</span> Teacher(); <span style="color: #008000;">//</span><span style="color: #008000;">发布者要先实例化</span>
<span style="color: #0000ff;">var</span> xiaoming = <span style="color: #0000ff;">new</span> Student(zhulaoshi); <span style="color: #008000;">//</span><span style="color: #008000;">注册成为zhulaoshi的学生</span>
<span style="color: #0000ff;">var</span> xiaohong = <span style="color: #0000ff;">new</span> Student(zhulaoshi); <span style="color: #008000;">//</span><span style="color: #008000;">注册成为zhulaoshi的学生</span>
<span style="color: #0000ff;">var</span> xiaogang = <span style="color: #0000ff;">new</span> Student(kaola); <span style="color: #008000;">//</span><span style="color: #008000;">注册成为kaola的学生</span>
<span style="color: #0000ff;">var</span> xiaobai = <span style="color: #0000ff;">new</span> Student(kaola); <span style="color: #008000;">//</span><span style="color: #008000;">注册成为kaola的学生</span><span style="color: #008000;">
//</span><span style="color: #008000;">老师留作业</span>
zhulaoshi.liuzuoye("完成贪吃蛇"<span style="color: #000000;">);
kaola.liuzuoye(</span>"写代码"<span style="color: #000000;">);
alert(xiaoming.zuoye)
alert(xiaohong.zuoye)
alert(xiaogang.zuoye)
alert(xiaobai.zuoye)</span></pre>
</div>
<span class="cnblogs_code_collapse">演示代码</span></div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">设计模式的好处在于程序足够大的时候使用</span><span style="font-family: 宋体;">。</span></p>
<hr />
<p>&nbsp;</p>
<h3><strong>案例：汇率转换小程序</strong></h3>
<p>人民币换美元、欧元、日元、英镑、泰铢</p>
<p>当用户输入人民币的时候，需要实时显示对应的外币的数值。</p>
<p><span style="font-family: 宋体;">人民币类</span>(RMB)<span style="font-family: 宋体;">就是发布者，外币类</span><span style="font-family: Consolas;">waibi</span><span style="font-family: 宋体;">就是订阅者</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('295a0fd3-fcfa-45d8-82d6-bf9eec5f2f9f')"><img id="code_img_closed_295a0fd3-fcfa-45d8-82d6-bf9eec5f2f9f" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_295a0fd3-fcfa-45d8-82d6-bf9eec5f2f9f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('295a0fd3-fcfa-45d8-82d6-bf9eec5f2f9f',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_295a0fd3-fcfa-45d8-82d6-bf9eec5f2f9f" class="cnblogs_code_hide">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">人民币类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> RMB(){
   </span><span style="color: #008000;">//</span><span style="color: #008000;">维护自己订阅者的列表</span>
   <span style="color: #0000ff;">this</span>.listen =<span style="color: #000000;"> [];
   </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.init();
   </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.bindEvent();
}
RMB.prototype.init </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   </span><span style="color: #0000ff;">this</span>.p = document.createElement('p'<span style="color: #000000;">);
   </span><span style="color: #0000ff;">this</span>.p.innerHTML = "人民币："<span style="color: #000000;">;
   </span><span style="color: #0000ff;">this</span>.input = document.createElement('input'<span style="color: #000000;">);
   </span><span style="color: #0000ff;">this</span>.p.appendChild(<span style="color: #0000ff;">this</span><span style="color: #000000;">.input)
   document.body.appendChild(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">.p);
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">提供一个注册（关注订阅）方法，可以将某一个币种添加到自己的数组中</span>
RMB.prototype.regist = <span style="color: #0000ff;">function</span><span style="color: #000000;">(obj){
   </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.listen.push(obj)
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">监听发布者改变时的状态</span>
RMB.prototype.bindEvent = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   </span><span style="color: #008000;">//</span><span style="color: #008000;">告诉用户输入人民币金额时，遍历自己所有的订阅者，调用他们的监听方法，将数值告诉他们</span>
   <span style="color: #008000;">//</span><span style="color: #008000;">&ldquo;告诉&rdquo;是通过调用他们的方法实现，通过实参把数据传递给他们</span>
   <span style="color: #0000ff;">var</span> self = <span style="color: #0000ff;">this</span><span style="color: #000000;">;
   </span><span style="color: #0000ff;">this</span>.input.oninput = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
       </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0;i &lt; self.listen.length;i++<span style="color: #000000;">){
           self.listen[i].listen(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">.value);
       }
   }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">订阅者，外币类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Waibi(name, huilv){
   </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
   </span><span style="color: #0000ff;">this</span>.huilv =<span style="color: #000000;"> huilv;
   </span><span style="color: #008000;">//</span><span style="color: #008000;">观察者模式要求，就是去发布者哪里注册自己</span>
   <span style="color: #008000;">//</span><span style="color: #008000;">订阅人民币类，订阅者就是要订阅发布者</span>
   rmb.regist(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
   </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.init();
}
Waibi.prototype.init </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   </span><span style="color: #0000ff;">this</span>.p = document.createElement('p'<span style="color: #000000;">);
   </span><span style="color: #0000ff;">this</span>.p.innerHTML = <span style="color: #0000ff;">this</span>.name + "："<span style="color: #000000;">;
   </span><span style="color: #0000ff;">this</span>.input = document.createElement('input'<span style="color: #000000;">);
   </span><span style="color: #0000ff;">this</span>.input.disabled = <span style="color: #0000ff;">true</span><span style="color: #000000;">;
   </span><span style="color: #0000ff;">this</span>.p.appendChild(<span style="color: #0000ff;">this</span><span style="color: #000000;">.input)
   document.body.appendChild(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">.p);
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">收听人民币的最新数值，此时改变自己dom中的数据</span><span style="color: #008000;">
//</span><span style="color: #008000;">订阅者有一个listen监听发布者的方法，用来接收响应发布者的最新消息</span>
Waibi.prototype.listen = <span style="color: #0000ff;">function</span><span style="color: #000000;">(content){
   </span><span style="color: #0000ff;">this</span>.input.value = content / <span style="color: #0000ff;">this</span><span style="color: #000000;">.huilv;
}
</span><span style="color: #0000ff;">var</span> rmb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RMB();
</span><span style="color: #0000ff;">new</span> Waibi("美元", 6.8894<span style="color: #000000;">);
</span><span style="color: #0000ff;">new</span> Waibi("韩元", 0.0061<span style="color: #000000;">);
</span><span style="color: #0000ff;">new</span> Waibi("港币", 0.8799<span style="color: #000000;">);
</span><span style="color: #0000ff;">new</span> Waibi("英镑", 8.9542<span style="color: #000000;">);
</span><span style="color: #0000ff;">new</span> Waibi("日元", 0.0609);</pre>
</div>
<span class="cnblogs_code_collapse">汇率转换小程序</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<h2><strong>5.2<span style="font-family: 宋体;">中介者模式</span></strong></h2>
<p><span style="font-family: 宋体;">观察者模式的精髓在于</span>&ldquo;主动通知&rdquo;，当老师的状态改变的时候，能够实时通知学生，通过调用学生的方法来实现的。中介者模式简单一点，不能主动通知。</p>
<p><span style="font-family: 宋体;">老师要发布作业，此时发布到</span>QQ<span style="font-family: 宋体;">群里；学生看作业去</span><span style="font-family: Consolas;">QQ</span><span style="font-family: 宋体;">群看就行了！</span><span style="font-family: Consolas;">QQ</span><span style="font-family: 宋体;">群就是中介者，相当于全局变量。</span></p>
<p>&nbsp;<img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发20.png" alt="" /></p>
<p><span style="font-family: 宋体;">后面制作一些复杂的</span>DOM<span style="font-family: 宋体;">程序，中介者模式是使用最多的。</span><span style="font-family: Consolas;">99%</span><span style="font-family: 宋体;">的</span><span style="font-family: Consolas;">DOM</span><span style="font-family: 宋体;">效果都是中介者模式来制作的。</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">********中介者QQ群类*********</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> QQQun(){
   </span><span style="color: #0000ff;">this</span>.zuoye = ''<span style="color: #000000;">;
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">老师类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Teacher(){
}
Teacher.prototype.liuzuoye </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(content){
   qqqun.zuoye </span>= content; <span style="color: #008000;">//</span><span style="color: #008000;">发布作业到qq群</span>
<span style="color: #000000;">}
</span><span style="color: #008000;">//</span><span style="color: #008000;">学生类</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> Student(){
}
Student.prototype.xiezuoye </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   alert(</span>"我要写作业啦！"+<span style="color: #000000;"> qqqun.zuoye)
}
</span><span style="color: #0000ff;">var</span> qqqun = <span style="color: #0000ff;">new</span> QQQun(); <span style="color: #008000;">//</span><span style="color: #008000;">先实例化中介者</span><span style="color: #008000;">
//</span><span style="color: #008000;">实例化老师</span>
<span style="color: #0000ff;">var</span> zhulaoshi = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Teacher();
zhulaoshi.liuzuoye(</span>"完成贪吃蛇！"<span style="color: #000000;">);
</span><span style="color: #008000;">//</span><span style="color: #008000;">实例化学生</span>
<span style="color: #0000ff;">var</span> xiaoming = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Student();
</span><span style="color: #0000ff;">var</span> xiaohong = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Student();
xiaoming.xiezuoye()
xiaohong.xiezuoye()</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">两个模式的区别：
观察者模式能主动推送消息，每个收听者能够实时得到发布者的信息；
中介者模式不主动推送消息，当学生要写作业，需要作业信息时，主动去找中介者拿，适合时效性不强的信息。</span></pre>
</div>
<hr />
<h1>六、<strong><span style="font-family: 宋体;">贪吃蛇游戏</span>-<span style="font-family: 宋体;">中介者模式</span></strong></h1>
<p><span style="font-family: 宋体;">有的时候，项目中的类很多，没有所谓的</span>1:n<span style="font-family: 宋体;">（</span><span style="font-family: Consolas;">1</span><span style="font-family: 宋体;">对</span><span style="font-family: Consolas;">n</span><span style="font-family: 宋体;">）的关系，</span><span style="color: #ff0000;"><strong><span style="font-family: 宋体;">它们感觉</span>&ldquo;互为信息源&rdquo;，此时中介者模式是最简单的。比如蛇需要食物，食物也要蛇的信息。</strong></span></p>
<p><strong>&nbsp;</strong></p>
<p><strong>用贪吃蛇来举例：</strong></p>
<p><strong><span style="font-family: 宋体;">游戏有三个类：游戏类（</span>Game<span style="font-family: 宋体;">）、蛇类（</span><span style="font-family: Consolas;">Snake</span><span style="font-family: 宋体;">）、食物类（</span><span style="font-family: Consolas;">Food</span><span style="font-family: 宋体;">）</span></strong></p>
<p><span style="color: #ff0000;"><strong><span style="font-family: 宋体;">游戏类其实就是中介者，蛇和食物都需要通过</span>Game<span style="font-family: 宋体;">来交换获取信息。</span></strong></span></p>
<p><strong>&nbsp;</strong></p>
<p><span style="color: #ff0000;"><strong>Game<span style="font-family: 宋体;">类是中介者类，</span><span style="font-family: Consolas;">Snake</span><span style="font-family: 宋体;">、</span><span style="font-family: Consolas;">Food</span><span style="font-family: 宋体;">类是普通类，被</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">管理。</span></strong></span></p>
<p><strong>注意：</strong></p>
<p>l&nbsp;<strong>中介者必须有唯一的实例化对象，这个对象的名字不能更改，比如群号码不能更改。在贪吃蛇游戏中，我们就要：</strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> game = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Game();
此时game变量名一旦确定就不要改了。</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">除了中介者之外，其他所有的对象，都需要由中介者来实例化，在贪吃蛇游戏中，</span>Snake<span style="font-family: 宋体;">蛇、</span><span style="font-family: Consolas;">Food</span><span style="font-family: 宋体;">食物类由</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">类来实例化，它们都是</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">类的子属性。</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">function</span><span style="color: #000000;"> Game(){
</span><span style="color: #0000ff;">this</span>.snake = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Snake();
</span><span style="color: #0000ff;">this</span>.food = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Food();
}</span></pre>
</div>
<p>&nbsp;</p>
<p>Food<span style="font-family: 宋体;">、</span><span style="font-family: Consolas;">Snake</span><span style="font-family: 宋体;">之间如果互相要用信息，比如蛇要知道食物的位置，用中介者：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">function</span><span style="color: #000000;"> Snake(){
console.log(game.food.x)
}</span></pre>
</div>
<hr />
<p><span style="font-family: 宋体;">这是我们第一次将一个类单独写在</span>js<span style="font-family: 宋体;">中，每个</span><span style="font-family: Consolas;">js</span><span style="font-family: 宋体;">文件就是一个类</span></p>
<p><span style="font-family: 宋体;">第一步：创建</span>index<span style="font-family: 宋体;">文件，创建</span><span style="font-family: Consolas;">Game.js</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e1afd2aa-8039-4690-9c49-e9f0f38362b4')"><img id="code_img_closed_e1afd2aa-8039-4690-9c49-e9f0f38362b4" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_e1afd2aa-8039-4690-9c49-e9f0f38362b4" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e1afd2aa-8039-4690-9c49-e9f0f38362b4',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_e1afd2aa-8039-4690-9c49-e9f0f38362b4" class="cnblogs_code_hide">
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;title&gt;贪吃蛇&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="app"&gt;

    &lt;/div&gt;
&lt;/body&gt;
&lt;script type="text/javascript" src="js/Game.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/Food.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/Snake.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
     <span style="color: #0000ff;">var</span> game = <span style="color: #0000ff;">new</span> Game(); <span style="color: #008000;">//</span><span style="color: #008000;">唯一的中介者</span>
&lt;/script&gt;
&lt;/html&gt;</pre>
</div>
<span class="cnblogs_code_collapse">第一步</span></div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">第二步：创建表格，在游戏中，表格是</span>Game<span style="font-family: 宋体;">类的</span><span style="font-family: Consolas;">DOM</span><span style="font-family: 宋体;">属性，写</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">类的</span><span style="font-family: Consolas;">init</span><span style="font-family: 宋体;">方法，创建行和列的个数属性。</span></p>
<p><span style="color: #ff0000;"><strong><span style="font-family: 宋体;">注意：所有的代码都写在闭包中，利用</span>window<span style="font-family: 宋体;">对象暴露唯一的</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">游戏类即可。</span></strong></span></p>
<div class="cnblogs_code">
<pre><code>(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    <span style="color: #ff0000;">window.Game </span></span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        console.log(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">)
    }
})();</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('aac718a2-1c67-491e-bfc6-ebfa502acaca')"><img id="code_img_closed_aac718a2-1c67-491e-bfc6-ebfa502acaca" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_aac718a2-1c67-491e-bfc6-ebfa502acaca" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('aac718a2-1c67-491e-bfc6-ebfa502acaca',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_aac718a2-1c67-491e-bfc6-ebfa502acaca" class="cnblogs_code_hide">
<pre><code>(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 注意：所有的代码都写在闭包中，利用window对象暴露唯一的Game游戏类即可。</span>
    window.Game = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        </span><span style="color: #0000ff;">this</span>.rowAmount = 16; <span style="color: #008000;">//</span><span style="color: #008000;">行数</span>
        <span style="color: #0000ff;">this</span>.colAmount = 20; <span style="color: #008000;">//</span><span style="color: #008000;">列数</span>
        <span style="color: #0000ff;">this</span>.init(); <span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
<span style="color: #000000;">    }

    </span><span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
    Game.prototype.init = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        </span><span style="color: #0000ff;">this</span>.dom = document.createElement('table'<span style="color: #000000;">);
        document.getElementById(</span>"app").appendChild(<span style="color: #0000ff;">this</span><span style="color: #000000;">.dom);
        </span><span style="color: #0000ff;">var</span><span style="color: #000000;"> tr,td;
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0; i &lt; <span style="color: #0000ff;">this</span>.rowAmount;i++<span style="color: #000000;">){
            tr </span>= document.createElement('tr'); <span style="color: #008000;">//</span><span style="color: #008000;">遍历插入行</span>
            <span style="color: #0000ff;">this</span>.dom.appendChild(tr); <span style="color: #008000;">//</span><span style="color: #008000;">tr上树</span>
            <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> j = 0; j &lt; <span style="color: #0000ff;">this</span>.colAmount;j++<span style="color: #000000;">){
                td </span>= document.createElement('td');<span style="color: #008000;">//</span><span style="color: #008000;">遍历插入列</span>
                tr.appendChild(td); <span style="color: #008000;">//</span><span style="color: #008000;">td上树</span>
<span style="color: #000000;">            }
        }
    }
})();</span></pre>
</div>
<span class="cnblogs_code_collapse">第二步</span></div>
<p>&nbsp;</p>
<p><strong><span style="font-family: 宋体;">第三步：创建蛇类，创建</span>Snake.js<span style="font-family: 宋体;">文件（每一个类都是单独一个</span><span style="font-family: Consolas;">js</span><span style="font-family: 宋体;">文件）</span></strong></p>
<p><span style="font-family: 宋体;">蛇类有自己的身体属性，有</span>render<span style="font-family: 宋体;">渲染方法。</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('fed3c4f6-26fe-4091-bb5a-10fc01d8419b')"><img id="code_img_closed_fed3c4f6-26fe-4091-bb5a-10fc01d8419b" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_fed3c4f6-26fe-4091-bb5a-10fc01d8419b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('fed3c4f6-26fe-4091-bb5a-10fc01d8419b',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_fed3c4f6-26fe-4091-bb5a-10fc01d8419b" class="cnblogs_code_hide">
<pre><code>(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    window.Snake </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        </span><span style="color: #008000;">//</span><span style="color: #008000;">蛇的身体</span>
        <span style="color: #0000ff;">this</span>.body =<span style="color: #000000;"> [
            {</span>"row" : 4, "col":7<span style="color: #000000;">},
            {</span>"row" : 4, "col":6<span style="color: #000000;">},
            {</span>"row" : 4, "col":5<span style="color: #000000;">},
            {</span>"row" : 4, "col":4<span style="color: #000000;">},
            {</span>"row" : 4, "col":3<span style="color: #000000;">}
        ];
    }
    </span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇的身体方法</span>
    Snake.prototype.render = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0;i &lt; <span style="color: #0000ff;">this</span>.body.length; i++<span style="color: #000000;">){
            </span><span style="color: #008000;">//</span><span style="color: #008000;">这里写违反了高内聚低耦合的原则，改一改东西的属性应该要调用人家提供的方法</span>
       <span style="color: #008000;">//</span><span style="color: #008000;">game.dom.getElementsByTagName('tr')[this.body[i].row].getElementsByTagName('td')[this.body[i].col].style.background = 'red';</span>
            game.setColor(<span style="color: #0000ff;">this</span>.body[i].row,<span style="color: #0000ff;">this</span>.body[i].col,'red'<span style="color: #000000;">);
        }
    }
})();</span></pre>
</div>
<span class="cnblogs_code_collapse">第三步</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;<span style="font-family: 宋体;">在</span>Game<span style="font-family: 宋体;">类实例化蛇类，同时提供一个</span><span style="font-family: Consolas;">setColor</span><span style="font-family: 宋体;">方法：</span></p>
<div class="cnblogs_code">
<pre><code>(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 注意：所有的代码都写在闭包中，利用window对象暴露唯一的Game游戏类即可。</span>
    window.Game = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        </span><span style="color: #0000ff;">this</span>.rowAmount = 16; <span style="color: #008000;">//</span><span style="color: #008000;">行数</span>
        <span style="color: #0000ff;">this</span>.colAmount = 20; <span style="color: #008000;">//</span><span style="color: #008000;">列数</span>
        <span style="color: #0000ff;">this</span>.init(); <span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
        <span style="color: #008000;">//</span><span style="color: #008000;">实例化蛇类</span>
        <span style="color: #ff0000;">this.snake = new Snake();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇方法</span>
        <span style="color: #ff0000;">this</span><span style="color: #000000;"><span style="color: #ff0000;">.snake.render();</span>
    }

    </span><span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
    Game.prototype.init = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
      ...
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">设置蛇身的颜色</span>
    Game.prototype.setColor = <span style="color: #0000ff;">function</span><span style="color: #000000;">(row,col,color){
        </span><span style="color: #0000ff;">this</span>.dom.getElementsByTagName('tr')[row].getElementsByTagName('td'<span style="color: #000000;">)[col]
.style.background </span>=<span style="color: #000000;"> color;
    }
})();</span></pre>
</div>
<p>此时会发现报错了：</p>
<p>&nbsp;<img src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发27.png" alt="" /></p>
<p>原因是在Game<span style="font-family: 宋体;">类的构造函数中，使用</span><span style="font-family: Consolas;">game</span><span style="font-family: 宋体;">这个实例的名字，此时是</span><span style="font-family: Consolas;">undefined</span><span style="font-family: 宋体;">，因为构造函数还没执行完毕，还没执行完四步走。</span></p>
<p>&nbsp;</p>
<p><strong>解决方法两种：</strong></p>
<p><span style="font-family: 宋体;">方法</span>1<span style="font-family: 宋体;">：在</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">类中</span><span style="font-family: Consolas;">new Snake(this)</span><span style="font-family: 宋体;">传入上下文，</span><span style="font-family: Consolas;">this</span><span style="font-family: 宋体;">表示即将返回的</span><span style="font-family: Consolas;">Game</span><span style="font-family: 宋体;">对象。</span></p>
<div class="cnblogs_code">
<pre><code>window.Game = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.rowAmount = 16; <span style="color: #008000;">//</span><span style="color: #008000;">行数</span>
    <span style="color: #0000ff;">this</span>.colAmount = 20; <span style="color: #008000;">//</span><span style="color: #008000;">列数</span>
    <span style="color: #0000ff;">this</span>.init(); <span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
    <span style="color: #008000;">//</span><span style="color: #008000;">实例化蛇类</span>
    <span style="color: #0000ff;">this</span>.snake =<span style="color: #ff0000;"> new Snake(this</span><span style="color: #000000;"><span style="color: #ff0000;">)</span>;
    </span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇方法</span>
    <span style="color: #0000ff;">this</span><span style="color: #000000;">.snake.render();
}</span></pre>
</div>
<p>&nbsp;</p>
<p>Snake<span style="font-family: 宋体;">类中接收</span><span style="font-family: Consolas;">this</span></p>
<div class="cnblogs_code">
<pre><code>window.Snake = <span style="color: #0000ff;">function</span><span style="color: #000000;">(<span style="color: #ff0000;">mediator</span>){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">接收Game类当做子属性（中介者）</span><span style="color: #ff0000;">
    this.mediator = mediator;
    </span><span style="color: #008000;">//</span><span style="color: #008000;">蛇的身体,可以让蛇运动起来，头增尾删</span>
    <span style="color: #0000ff;">this</span>.body =<span style="color: #000000;"> [
        {</span>"row" : 3, "col":8<span style="color: #000000;">},
        {</span>"row" : 3, "col":7<span style="color: #000000;">},
        {</span>"row" : 3, "col":6<span style="color: #000000;">},
        {</span>"row" : 3, "col":5<span style="color: #000000;">},
        {</span>"row" : 3, "col":4<span style="color: #000000;">}
    ];
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇的身体方法</span>
Snake.prototype.render = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.mediator.setColor(<span style="color: #0000ff;">this</span>.body[0].row,<span style="color: #0000ff;">this</span>.body[0].col,'green'<span style="color: #000000;">);
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 1;i &lt; <span style="color: #0000ff;">this</span>.body.length; i++<span style="color: #000000;">){
        </span><span style="color: #ff0000;">this.mediator</span>.setColor(<span style="color: #0000ff;">this</span>.body[i].row,<span style="color: #0000ff;">this</span>.body[i].col,'red'<span style="color: #000000;">);
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="font-family: 宋体;">方法</span>2<span style="font-family: 宋体;">：利用定时器解决</span></strong></p>
<p><span style="font-family: 宋体;">定时器</span>20<span style="font-family: 宋体;">毫秒一帧，第一帧就发生在</span><span style="font-family: Consolas;">20</span><span style="font-family: 宋体;">毫秒之后，此时构造函数已经执行完毕，</span><span style="font-family: Consolas;">game</span><span style="font-family: 宋体;">对象就已经返回。</span></p>
<p>创建定时器，在定时器中，渲染蛇。同时加上清屏的语句，在每一帧都是清屏，重新绘制蛇。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('a7385e1b-1f64-4ff2-bea8-4875ee814481')"><img id="code_img_closed_a7385e1b-1f64-4ff2-bea8-4875ee814481" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_a7385e1b-1f64-4ff2-bea8-4875ee814481" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a7385e1b-1f64-4ff2-bea8-4875ee814481',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_a7385e1b-1f64-4ff2-bea8-4875ee814481" class="cnblogs_code_hide">
<pre><code>window.Game = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.rowAmount = 16; <span style="color: #008000;">//</span><span style="color: #008000;">行数</span>
    <span style="color: #0000ff;">this</span>.colAmount = 20; <span style="color: #008000;">//</span><span style="color: #008000;">列数</span>
    <span style="color: #0000ff;">this</span>.init(); <span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
    <span style="color: #008000;">//</span><span style="color: #008000;">实例化蛇类</span>
    <span style="color: #0000ff;">this</span>.snake = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Snake();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">开启游戏定时器</span>
    <span style="color: #0000ff;">this</span><span style="color: #000000;">.start();
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">初始化UI界面，创建DOM表格</span>
Game.prototype.init = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.dom = document.createElement('table'<span style="color: #000000;">);
    document.getElementById(</span>"app").appendChild(<span style="color: #0000ff;">this</span><span style="color: #000000;">.dom);
    </span><span style="color: #0000ff;">var</span><span style="color: #000000;"> tr,td;
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0; i &lt; <span style="color: #0000ff;">this</span>.rowAmount;i++<span style="color: #000000;">){
        tr </span>= document.createElement('tr'); <span style="color: #008000;">//</span><span style="color: #008000;">遍历插入行</span>
        <span style="color: #0000ff;">this</span>.dom.appendChild(tr); <span style="color: #008000;">//</span><span style="color: #008000;">tr上树</span>
        <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> j = 0; j &lt; <span style="color: #0000ff;">this</span>.colAmount;j++<span style="color: #000000;">){
            td </span>= document.createElement('td');<span style="color: #008000;">//</span><span style="color: #008000;">遍历插入列</span>
            tr.appendChild(td); <span style="color: #008000;">//</span><span style="color: #008000;">td上树</span>
<span style="color: #000000;">        }
    }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">设置蛇身的颜色</span>
Game.prototype.setColor = <span style="color: #0000ff;">function</span><span style="color: #000000;">(row,col,color){
    </span><span style="color: #0000ff;">this</span>.dom.getElementsByTagName('tr')[row].getElementsByTagName('td')[col].style.background =<span style="color: #000000;"> color;
}
</span><span style="color: #008000;">//</span><span style="color: #008000;">清屏，遍历行和列，设为白色</span>
Game.prototype.clear = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0;i &lt; <span style="color: #0000ff;">this</span>.rowAmount; i++<span style="color: #000000;">){
        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> j = 0; j &lt; <span style="color: #0000ff;">this</span>.colAmount; j++<span style="color: #000000;">) {
            </span><span style="color: #0000ff;">this</span>.dom.getElementsByTagName('tr')[i].getElementsByTagName('td')[j].style.background = "#fff"<span style="color: #000000;">;
        };
    }
}
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 游戏开始方法</span>
Game.prototype.start = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">var</span> self = <span style="color: #0000ff;">this</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">this</span>.f = 0; <span style="color: #008000;">//</span><span style="color: #008000;">帧编号</span>
    setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        self.f</span>++<span style="color: #000000;">;
        document.getElementById(</span>"info").innerHTML = "帧编号：" +<span style="color: #000000;"> self.f;
        </span><span style="color: #008000;">//</span><span style="color: #008000;">清屏</span>
<span style="color: #000000;">        self.clear();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">每隔30帧更新一下</span>
        self.f % 30 == 0 &amp;&amp;<span style="color: #000000;"> self.snake.update();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇方法</span>
<span style="color: #000000;">        self.snake.render();
    },</span>20<span style="color: #000000;">);
}</span></pre>
</div>
<span class="cnblogs_code_collapse">定时器解决</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">第五步：让蛇动起来，套路是，每一帧都清屏，然后更新蛇、渲染蛇</span>...</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">this</span>.body =<span style="color: #000000;"> [
    {</span>"row" : 4, "col" : 7<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 6<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 5<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 4<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 3<span style="color: #000000;">}
];</span></pre>
</div>
<p>变为：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">this</span>.body =<span style="color: #000000;"> [
{</span>"row" : 4, "col" : 8<span style="color: #000000;">}
    {</span>"row" : 4, "col" : 7<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 6<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 5<span style="color: #000000;">},
    {</span>"row" : 4, "col" : 4<span style="color: #000000;">},
];</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">在</span>Snake<span style="font-family: 宋体;">控制方向：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">更新方法，这个方法最关键</span>
Snake.prototype.update = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.body.pop(); <span style="color: #008000;">//</span><span style="color: #008000;">尾删</span>
    <span style="color: #0000ff;">this</span>.body.unshift({"row":<span style="color: #0000ff;">this</span>.body[0].row, "col":<span style="color: #0000ff;">this</span>.body[0].col+1});<span style="color: #008000;">//</span><span style="color: #008000;">头插</span>
}</pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('a55edf5d-95e3-4f95-8b2f-fb95c2806146')"><img id="code_img_closed_a55edf5d-95e3-4f95-8b2f-fb95c2806146" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_a55edf5d-95e3-4f95-8b2f-fb95c2806146" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a55edf5d-95e3-4f95-8b2f-fb95c2806146',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_a55edf5d-95e3-4f95-8b2f-fb95c2806146" class="cnblogs_code_hide">
<pre><code>Snake.prototype.update = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.body.pop(); <span style="color: #008000;">//</span><span style="color: #008000;">尾删</span>
    <span style="color: #008000;">//</span><span style="color: #008000;">根据方向头插</span>
    <span style="color: #0000ff;">switch</span>(<span style="color: #0000ff;">this</span><span style="color: #000000;">.direction){
        </span><span style="color: #0000ff;">case</span> "R"<span style="color: #000000;">:
            </span><span style="color: #0000ff;">var</span> toucha = {"row": <span style="color: #0000ff;">this</span>.body[0].row, "col" : <span style="color: #0000ff;">this</span>.body[0].col + 1<span style="color: #000000;">};
            </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.body.unshift(toucha);
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">case</span> "L"<span style="color: #000000;">:
            </span><span style="color: #0000ff;">var</span> toucha = {"row": <span style="color: #0000ff;">this</span>.body[0].row, "col" : <span style="color: #0000ff;">this</span>.body[0].col - 1<span style="color: #000000;">};
            </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.body.unshift(toucha);
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">case</span> "U"<span style="color: #000000;">:
            </span><span style="color: #0000ff;">var</span> toucha = {"row": <span style="color: #0000ff;">this</span>.body[0].row - 1, "col" : <span style="color: #0000ff;">this</span>.body[0<span style="color: #000000;">].col};
            </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.body.unshift(toucha);
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">case</span> "D"<span style="color: #000000;">:
            </span><span style="color: #0000ff;">var</span> toucha = {"row": <span style="color: #0000ff;">this</span>.body[0].row + 1, "col" : <span style="color: #0000ff;">this</span>.body[0<span style="color: #000000;">].col};
            </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.body.unshift(toucha);
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">控制方向</span></div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>Snake.prototype.changeDireciton = <span style="color: #0000ff;">function</span><span style="color: #000000;">(str){
    </span><span style="color: #0000ff;">this</span>.direction =<span style="color: #000000;"> str;
}</span></pre>
</div>
<p>&nbsp;</p>
<p class="15">//<span style="font-family: 宋体;">绑定键盘监听，调用</span><span style="font-family: Consolas;">changeDireciton</span><span style="font-family: 宋体;">改变方向方法</span></p>
<p class="15">&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('475fcf44-0fae-4150-a746-33fa00549058')"><img id="code_img_closed_475fcf44-0fae-4150-a746-33fa00549058" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_475fcf44-0fae-4150-a746-33fa00549058" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('475fcf44-0fae-4150-a746-33fa00549058',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_475fcf44-0fae-4150-a746-33fa00549058" class="cnblogs_code_hide">
<pre><code>Game.prototype.bindEvent = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
</span><span style="color: #0000ff;">var</span> self = <span style="color: #0000ff;">this</span><span style="color: #000000;">;
    document.onkeydown </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(e){
        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;">(e.keyCode){
            </span><span style="color: #0000ff;">case</span> 37<span style="color: #000000;">:
                </span><span style="color: #008000;">//</span><span style="color: #008000;">按左键，如果当前往右走，不允许掉头</span>
                <span style="color: #0000ff;">if</span>(self.snake.direction == "R") <span style="color: #0000ff;">return</span><span style="color: #000000;">;
                self.snake.changeDirection(</span>"L"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">case</span> 38<span style="color: #000000;">:
                </span><span style="color: #0000ff;">if</span>(self.snake.direction == "D") <span style="color: #0000ff;">return</span><span style="color: #000000;">;
                self.snake.changeDirection(</span>"U"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">case</span> 39<span style="color: #000000;">:
                </span><span style="color: #0000ff;">if</span>(self.snake.direction == "L") <span style="color: #0000ff;">return</span><span style="color: #000000;">;
                self.snake.changeDirection(</span>"R"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">case</span> 40<span style="color: #000000;">:
                </span><span style="color: #0000ff;">if</span>(self.snake.direction == "U") <span style="color: #0000ff;">return</span><span style="color: #000000;">;
                self.snake.changeDirection(</span>"D"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        }
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">键盘监听</span></div>
<p class="15">&nbsp;</p>
<p>&nbsp;</p>
<p class="15">&nbsp;</p>
<p>第六步：食物类</p>
<p>l&nbsp;<span style="font-family: 宋体;">我们采用每吃到一次食物，就重新</span>new<span style="font-family: 宋体;">一个食物</span></p>
<p>l&nbsp;食物不能随机到蛇的身上（所在的表格中）</p>
<p>l&nbsp;<span style="font-family: 宋体;">我们采用的是每一帧要清除所有小格的</span>html<span style="font-family: 宋体;">内容，然后重新渲染所有小格</span></p>
<div class="cnblogs_code">
<pre><code>window.Game = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    ...
    </span><span style="color: #0000ff;">this</span>.snake = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Snake();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">实例化食物</span>
    <span style="color: #ff0000;">this.food = new Food(this);
    </span><span style="color: #0000ff;">this</span>.start();<span style="color: #008000;">//</span><span style="color: #008000;">开启游戏定时器</span>
    <span style="color: #0000ff;">this</span>.bindEvent();<span style="color: #008000;">//</span><span style="color: #008000;">监听事件</span>
}</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">在</span>Game.js<span style="font-family: 宋体;">中：</span></p>
<div class="cnblogs_code">
<pre><code>Game.prototype.start = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #0000ff;">this</span>.timer = setInterval(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        self.clear();</span><span style="color: #008000;">//</span><span style="color: #008000;">清除屏幕</span>
        <span style="color: #008000;">//</span><span style="color: #008000;">更新蛇</span>
        self.f % 30 == 0 &amp;&amp;<span style="color: #000000;"> self.snake.update();
        self.snake.render();</span><span style="color: #008000;">//</span><span style="color: #008000;">渲染蛇</span>
        self.food.render();<span style="color: #008000;">//</span><span style="color: #008000;">渲染食物</span>
    }, 20<span style="color: #000000;">);
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">设置食物的方法</span>
Game.prototype.setHTML = <span style="color: #0000ff;">function</span><span style="color: #000000;">(row,col,html){
</span><span style="color: #0000ff;">this</span>.dom.getElementsByTagName('tr')[row].getElementsByTagName('td'<span style="color: #000000;">)[col]
.innerHTML </span>=<span style="color: #000000;"> html;
}</span></pre>
</div>
<p>&nbsp;</p>
<p>Food.js<span style="font-family: 宋体;">类：</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d85ceaf3-2cee-43c8-8043-90a674a5e64a')"><img id="code_img_closed_d85ceaf3-2cee-43c8-8043-90a674a5e64a" class="code_img_closed" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发4.png" alt="" /><img id="code_img_opened_d85ceaf3-2cee-43c8-8043-90a674a5e64a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('d85ceaf3-2cee-43c8-8043-90a674a5e64a',event)" src="./images/前端笔记之JavaScript面向对象（三）初识ES6&amp;underscore.js&amp;EChart.js&amp;设计模式&amp;贪吃蛇开发5.png" alt="" />
<div id="cnblogs_code_open_d85ceaf3-2cee-43c8-8043-90a674a5e64a" class="cnblogs_code_hide">
<pre><code>(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
window.Food </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(mediator){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">随机食物位置，不能在蛇的身上</span>
        <span style="color: #0000ff;">var</span> self = <span style="color: #0000ff;">this</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">do</span><span style="color: #000000;">{
            </span><span style="color: #0000ff;">this</span>.row = ~~(Math.random() *<span style="color: #000000;"> mediator.rowAmount);
            </span><span style="color: #0000ff;">this</span>.col = ~~(Math.random() *<span style="color: #000000;"> mediator.colAmount);
        }</span><span style="color: #0000ff;">while</span>((<span style="color: #0000ff;">function</span>(){ <span style="color: #008000;">//</span><span style="color: #008000;">IIFE的执行，返回true或fasle</span>
            <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 0;i &lt; mediator.snake.body.length;i++<span style="color: #000000;">){
                </span><span style="color: #0000ff;">if</span>(mediator.snake.body[i].row == self.row &amp;&amp; mediator.snake.body[j].col ==<span style="color: #000000;"> self.col){
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>; <span style="color: #008000;">//</span><span style="color: #008000;">食物随机到蛇身上，重新随机一次</span>
<span style="color: #000000;">                }
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>; <span style="color: #008000;">//</span><span style="color: #008000;">如果食物不在蛇身上，终止循环</span>
<span style="color: #000000;">            }
        })());
    }
    Food.prototype.render </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
        game.setHTML(</span><span style="color: #0000ff;">this</span>.row,<span style="color: #0000ff;">this</span>.col,"&hearts;"<span style="color: #000000;">);
    }
})();</span></pre>
</div>
<span class="cnblogs_code_collapse">Food.js</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="font-family: 宋体;">以下在</span>Snake.js<span style="font-family: 宋体;">写：</span></strong></p>
<p><strong>第七步：吃到食物蛇身变长</strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;"> 食物判断</span>
<span style="color: #0000ff;">if</span>(toucha.row == game.food.row &amp;&amp; toucha.col ==<span style="color: #000000;"> game.food.col){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">当你吃到食物的时候，不用删尾巴，而且需要重新new一个食物</span>
    game.food = <span style="color: #0000ff;">new</span> Food(game); <span style="color: #008000;">//</span><span style="color: #008000;">传上下文，要中介者（game）</span>
    game.f = 0<span style="color: #000000;">;
}</span><span style="color: #0000ff;">else</span><span style="color: #000000;">{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">当没有吃到食物时候，删除尾巴一项</span>
    <span style="color: #0000ff;">this</span>.body.pop(); <span style="color: #008000;">//</span><span style="color: #008000;">尾删</span>
}</pre>
</div>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><strong><span style="font-family: 宋体; font-size: 10.5pt;">第八步：死亡判定，撞墙和撞自己</span></strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">撞墙判断</span>
<span style="color: #0000ff;">if</span>(toucha.row&lt;0 ||toucha.col&lt;0 || toucha.col &gt; game.colAmount-1 || toucha.row &gt; game.rowAmount-1<span style="color: #000000;">){
    alert(</span>"你撞墙了，长度是：" + <span style="color: #0000ff;">this</span><span style="color: #000000;">.body.length);
    </span><span style="color: #0000ff;">this</span>.body.shift(); <span style="color: #008000;">//</span><span style="color: #008000;">撞墙继续头插不合法</span>
<span style="color: #000000;">    clearInterval(game.timer);
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;"> 撞自己判断</span>
<span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">var</span> i = 1;i &lt; <span style="color: #0000ff;">this</span>.body.length;i++<span style="color: #000000;">){
    </span><span style="color: #0000ff;">if</span>(toucha.row == <span style="color: #0000ff;">this</span>.body[i].row &amp;&amp; toucha.col == <span style="color: #0000ff;">this</span><span style="color: #000000;">.body[i].col){
        alert(</span>"撞自己啦！傻缺，长度是：" + <span style="color: #0000ff;">this</span><span style="color: #000000;">.body.length);
        </span><span style="color: #0000ff;">this</span>.body.shift(); <span style="color: #008000;">//</span><span style="color: #008000;">继续头插不合理</span>
<span style="color: #000000;">        clearInterval(game.timer);
    }
}</span></pre>
</div>
<p class="MsoNormal"><span style="mso-spacerun: 'yes'; font-family: 宋体; mso-ascii-font-family: Consolas; mso-hansi-font-family: Consolas; mso-bidi-font-family: 'Times New Roman'; font-size: 10.5000pt; mso-font-kerning: 1.0000pt;">更新蛇，蛇越长速度越快</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> s = self.snake.body.length &lt; 10 ? 30 : 5<span style="color: #000000;">;
self.f </span>% s == 0 &amp;&amp; self.snake.update();</pre>
</div>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><strong><span style="font-family: 宋体; font-size: 10.5pt;">最后，解决</span></strong><strong><span style="font-family: 宋体; font-size: 10.5pt;">bug<span style="font-family: 宋体;">。</span></span></strong></p>
<div class="cnblogs_code">
<pre><code>Snake.prototype.changeDirection = <span style="color: #0000ff;">function</span><span style="color: #000000;">(str){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">更改未来的方向</span>
    <span style="color: #0000ff;">this</span>.willDirection =<span style="color: #000000;"> str;
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> Snake = window.Snake = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   </span><span style="color: #008000;">//</span><span style="color: #008000;">蛇的身体</span>
<span style="color: #000000;">   ....
   </span><span style="color: #008000;">//</span><span style="color: #008000;">蛇当前动态的方向</span>
   <span style="color: #0000ff;">this</span>.direction = "R"<span style="color: #000000;">;
   </span><span style="color: #008000;">//</span><span style="color: #008000;">即将设置的方向，这里是为了防止用户按很快出bug。</span>
   <span style="color: #0000ff;">this</span>.willDirection = "R"<span style="color: #000000;">;
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code>Snake.prototype.update = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){
   </span><span style="color: #008000;">//</span><span style="color: #008000;">让当前的方向和即将设置的方向一致，这里是为了放置用户按很快出bug。</span>
   <span style="color: #0000ff;">this</span>.direction = <span style="color: #0000ff;">this</span><span style="color: #000000;">.willDirection;
}</span></pre>
</div>
<hr />
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>