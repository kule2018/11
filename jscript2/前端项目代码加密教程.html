<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修前端项目代码加密教程' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>前端项目代码加密教程</center></div><div class='banquan'>原文出处:本文由博客园博主不该相遇在秋天提供。<br/>
原文连接:https://www.cnblogs.com/fengyumeng/p/11072076.html</div><br>
    <h3>序</h3>
<p>　　我们都知道，浏览器上是可以看到前端的html和js代码的，所以如果遇到隐私心比较强的老板，你就冷不丁的会接受到一个代码加密的需求，当接受到这个需求的时候你怎么完成？那我希望我的这篇博客可以帮助到你。</p>
<p>　　首先，告诉你的老板，严格意义上的加密是不存在的，能够实现的只有对前端代码进行压缩混淆，增加阅读难度。</p>
<p>　　本篇教程全篇描述的，就是对代码进行混淆的手段，从而满足老板提出的加密需求。</p>
<p>　　为了保证本篇教程真实可用，我将使用一台新的Windows系统，从无到有进行演示，同时将操作流程记录在这里，供你参考，也希望能够帮你跳过一些坑，如果你遇到什么问题，请留言讨论。</p>
<p>&nbsp;</p>
<h3>安装NodeJs</h3>
<p>　　如果你没安装过node，请跟着教程走，如果你安装过，请直接跳到下一节。</p>
<p>　　下载地址：http://nodejs.cn/download/</p>
<p><img src="./images/前端项目代码加密教程0.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　直接下载安装，安装的过程是傻瓜式的下一步，唯一可以改变的是安装位置。</p>
<p>&nbsp;</p>
<p>　　安装完成后打开cmd命令行，查看版本号是为了确认是否安装成功。</p>
<p>　　<img src="./images/前端项目代码加密教程1.png" alt="" /></p>
<p>&nbsp;</p>
<h3>安装插件</h3>
<p>　　切换到项目根目录：</p>
<p>　　<img src="./images/前端项目代码加密教程2.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　安装gulp插件包：<strong>npm install --save-dev gulp</strong></p>
<p>　　效果如图：</p>
<p>　　<img src="./images/前端项目代码加密教程3.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　别急，还有很多包，命令一条一条刷起来：</p>
<p>&nbsp;</p>
<p><strong>　　npm install --save-dev del</strong></p>
<p><strong>　　npm install --save-dev gulp-concat</strong></p>
<p><strong>　　npm install --save-dev gulp-header</strong></p>
<p><strong>　　npm install --save-dev gulp-if</strong></p>
<p><strong>　　npm install --save-dev gulp-minify-css</strong></p>
<p><strong>　　npm install --save-dev gulp-htmlmin</strong></p>
<p><strong>　　npm install --save-dev gulp-rename</strong></p>
<p><strong>　　npm install --save-dev gulp-replace</strong></p>
<p><strong>　　npm install --save-dev gulp-uglify</strong></p>
<p><strong>　　npm install --save-dev gulp-babel</strong></p>
<p><strong>　　npm install --save-dev babel-preset-es2015</strong></p>
<p><strong>　　npm install --save-dev @babel/core</strong></p>
<p><strong>　　npm install --save-dev @babel/preset-env</strong></p>
<p>&nbsp;</p>
<h3>注意事项</h3>
<p>　　插件安装完成后，我们的前期工作就做完了。</p>
<p>　　我们会发现项目目录中多个一个node_modules目录和package-lock.json文件，json文件中是我们的插件列表，node_modules目录中是我们安装的插件包。</p>
<p>　　<img src="./images/前端项目代码加密教程4.png" alt="" /></p>
<p>　　index.html是我的主入口文件，src目录就是我的项目中存放代码的目录，也就是我要压缩加密构建的目录。</p>
<p>&nbsp;</p>
<p>　　<img src="./images/前端项目代码加密教程5.png" alt="" /></p>
<p>　　src里有三个子目录，controller存放独立的js处理前端业务逻辑，style存放css样式文件，view存放html页面。</p>
<p>&nbsp;</p>
<p>　　在编写脚本之前，我需要直白的告诉你，如果你的JS里有ES6语法，正常打包是打不了的，不过我们的前期工作已经把处理这个问题的工具包也一起安装了，但是也仅限于处理单独的JS文件。</p>
<p>　　如果你是HTML代码里嵌JS，并且JS里有ES6语法，那么需要把JS代码拎出来做成单独的JS，或者手动将ES6写法改成ES5。</p>
<p>&nbsp;</p>
<p>　　总之，如果你打包报错，很大可能是ES6语法导致，其次是文件路径错误。</p>
<p>&nbsp;</p>
<h3>压缩JS</h3>
<p>　　回到我们的项目根目录，创建一个gulpfile.js文件，这个是固定的文件名：</p>
<p>　　<img src="./images/前端项目代码加密教程6.png" alt="" /></p>
<p>引入包：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> gulp = require('gulp'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> uglify = require('gulp-uglify'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> babel = require('gulp-babel'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> minifyCss = require("gulp-minify-css"<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> htmlmin = require('gulp-htmlmin'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> header = require('gulp-header'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> del = require('del');</pre>
</div>
<p>&nbsp;</p>
<p>定义一个目标目录：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> destDir = './dist';</pre>
</div>
<p>&nbsp;</p>
<p>定义一个注释，因为我希望在压缩后的代码中第一行添加一点注释：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> note = ['/**  小样，看源码？想得美！ */\n &lt;%= js %&gt;', {js: ';'}];</pre>
</div>
<p>&nbsp;</p>
<p>监听任务：</p>
<div class="cnblogs_code">
<pre><code>gulp.task('minjs', <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
    </span><span style="color: #008000;">//</span><span style="color: #008000;">定义路径</span>
    <span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
        </span>'./src/**/*.js'<span style="color: #000000;">
    ];
    gulp.src(src)
        .pipe(babel({presets: [</span>"@babel/env"], plugins: []}))<span style="color: #008000;">//</span><span style="color: #008000;">es6转es5</span>
        .pipe(uglify())<span style="color: #008000;">//</span><span style="color: #008000;">压缩</span>
        .pipe(header.apply(<span style="color: #0000ff;">null</span>, note))<span style="color: #008000;">//</span><span style="color: #008000;">添加头部注释</span>
        .pipe(gulp.dest(destDir));<span style="color: #008000;">//</span><span style="color: #008000;">将压缩后的内容输出到目标目录</span>
});</pre>
</div>
<p>　　minjs就是我们自定义的任务名，也就是说 我们在命令行输入gulp minjs 这行命令，这段代码就会执行。</p>
<p>　　如果只输入gulp命令，它会自动去找名为default的任务。</p>
<p>&nbsp;</p>
<p>　　var src = ['./src/**/*.js']; 就是我们想要抓取的文件，使用了通配符，你几乎一定会有需求像下面这样写：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
        </span>'./src/**/*.js'<span style="color: #000000;">
        , </span>'!./src/config.js'<span style="color: #000000;">
        , </span>'!./src/lib/extend/*.js'<span style="color: #000000;">
    ];</span></pre>
</div>
<p>　　感叹号的意思是排除。</p>
<p>&nbsp;</p>
<p>　　这里说明一下destDir只会代替通配符之前的目录路径，比如说我这里的destDir定义的是./dist，那么 ./src/controller/admin.js 压缩后的路径就是 ./dist/controller/admin.js。</p>
<p>&nbsp;</p>
<p>　　好了，打开命令行，输入命令：<strong>gulp minjs</strong></p>
<p><strong>　　<img src="./images/前端项目代码加密教程7.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>　　查看项目，js文件已经压缩成功了。</p>
<p><img src="./images/前端项目代码加密教程8.png" alt="" /></p>
<p>&nbsp;</p>
<h3>压缩CSS</h3>
<p>　　任务的监听和压缩JS是没有差别的，只不过压缩任务用gulp-minify-css插件来完成。</p>
<div class="cnblogs_code">
<pre><code>gulp.task('mincss', <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
    </span><span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
        </span>'./src/style/*.css'<span style="color: #000000;">
    ];
    gulp.src(src).pipe(minifyCss()).pipe(gulp.dest(destDir </span>+ '/style'<span style="color: #000000;">));
});</span></pre>
</div>
<p>&nbsp;</p>
<p>　　输入命令：<strong>gulp mincss</strong></p>
<p>　　<img src="./images/前端项目代码加密教程9.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　查看项目也没有任何问题：</p>
<p><img src="./images/前端项目代码加密教程10.png" alt="" /></p>
<p>　　非常智能的它会把css中的注释给你删掉。</p>
<p>&nbsp;</p>
<h3>压缩HTML</h3>
<p>　　压缩HTML可以传入很多参数指定相应的行为：</p>
<div class="cnblogs_code">
<pre><code>gulp.task('minhtml', <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
    </span><span style="color: #0000ff;">var</span> options =<span style="color: #000000;"> {
        removeComments: </span><span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">清除HTML注释</span>
        collapseWhitespace: <span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">折叠空白</span>
        minifyJS: <span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">压缩页面JS</span>
        minifyCSS: <span style="color: #0000ff;">true</span><span style="color: #008000;">//</span><span style="color: #008000;">压缩页面CSS</span>
<span style="color: #000000;">    };
    </span><span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
        </span>'./src/views/**/*'<span style="color: #000000;">,
    ];
    gulp.src(src)
        .pipe(htmlmin(options))
        .pipe(gulp.dest(destDir </span>+ '/views'<span style="color: #000000;">));
});</span></pre>
</div>
<p>　　更多参数请移步这里来看：https://github.com/kangax/html-minifier/blob/gh-pages/README.md</p>
<p>&nbsp;</p>
<p>　　输入命令：<strong>gulp minhtml</strong></p>
<p><strong>　　<img src="./images/前端项目代码加密教程11.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>　　压缩后的HTML：</p>
<p><img src="./images/前端项目代码加密教程12.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　全部压成一行，文件中的css和js也一并压缩了。</p>
<p>&nbsp;</p>
<h3>一条龙处理</h3>
<p>　　但是我们总不可能是打个包要跑多条命令吧，那多麻烦，现在我们就整合整合，让这些任务合并成一个任务。</p>
<p>　　我们创建一个task对象，把各个任务的内容放进去，并且加一个清理dist目录的方法，和一个move方法负责将没有被压缩的文件复制过去。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">任务列表</span>
<span style="color: #0000ff;">var</span> task =<span style="color: #000000;"> {
    </span><span style="color: #008000;">//</span><span style="color: #008000;">清理dist目录</span>
    clear:<span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        del([</span>'./dist/*'<span style="color: #000000;">]);
    },
    minjs:</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">定义路径</span>
        <span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
            </span>'./src/**/*.js'<span style="color: #000000;">
        ];
        gulp.src(src)
            .pipe(babel({presets: [</span>"@babel/env"], plugins: []}))<span style="color: #008000;">//</span><span style="color: #008000;">es6转es5</span>
            .pipe(uglify())<span style="color: #008000;">//</span><span style="color: #008000;">压缩</span>
            .pipe(header.apply(<span style="color: #0000ff;">null</span>, note))<span style="color: #008000;">//</span><span style="color: #008000;">添加头部注释</span>
<span style="color: #000000;">            .pipe(gulp.dest(destDir));
    },
    mincss:</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
            </span>'./src/style/*.css'<span style="color: #000000;">
        ];
        gulp.src(src).pipe(minifyCss()).pipe(gulp.dest(destDir </span>+ '/style'<span style="color: #000000;">));
    },
    minhtml:</span><span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #0000ff;">var</span> options =<span style="color: #000000;"> {
            removeComments: </span><span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">清除HTML注释</span>
            collapseWhitespace: <span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">折叠空白</span>
            minifyJS: <span style="color: #0000ff;">true</span>,<span style="color: #008000;">//</span><span style="color: #008000;">压缩页面JS  如果你确信你的HTML页面中的js不包含有es6语法，那么可以压缩js 否则还是得把js抽离成单独的文件进行压缩</span>
            minifyCSS: <span style="color: #0000ff;">true</span><span style="color: #008000;">//</span><span style="color: #008000;">压缩页面CSS</span>
<span style="color: #000000;">        };
        </span><span style="color: #0000ff;">var</span> src =<span style="color: #000000;"> [
            </span>'./src/**/*'<span style="color: #000000;">,
        ];
        gulp.src(src)
            .pipe(htmlmin(options))
            .pipe(gulp.dest(destDir));
    },
    move: </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">复制文件夹  没有被压缩的文件就在这里复制</span>
        gulp.src('./src/**/*.png'<span style="color: #000000;">).pipe(gulp.dest(destDir));
    }
};</span></pre>
</div>
<p>&nbsp;</p>
<p>　　我们在压缩js的时候说了，如果只是gulp命令，它会去找名为default的任务，我们就在default任务里遍历task对象，将其中的方法轮流执行一遍。</p>
<div class="cnblogs_code">
<pre><code>gulp.task('default', <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> key <span style="color: #0000ff;">in</span><span style="color: #000000;"> task) {
        task[key]();
    }
});</span></pre>
</div>
<p>　　这样，我们只需要一个gulp命令，也就走完了整个构建流程。</p>
<p>&nbsp;</p>
<p>　　同时，我们将单个的任务指向task中对应的方法：</p>
<div class="cnblogs_code">
<pre><code>gulp.task('clear'<span style="color: #000000;">,task.clear);
gulp.task(</span>'minjs'<span style="color: #000000;">,task.minjs);
gulp.task(</span>'mincss'<span style="color: #000000;">,task.mincss);
gulp.task(</span>'minhtml'<span style="color: #000000;">,task.minhtml);
gulp.task(</span>'move',task.move);</pre>
</div>
<p>&nbsp;</p>
<p>　　无论是单独处理一个环节，还是整个构建流程，我们都可以很方便的完成。</p>
<p>&nbsp;</p>
<p>最后，感谢阅读。　　PS：欢迎关注，有粉必回。</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>