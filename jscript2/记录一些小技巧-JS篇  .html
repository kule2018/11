<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修记录一些小技巧-JS篇  ' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>记录一些小技巧-JS篇  </center></div><div class='banquan'>原文出处:本文由博客园博主WahFung提供。<br/>
原文连接:https://www.cnblogs.com/chanwahfung/p/11878521.html</div><br>
    <h3>1.16进制随机颜色</h3>
<div class="cnblogs_code">
<pre><code>let color = '#'+Math.random().toString(16).slice(-6)</pre>
</div>
<h3>2.类型判断工具函数</h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">function</span><span style="color: #000000;"> isType(target, type) {
  let targetType </span>= Object.prototype.toString.call(target).slice(8, -1<span style="color: #000000;">).toLowerCase()
  type </span>=<span style="color: #000000;"> type.toLowerCase()
  </span><span style="color: #0000ff;">return</span> targetType ===<span style="color: #000000;"> type
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code>isType([],'array') <span style="color: #008000;">//</span><span style="color: #008000;">true</span></pre>
</div>
<h3>3.正则匹配两个字符间的内容</h3>
<div class="cnblogs_code">
<pre><code>let str = '订阅项目:{{phrase1.DATA}}\n更新内容:{{thing_2.DATA}}\n提示说明:{{thing3.DATA}}'<span style="color: #000000;">
let res </span>= str.match(/(?&lt;={{).*?(?=}})/g) // ["phrase1.DATA", "thing_2.DATA", "thing3.DATA"]</pre>
</div>
<blockquote>
<p><span style="font-size: 16px;"><strong>x(?=y)：&nbsp;&nbsp;</strong>匹配'x'仅仅当'x'后面跟着'y'</span><span style="font-size: 16px;">.这种叫做先行断言,y不作为匹配结果的一部分</span></p>
<p><span style="font-size: 16px;"><strong>(?&lt;=y)x：</strong>匹配'x'仅仅当'x'前面是'y'.这种叫做后行断言，y不作为匹配结果的一部分</span></p>
</blockquote>
<h3>4.简洁的设置默认参数</h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">if</span>(!<span style="color: #000000;">arr){
  arr </span>=<span style="color: #000000;"> []
}
arr.push(</span>1<span style="color: #000000;">)

</span><span style="color: #008000;">//</span><span style="color: #008000;">可以这样写</span>
(arr &amp;&amp; (arr=[])).push(1)</pre>
</div>
<h3>5.reduce会更简洁</h3>
<p><span style="font-size: 16px;">filter和map的组合使用可能很多人都会使用过，但是这样会进行两次遍历操作。可以使用reduce遍历一次完成同样的操作。</span></p>
<p><span style="font-size: 16px;">reduce接受一个回调函数和一个默认值。</span></p>
<p><span style="font-size: 16px;">回调函数接受两个参数，prev是上次返回值，curr是当前遍历值。在第一次遍历时，prev为默认值，每次遍历返回的prev都会在下一个遍历中取到。reduce因此也被叫做&rdquo;累加函数&ldquo;。</span></p>
<div class="cnblogs_code">
<pre><code>let people = [{name:'Joe',age:18},{name:'Mike',age:19},{name:'Jack',age:20<span style="color: #000000;">}]
people.fliter(p</span>=&gt;p.age &lt; 20).map(p=&gt;<span style="color: #000000;">p.name)

</span><span style="color: #008000;">//</span><span style="color: #008000;">可以这样写</span>
people.reduce((prev,curr)=&gt;<span style="color: #000000;">{
    </span><span style="color: #0000ff;">if</span>(age&lt;20<span style="color: #000000;">){
       prev.push(curr.name)
    }
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> prev
},[])</span></pre>
</div>
<h3>6.策略模式</h3>
<p><span style="font-size: 16px;">使用策略模式来代替一堆的 if...else，让代码看起来更简洁</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">if</span>(type == = 'content'<span style="color: #000000;">){
    getContent()
}</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(type === 'hot'<span style="color: #000000;">){
    getHot()
}</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(type === 'rank'<span style="color: #000000;">){
    getRank()
}
...

</span><span style="color: #008000;">//</span><span style="color: #008000;">可以这样写</span>
let action =<span style="color: #000000;"> {
    content: getContent,
    hot: getHot,
    rank: getRank,
    ....
}
action[type]()</span></pre>
</div>
<h3>&nbsp;7.JSON.stringify的其他参数</h3>
<div class="cnblogs_code">
<pre><code>let str = {a:1,b:2,c:3<span style="color: #000000;">}

</span><span style="color: #008000;">//</span><span style="color: #008000;">过滤</span>
JSON.stringify(str, ['a'])   <span style="color: #008000;">//</span><span style="color: #008000;">"{"a":1}"</span>

<span style="color: #008000;">//</span><span style="color: #008000;">格式化</span>
JSON.stringify(str, <span style="color: #0000ff;">null</span>, 2<span style="color: #000000;">)  
</span><span style="color: #008000;">/*</span><span style="color: #008000;">
"{
  "a": 1,
  "b": 2,
  "c": 3
}"
</span><span style="color: #008000;">*/</span></pre>
</div>
<h3>8.获取月份的最后一天</h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">new</span> Date('2019','2',0).getDate()</pre>
</div>
<h3>9.优雅处理await异常</h3>
<p><span style="font-size: 16px;">一般处理await会使用try catch，但这样的代码结构看起来会显得冗余不够简洁。我们可以通过Error-first模式来处理异常，该模式参考node.js处理回调模式</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">to.js</span>
export <span style="color: #0000ff;">default</span><span style="color: #000000;"> function to(promise){
  </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> promise
    .then(res</span>=&gt;[<span style="color: #0000ff;">null</span><span style="color: #000000;">,res])
    .</span><span style="color: #0000ff;">catch</span>(err=&gt;<span style="color: #000000;">[err])
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><code>import to from './to.js'<span style="color: #000000;">

async </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> foo(){
  let err,res;
  [err, res] </span>=<span style="color: #000000;"> await to(promiseTask)
  </span><span style="color: #0000ff;">if</span>(err) <span style="color: #0000ff;">throw</span><span style="color: #000000;"> err  
}</span></pre>
</div>
<h3>10.获取当天凌晨12点时间</h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">new</span> Date(<span style="color: #0000ff;">new</span> Date().toLocaleDateString()).getTime()</pre>
</div>
<h3>11.验证数组项</h3>
<p>every方法接受一个回调函数，函数内需要返回验证规则（布尔值）。</p>
<p>every会根据回调函数返回的规则去验证每一项，只有全部通过规则，才会返回true。some方法恰好与every方法相反，some方法只需要一项通过，即返回true。</p>
<div class="cnblogs_code">
<pre><code>let wordData = ['', 0, undefined, <span style="color: #0000ff;">null</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">]
wordData.every(Boolean) </span><span style="color: #008000;">//</span><span style="color: #008000;"> false</span></pre>
</div>
<h3>12.科学计数&nbsp;</h3>
<p>比如我们需要用毫秒数来表达一天的时间即86400000，为了简洁可以使用科学计数</p>
<div class="cnblogs_code">
<pre><code>8.64e7 <span style="color: #008000;">//</span><span style="color: #008000;">86400000</span></pre>
</div>
<h3>13.快速生成一周的时间</h3>
<p>Array构造函数若只传数字作为参数会生成对应长度的数组，但这种数组只是拥有长度属性并没有实际内容，需要扩展数组为项设置初始值，这样使用遍历方法才能够拿到想要的数据</p>
<div class="cnblogs_code">
<pre><code>[...Array(7)].map((j,i)=&gt; <span style="color: #0000ff;">new</span> Date(Date.now()+i*8.64e7<span style="color: #000000;">).toLocaleDateString())
</span><span style="color: #008000;">//</span><span style="color: #008000;"> ["2019/12/25", "2019/12/26", "2019/12/27", "2019/12/28", "2019/12/29", "2019/12/30", "2019/12/31"]</span></pre>
</div>
<h3>14.灵活的日期格式化函数</h3>
<p>第一个参数接受时间戳，第二个函数接受格式化字符串。重点在于第二个参数，可以根据使用者输入的格式来应对多种需求。</p>
<div>当然也可以判断格式化字符串内的字符按需获取对应的数据，而不是一次性全部替换，这样可以做到一点优化。</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">function</span><span style="color: #000000;"> startFillZero(num){
  </span><span style="color: #0000ff;">return</span> num &lt; 10 ? '0'+<span style="color: #000000;">num : num
}

</span><span style="color: #0000ff;">function</span> formatDate(timestamp=Date.now(), format='Y-M-D h:m'<span style="color: #000000;">){
  </span><span style="color: #0000ff;">if</span>((timestamp).toString().length == 10<span style="color: #000000;">){
    timestamp </span>= timestamp * 1000<span style="color: #000000;">
  }
  let date </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Date(timestamp)
  let dateObj </span>=<span style="color: #000000;"> {
    Y: date.getFullYear(),
    M: date.getMonth()</span>+1<span style="color: #000000;">,
    D: date.getDate(),
    h: date.getHours(),
    m: date.getMinutes(),
    s: date.getSeconds()
  }
  let res </span>=<span style="color: #000000;"> format
    .replace(</span>'Y'<span style="color: #000000;">,dateObj.Y)
    .replace(</span>'M'<span style="color: #000000;">,dateObj.M)
    .replace(</span>'D'<span style="color: #000000;">,dateObj.D)
    .replace(</span>'h'<span style="color: #000000;">,startFillZero(dateObj.h))
    .replace(</span>'m'<span style="color: #000000;">,startFillZero(dateObj.m))
    .replace(</span>'s'<span style="color: #000000;">,startFillZero(dateObj.s))
  </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> res
}</span></pre>
</div>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>不定时更新~</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>